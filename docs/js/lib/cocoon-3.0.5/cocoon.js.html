<!DOCTYPE html><html><head><title>cocoon.js</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../../index.html" class="source"><span class="file_name">README</span></a><a href="../../../js/Main.js.html" class="source "><span class="base_path">js / </span><span class="file_name">Main.js</span></a><a href="../../../js/PlayerInfo.js.html" class="source "><span class="base_path">js / </span><span class="file_name">PlayerInfo.js</span></a><a href="../../../js/config.js.html" class="source "><span class="base_path">js / </span><span class="file_name">config.js</span></a><a href="../../../js/display/graph/GraphElement.js.html" class="source "><span class="base_path">js / display / graph / </span><span class="file_name">GraphElement.js</span></a><a href="../../../js/display/graph/PoolGraph.js.html" class="source "><span class="base_path">js / display / graph / </span><span class="file_name">PoolGraph.js</span></a><a href="../../../js/display/graph/Symbol.js.html" class="source "><span class="base_path">js / display / graph / </span><span class="file_name">Symbol.js</span></a><a href="../../../js/display/scene/BaseScene.js.html" class="source "><span class="base_path">js / display / scene / </span><span class="file_name">BaseScene.js</span></a><a href="../../../js/display/scene/GameScene.js.html" class="source "><span class="base_path">js / display / scene / </span><span class="file_name">GameScene.js</span></a><a href="../../../js/display/scene/SplashScene.js.html" class="source "><span class="base_path">js / display / scene / </span><span class="file_name">SplashScene.js</span></a><a href="../../../js/display/ui/common/Button.js.html" class="source "><span class="base_path">js / display / ui / common / </span><span class="file_name">Button.js</span></a><a href="../../../js/display/ui/common/Logo.js.html" class="source "><span class="base_path">js / display / ui / common / </span><span class="file_name">Logo.js</span></a><a href="../../../js/display/ui/common/Menu.js.html" class="source "><span class="base_path">js / display / ui / common / </span><span class="file_name">Menu.js</span></a><a href="../../../js/display/ui/game/CircleSwipe.js.html" class="source "><span class="base_path">js / display / ui / game / </span><span class="file_name">CircleSwipe.js</span></a><a href="../../../js/display/ui/game/Match.js.html" class="source "><span class="base_path">js / display / ui / game / </span><span class="file_name">Match.js</span></a><a href="../../../js/display/ui/game/MatchContainer.js.html" class="source "><span class="base_path">js / display / ui / game / </span><span class="file_name">MatchContainer.js</span></a><a href="../../../js/display/ui/game/Stat.js.html" class="source "><span class="base_path">js / display / ui / game / </span><span class="file_name">Stat.js</span></a><a href="../../../js/i18n/translate.js.html" class="source "><span class="base_path">js / i18n / </span><span class="file_name">translate.js</span></a><a href="../../../js/lib/cocoon-3.0.5/cocoon.js.html" class="source selected"><span class="base_path">js / lib / cocoon-3.0.5 / </span><span class="file_name">cocoon.js</span></a><a href="../../../js/lib/pixi-1.6/pixi.dev.js.html" class="source "><span class="base_path">js / lib / pixi-1.6 / </span><span class="file_name">pixi.dev.js</span></a><a href="../../../js/lib/stats.min.js.html" class="source "><span class="base_path">js / lib / </span><span class="file_name">stats.min.js</span></a><a href="../../../js/lib/tweenmax/BezierEasing.js.html" class="source "><span class="base_path">js / lib / tweenmax / </span><span class="file_name">BezierEasing.js</span></a><a href="../../../js/lib/tweenmax/ColorPropsPlugin.min.js.html" class="source "><span class="base_path">js / lib / tweenmax / </span><span class="file_name">ColorPropsPlugin.min.js</span></a><a href="../../../js/lib/tweenmax/TweenMax.min.js.html" class="source "><span class="base_path">js / lib / tweenmax / </span><span class="file_name">TweenMax.min.js</span></a><a href="../../../js/mobile/GameCenter.js.html" class="source "><span class="base_path">js / mobile / </span><span class="file_name">GameCenter.js</span></a><a href="../../../js/mobile/Store.js.html" class="source "><span class="base_path">js / mobile / </span><span class="file_name">Store.js</span></a><a href="../../../js/util/common/Color.js.html" class="source "><span class="base_path">js / util / common / </span><span class="file_name">Color.js</span></a><a href="../../../js/util/common/Math2.js.html" class="source "><span class="base_path">js / util / common / </span><span class="file_name">Math2.js</span></a><a href="../../../js/util/common/Object2.js.html" class="source "><span class="base_path">js / util / common / </span><span class="file_name">Object2.js</span></a><a href="../../../js/util/common/String2.js.html" class="source "><span class="base_path">js / util / common / </span><span class="file_name">String2.js</span></a><a href="../../../js/util/control/Swipe.js.html" class="source "><span class="base_path">js / util / control / </span><span class="file_name">Swipe.js</span></a><a href="../../../js/util/display/DisplayObject.js.html" class="source "><span class="base_path">js / util / display / </span><span class="file_name">DisplayObject.js</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>cocoon.js</h1><div class="filepath">js/lib/cocoon-3.0.5/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@fileOverview<br />Ludei's plugins are multiplatform Javascript APIs, that work in any of the three environments <br />of CocoonJS: accelerated Canvas+, webview+ and system webview.<br />- Select the specific plugin below to open the relevant documentation section.<br /> <ul><br />    <li><a href="Cocoon.html">Cocoon</a></li><br />    <li><a href="Cocoon.Ad.html">Ad</a></li><br />    <li><a href="Cocoon.App.html">App</a></li><br />    <li><a href="Cocoon.Camera.html">Camera</a></li><br />    <li><a href="Cocoon.Device.html">Device</a></li><br />    <li><a href="Cocoon.Dialog.html">Dialog</a></li><br />    <li><a href="Cocoon.Motion.html">Motion</a></li><br />    <li><a href="Cocoon.Multiplayer.html">Multiplayer</a></li><br />    <li><a href="Cocoon.Notification.html">Notification</a></li><br />    <li><a href="Cocoon.Proxify.html">Proxify</a></li><br />    <li><a href="Cocoon.Social.html">Social</a></li><br />    <li><a href="Cocoon.Store.html">Store</a></li><br />    <li><a href="Cocoon.Touch.html">Touch</a></li><br />    <li><a href="Cocoon.Utils.html">Utils</a></li><br />    <li><a href="Cocoon.WebView.html">WebView</a></li><br />    <li><a href="Cocoon.Widget.html">Widget</a></li><br /></ul><br /> <br/>The CocoonJS Plugin's library (cocoon.js and cocoon.min.js) can be found at Github. <br/><br /> <a href="https://github.com/ludei/CocoonJS-Plugins"><img src="img/download.png" style="width:230px;height:51px;" /></a><br /> <br/><br/>In addition to all the previously mentioned, in the following link you'll find an <a href="http://support.ludei.com/hc/en-us/articles/201821276-Extensions-overview">overview of all the avaliable features</a> in which each plugin support and availability are detailed.<br /> <br/><br/><br />We hope you find everything you need to get going here, but if you stumble on any problems with the docs or the plugins, <br />just drop us a line at our forum (support.ludei.com) and we'll do our best to help you out.</p>

<h3>Tools</h3>

<p><a href="http://support.ludei.com/hc/communities/public/topics"><img src="img/cocoon-tools-1.png" /></a><br /> <a href="http://support.ludei.com/hc"><img src="img/cocoon-tools-2.png" /></a><br /> <a href="https://cloud.ludei.com/"><img src="img/cocoon-tools-3.png" /></a><br /> <a href="https://www.ludei.com/cocoonjs/how-to-use/"><img src="img/cocoon-tools-4.png" /></a></p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    </pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The "Cocoon" object holds all the CocoonJS Extensions and other stuff needed for the CocoonJS environment.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">Cocoon</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Cocoon</span> <span class="o">?</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Cocoon</span> <span class="o">:</span> <span class="p">{};</span>
    </pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@property {string} version Current version of the CocoonJS Extensions.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="s2">&quot;3.0.5&quot;</span><span class="p">;</span>
    </pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Is the native environment available? true if so.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">);</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This utility function allows to create an object oriented like hierarchy between two functions using their prototypes.<br />This function adds a "superclass" and a "__super" attributes to the subclass and it's functions to reference the super class.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>subc </span><span class="dox_type">function</span><span>- The subclass function.</span></div><div class="dox_tag_detail"><span>superc </span><span class="dox_type">function</span><span>- The superclass function.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">subc</span><span class="p">,</span> <span class="nx">superc</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">subcp</span> <span class="o">=</span> <span class="nx">subc</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">CocoonJSExtendHierarchyChainClass</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>
        <span class="nx">CocoonJSExtendHierarchyChainClass</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">superc</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>

        <span class="nx">subc</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CocoonJSExtendHierarchyChainClass</span><span class="p">();</span>
        <span class="nx">subc</span><span class="p">.</span><span class="nx">superclass</span> <span class="o">=</span> <span class="nx">superc</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
        <span class="nx">subc</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">subc</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">superc</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">superc</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">superc</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">method</span> <span class="k">in</span> <span class="nx">subcp</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">subcp</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">method</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">subc</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="nx">subcp</span><span class="p">[</span><span class="nx">method</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This utility function copies the properties from one object to a new object array, the result object array can be used as arguments when calling Cocoon.callNative()</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>obj </span><span class="dox_type">function</span><span>- The base object that contains all properties defined.</span></div><div class="dox_tag_detail"><span>copy </span><span class="dox_type">function</span><span>- The object that user has defined.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">clone</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span><span class="nx">copy</span><span class="p">){</span>
        <span class="k">if</span> <span class="p">(</span><span class="kc">null</span> <span class="o">==</span> <span class="nx">obj</span> <span class="o">||</span> <span class="s2">&quot;object&quot;</span> <span class="o">!=</span> <span class="k">typeof</span> <span class="nx">obj</span><span class="p">)</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">attr</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nx">copy</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
                <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">copy</span><span class="p">[</span><span class="nx">attr</span><span class="p">]);</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">attr</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>IMPORTANT: This function should only be used by Ludei.<br />This function allows a call to the native extension object function reusing the same arguments object.<br />Why is interesting to use this function instead of calling the native object's function directly?<br />As the Cocoon object functions expicitly receive parameters, if they are not present and the native call is direcly mapped,<br />undefined arguments are passed to the native side. Some native functions do not check the parameters validation<br />correctly (just check the number of parameters passed).<br />Another solution instead of using this function call is to correctly check if the parameters are valid (not undefined) to make the<br />call, but it takes more work than using this approach.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>nativeExtensionObjectName </span><span class="dox_type">string</span><span>- The name of the native extension object name. The object that is a member of the 'ext' object.</span></div><div class="dox_tag_detail"><span>nativeFunctionName </span><span class="dox_type">string</span><span>- The name of the function to be called inside the native extension object.</span></div><div class="dox_tag_detail"><span>arguments </span><span class="dox_type">object</span><span>- The arguments object of the Cocoon extension object function. It contains all the arguments passed to the Cocoon extension object function and these are the ones that will be passed to the native call too.</span></div><div class="dox_tag_detail"><span>[async] </span><span class="dox_type">boolean</span><span>- A flag to indicate if the makeCall (false or undefined) or the makeCallAsync function should be used to perform the native call.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nativeExtensionObjectName</span><span class="p">,</span> <span class="nx">nativeFunctionName</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">async</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">argumentsArray</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
            <span class="nx">argumentsArray</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">nativeFunctionName</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">nativeExtensionObject</span> <span class="o">=</span> <span class="nx">ext</span><span class="p">[</span><span class="nx">nativeExtensionObjectName</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">makeCallFunction</span> <span class="o">=</span> <span class="nx">async</span> <span class="o">?</span> <span class="nx">nativeExtensionObject</span><span class="p">.</span><span class="nx">makeCallAsync</span> <span class="o">:</span> <span class="nx">nativeExtensionObject</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">makeCallFunction</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">nativeExtensionObject</span><span class="p">,</span> <span class="nx">argumentsArray</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">finalRet</span> <span class="o">=</span> <span class="nx">ret</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">ret</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">try</span> <span class="p">{</span>
                    <span class="nx">finalRet</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">ret</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">finalRet</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns an object retrieved from a path specified by a dot specified text path starting from a given base object.<br />It could be useful to find the reference of an object from a defined base object. For example the base object could be window and the<br />path could be "Cocoon.App" or "document.body".</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>baseObject </span><span class="dox_type">Object</span><span>- The object to start from to find the object using the given text path.</span></div><div class="dox_tag_detail"><span>objectPath </span><span class="dox_type">string</span><span>- The path in the form of a text using the dot notation. i.e. &quot;document.body&quot;</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">getObjectFromPath</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">baseObject</span><span class="p">,</span> <span class="nx">objectPath</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">objectPath</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">baseObject</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> 
        <span class="p">{</span>
            <span class="nx">obj</span><span class="p">[</span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">||</span> <span class="kc">undefined</span><span class="p">;</span>
            <span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>A class that represents objects to handle events. Event handlers have always the same structure:<br />Mainly they provide the addEventListener and removeEventListener functions.<br />Both functions receive a callback function that will be added or removed. All the added callback<br />functions will be called when the event takes place.<br />Additionally they also allow the addEventListenerOnce and notifyEventListeners functions.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>nativeExtensionObjectName </span><span class="dox_type">string</span><span>- The name of the native extension object (inside the ext object) to be used.</span></div><div class="dox_tag_detail"><span>CocoonExtensionObjectName </span><span class="dox_type">string</span><span>- The name of the sugarized extension object.</span></div><div class="dox_tag_detail"><span>nativeEventName </span><span class="dox_type">string</span><span>- The name of the native event inside the ext object.</span></div><div class="dox_tag_detail"><span>[chainFunction] </span><span class="dox_type">number</span><span>- An optional function used to preprocess the listener callbacks. This function, if provided,</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nativeExtensionObjectName</span><span class="p">,</span> <span class="nx">CocoonExtensionObjectName</span><span class="p">,</span> <span class="nx">nativeEventName</span><span class="p">,</span> <span class="nx">chainFunction</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">listenersOnce</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">chainFunction</span> <span class="o">=</span> <span class="nx">chainFunction</span><span class="p">;</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Adds a callback function so it can be called when the event takes place.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>listener </span><span class="dox_type">function</span><span>- The callback function to be added to the event handler object. See the referenced Listener function documentation for more detail in each event handler object's documentation.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">listener</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">chainFunction</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="nx">chainFunction</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">));</span> 
                <span class="p">};</span>
                <span class="nx">listener</span><span class="p">.</span><span class="nx">CocoonEventHandlerChainFunction</span> <span class="o">=</span> <span class="nx">f</span><span class="p">;</span>
                <span class="nx">f</span><span class="p">.</span><span class="nx">sourceListener</span> <span class="o">=</span> <span class="nx">listener</span><span class="p">;</span>
                <span class="nx">listener</span> <span class="o">=</span> <span class="nx">f</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kd">var</span> <span class="nx">CocoonExtensionObject</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">getObjectFromPath</span><span class="p">(</span><span class="nx">Cocoon</span><span class="p">,</span> <span class="nx">CocoonExtensionObjectName</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">CocoonExtensionObject</span> <span class="o">&amp;&amp;</span> <span class="nx">CocoonExtensionObject</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">ext</span><span class="p">[</span><span class="nx">nativeExtensionObjectName</span><span class="p">].</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">nativeEventName</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">indexOfListener</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">listener</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">indexOfListener</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">listener</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">};</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Adds a callback function that will be called only one time.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>listener </span><span class="dox_type">function</span><span>- The callback function to be added to the event handler object. See the referenced Listener function documentation for more detail in each event handler object's documentation.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">addEventListenerOnce</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">listener</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">chainFunction</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">chainFunction</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">sourceListener</span><span class="p">,</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">));</span> <span class="p">};</span>
                <span class="nx">f</span><span class="p">.</span><span class="nx">sourceListener</span> <span class="o">=</span> <span class="nx">listener</span><span class="p">;</span>
                <span class="nx">listener</span> <span class="o">=</span> <span class="nx">f</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kd">var</span> <span class="nx">CocoonExtensionObject</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">getObjectFromPath</span><span class="p">(</span><span class="nx">Cocoon</span><span class="p">,</span> <span class="nx">CocoonExtensionObjectName</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">CocoonExtensionObject</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">ext</span><span class="p">[</span><span class="nx">nativeExtensionObjectName</span><span class="p">].</span><span class="nx">addEventListenerOnce</span><span class="p">(</span><span class="nx">nativeEventName</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">indexOfListener</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">listener</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">indexOfListener</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">listenersOnce</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">listener</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">};</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Removes a callback function that was added to the event handler so it won't be called when the event takes place.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>listener </span><span class="dox_type">function</span><span>- The callback function to be removed from the event handler object. See the referenced Listener function documentation for more detail in each event handler object's documentation.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">removeEventListener</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">listener</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">chainFunction</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">listener</span> <span class="o">=</span> <span class="nx">listener</span><span class="p">.</span><span class="nx">CocoonEventHandlerChainFunction</span><span class="p">;</span>
                <span class="k">delete</span> <span class="nx">listener</span><span class="p">.</span><span class="nx">CocoonEventHandlerChainFunction</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kd">var</span> <span class="nx">CocoonExtensionObject</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">getObjectFromPath</span><span class="p">(</span><span class="nx">Cocoon</span><span class="p">,</span> <span class="nx">CocoonExtensionObjectName</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">CocoonExtensionObject</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">ext</span><span class="p">[</span><span class="nx">nativeExtensionObjectName</span><span class="p">].</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">nativeEventName</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">indexOfListener</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">listener</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">indexOfListener</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">indexOfListener</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">};</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">removeEventListenerOnce</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">listener</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">chainFunction</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">listener</span> <span class="o">=</span> <span class="nx">listener</span><span class="p">.</span><span class="nx">CocoonEventHandlerChainFunction</span><span class="p">;</span>
                <span class="k">delete</span> <span class="nx">listener</span><span class="p">.</span><span class="nx">CocoonEventHandlerChainFunction</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kd">var</span> <span class="nx">CocoonExtensionObject</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">getObjectFromPath</span><span class="p">(</span><span class="nx">Cocoon</span><span class="p">,</span> <span class="nx">CocoonExtensionObjectName</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">CocoonExtensionObject</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">ext</span><span class="p">[</span><span class="nx">nativeExtensionObjectName</span><span class="p">].</span><span class="nx">removeEventListenerOnce</span><span class="p">(</span><span class="nx">nativeEventName</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">indexOfListener</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">listenersOnce</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">listener</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">indexOfListener</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">listenersOnce</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">indexOfListener</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">};</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@memberof Cocoon.EventHandler</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">notifyEventListeners</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">CocoonExtensionObject</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">getObjectFromPath</span><span class="p">(</span><span class="nx">Cocoon</span><span class="p">,</span> <span class="nx">CocoonExtensionObjectName</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">CocoonExtensionObject</span> <span class="o">&amp;&amp;</span> <span class="nx">CocoonExtensionObject</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">ext</span><span class="p">[</span><span class="nx">nativeExtensionObjectName</span><span class="p">].</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">nativeEventName</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

                <span class="kd">var</span> <span class="nx">argumentsArray</span><span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">listeners</span> <span class="o">=</span>     <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">listeners</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">listenersOnce</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">listenersOnce</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><p>Notify listeners after a while ;) === do not block this thread.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">listeners</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">listeners</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">,</span> <span class="nx">argumentsArray</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">listenersOnce</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">listenersOnce</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">,</span> <span class="nx">argumentsArray</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>

                <span class="nx">_this</span><span class="p">.</span><span class="nx">listenersOnce</span><span class="o">=</span> <span class="p">[];</span>
            <span class="p">}</span>
        <span class="p">};</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>
    </pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This function is used to create extensions in the global namespace of the "Cocoon" object.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>namespace </span><span class="dox_type">string</span><span>- The extensions namespace, ex: Cocoon.App.Settings.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">object</span><span>- The callback which holds the declaration of the new extension.</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">extension;</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extName</span><span class="p">,</span> <span class="nx">ext</span><span class="p">){</span>
        
        <span class="kd">var</span> <span class="nx">namespace</span> <span class="o">=</span> <span class="p">(</span><span class="nx">extName</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Cocoon.&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">extName</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">:</span> <span class="nx">extName</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">base</span>    <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Cocoon</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">parts</span>  <span class="o">=</span> <span class="nx">namespace</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">object</span> <span class="o">=</span> <span class="nx">base</span><span class="p">;</span>
    
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">part</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">(</span><span class="o">!</span><span class="nx">object</span><span class="p">[</span><span class="nx">part</span><span class="p">])</span> <span class="o">?</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Created namespace: &quot;</span> <span class="o">+</span> <span class="nx">extName</span><span class="p">)</span> <span class="o">:</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Updated namespace: - &quot;</span> <span class="o">+</span> <span class="nx">extName</span><span class="p">);</span>
            <span class="nx">object</span> <span class="o">=</span> <span class="nx">object</span><span class="p">[</span><span class="nx">part</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="p">(</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">?</span> <span class="nx">ext</span><span class="p">(</span> <span class="p">(</span><span class="nx">object</span><span class="p">[</span><span class="nx">part</span><span class="p">]</span> <span class="o">||</span> <span class="p">{})</span> <span class="p">)</span> <span class="o">:</span> <span class="p">{};</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Unable to create class &quot;</span> <span class="o">+</span> <span class="nx">extName</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
                
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Created namespace: Cocoon&quot;</span><span class="p">);</span>

<span class="p">})();;</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Signal&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This namespace is used to create an Event Emitter/Dispatcher that works together.<br />with the Cocoon.EventHandler.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This constructor creates a new Signal that holds and emits different events that are specified inside each extension.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">createSignal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@lends Cocoon.Signal.prototype</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">handle</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">signals</span> <span class="o">=</span> <span class="p">{};</span>
      </pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Registers a new Signal.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>namespace </span><span class="dox_type">string</span><span>- The name of the signal which will be emitted.</span></div><div class="dox_tag_detail"><span>handle </span><span class="dox_type">object</span><span>- The Cocoon.EventHandler that will handle the signals.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">register</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span> <span class="nx">handle</span><span class="p">){</span>

            <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="o">!</span><span class="nx">namespace</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">handle</span><span class="p">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t create signal &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">namespace</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">));</span>

            <span class="k">if</span><span class="p">(</span><span class="nx">handle</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">){</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="nx">namespace</span><span class="p">]</span> <span class="o">=</span> <span class="nx">handle</span><span class="p">;</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">handle</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">){</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="nx">namespace</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">handle</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="nx">handle</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">)){</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="nx">namespace</span><span class="p">][</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">handle</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">};</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
            
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t create handler for &quot;</span> <span class="o">+</span> <span class="nx">namespace</span> <span class="o">+</span> <span class="s2">&quot; signal.&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">},</span></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Exposes the already defined signals, and can be use to atach a callback to a Cocoon.EventHandler event.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>signal </span><span class="dox_type">string</span><span>- The name of the signal which will be emitted.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">object</span><span>- The Cocoon.EventHandler that will handle the signals.</span></div><div class="dox_tag_detail"><span>params </span><span class="dox_type">object</span><span>- Optional parameters, example { once : true }</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">expose</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">signal</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">){</span>
                <span class="kd">var</span> <span class="nx">once</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

                <span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">){</span>
                    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                    <span class="kd">var</span> <span class="nx">fnc</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">signal</span><span class="p">){</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">signal</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">;</span>
                    <span class="p">}</span>
                    
                    <span class="nx">fnc</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">functionListener</span><span class="p">){</span>
                        <span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">signal</span><span class="p">];</span>
                        <span class="k">if</span><span class="p">(</span><span class="nx">handle</span> <span class="o">&amp;&amp;</span> <span class="nx">handle</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">handle</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">that</span><span class="p">,[</span><span class="nx">functionListener</span><span class="p">]);</span>
                            <span class="nx">that</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">signal</span><span class="p">]</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">return</span> <span class="k">new</span> <span class="nx">fnc</span><span class="p">(</span><span class="nx">signal</span><span class="p">);</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">((</span><span class="nx">params</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">once</span><span class="p">)){</span>
                    <span class="nx">once</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="nx">signal</span><span class="p">])</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;The signal &quot;</span> <span class="o">+</span> <span class="nx">signal</span> <span class="o">+</span> <span class="s2">&quot; does not exists.&quot;</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="nx">signal</span><span class="p">];</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">handle</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">){</span>
                    <span class="k">if</span><span class="p">(</span><span class="nx">once</span><span class="p">){</span>
                        <span class="nx">handle</span><span class="p">.</span><span class="nx">addEventListenerOnce</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
                            <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="k">this</span> <span class="o">||</span> <span class="nb">window</span> <span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
                        <span class="p">});</span>
                    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="nx">handle</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
                            <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="k">this</span> <span class="o">||</span> <span class="nb">window</span> <span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
                        <span class="p">});</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="nx">signal</span><span class="p">].</span><span class="nx">addEventListener</span><span class="p">){</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="nx">signal</span><span class="p">])</span> <span class="p">{</span>
                        
                        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="nx">signal</span><span class="p">].</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
                        
                        <span class="kd">var</span> <span class="nx">handle</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">signals</span><span class="p">[</span><span class="nx">signal</span><span class="p">][</span><span class="nx">prop</span><span class="p">];</span>

                        <span class="k">if</span><span class="p">(</span><span class="nx">once</span><span class="p">){</span>
                            <span class="nx">handle</span><span class="p">.</span><span class="nx">addEventListenerOnce</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
                                <span class="k">this</span><span class="p">.</span><span class="nx">clbk</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span> <span class="k">this</span> <span class="o">||</span> <span class="nb">window</span> <span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
                            <span class="p">}.</span><span class="nx">bind</span><span class="p">({</span> <span class="nx">name</span> <span class="o">:</span> <span class="nx">prop</span> <span class="p">,</span> <span class="nx">clbk</span> <span class="o">:</span> <span class="nx">callback</span> <span class="p">}));</span>
                        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                            <span class="nx">handle</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
                                <span class="k">this</span><span class="p">.</span><span class="nx">clbk</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span> <span class="k">this</span> <span class="o">||</span> <span class="nb">window</span> <span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
                            <span class="p">}.</span><span class="nx">bind</span><span class="p">({</span> <span class="nx">name</span> <span class="o">:</span> <span class="nx">prop</span> <span class="p">,</span> <span class="nx">clbk</span> <span class="o">:</span> <span class="nx">callback</span> <span class="p">}));</span>
                        <span class="p">}</span>
                        
                    <span class="p">}</span>
                <span class="p">}</span>

        <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>

<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> * This namespace represents different methods to control your application.</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm"> * &lt;p&gt;Here you will find demos about this namespace: &lt;/p&gt; </span>
<span class="cm"> * &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/master/Rate&quot;&gt;Rate demo&lt;/a&gt;.&lt;/li&gt;</span>
<span class="cm"> * &lt;li&gt; &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/Sound&quot;&gt;Sound demo&lt;/a&gt;.&lt;/li&gt;</span>
<span class="cm"> * &lt;li&gt; &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/Vibration&quot;&gt;Vibration demo&lt;/a&gt;.&lt;/li&gt;</span>
<span class="cm"> * &lt;li&gt; &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/master/Basic%20examples&quot;&gt;Basic examples demo&lt;/a&gt;.&lt;/li&gt;&lt;/ul&gt;</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * @namespace Cocoon.App</span>
<span class="cm"> * @example</span>
<span class="cm"> * // Example 1: Closes the application</span>
<span class="cm"> * Cocoon.App.exit();</span>
<span class="cm"> * // Example 2: Opens a given URL</span>
<span class="cm"> * Cocoon.App.openURL(&quot;http://www.ludei.com&quot;);</span>
<span class="cm"> * // Example 3: Fired when the application is suspended</span>
<span class="cm"> * Cocoon.App.on(&quot;suspended&quot;, function(){</span>
<span class="cm"> *  ...</span>
<span class="cm"> * });</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.App&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    
    <span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">);</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">isBridgeAvailable</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forward</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">===</span> <span class="s1">&#39;boolean&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forward</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">available</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;forwardAvailable&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
            <span class="nx">available</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">available</span><span class="p">;</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forward</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="nx">available</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">available</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Makes a forward call of some javascript code to be executed in a different environment (i.e. from CocoonJS to the WebView and viceversa).<br />It waits until the code is executed and the result of it is returned === synchronous.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>code </span><span class="dox_type">string</span><span>- Some JavaScript code in a string to be forwarded and executed in a different JavaScript environment (i.e. from CocoonJS to the WebView and viceversa).</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">string</span><span>The result of the execution of the passed JavaScript code in the different JavaScript environment.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">forward</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">javaScriptCode</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">isBridgeAvailable</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">javaScriptCode</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">frames</span><span class="p">[</span><span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span><span class="p">].</span><span class="nb">window</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">javaScriptCode</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Makes a forward call of some javascript code to be executed in a different environment (i.e. from CocoonJS to the WebView and viceversa).<br />It is asyncrhonous so it does not wait until the code is executed and the result of it is returned. Instead, it calls a callback function when the execution has finished to pass the result.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>javaScriptCode </span><span class="dox_type">string</span><span>- Some JavaScript code in a string to be forwarded and executed in a different JavaScript environment (i.e. from CocoonJS to the WebView and viceversa).</span></div><div class="dox_tag_detail"><span>[callback] </span><span class="dox_type">function</span><span>- A function callback (optional) that will be called when the passed JavaScript code is executed in a different thread to pass the result of the execution in the different JavaScript environment.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">forwardAsync</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">javaScriptCode</span><span class="p">,</span> <span class="nx">returnCallback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">isBridgeAvailable</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">returnCallback</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCallAsync</span><span class="p">(</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="nx">javaScriptCode</span><span class="p">,</span> <span class="nx">returnCallback</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCallAsync</span><span class="p">(</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="nx">javaScriptCode</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">res</span><span class="p">;</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span> <span class="o">?</span> 
                    <span class="p">(</span><span class="nx">res</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">javaScriptCode</span><span class="p">),</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">returnCallback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">returnCallback</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">)</span> <span class="o">:</span>
                    <span class="p">(</span>
                        <span class="nx">res</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">frames</span><span class="p">[</span><span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span><span class="p">].</span><span class="nb">window</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">javaScriptCode</span><span class="p">),</span> 
                        <span class="p">(</span><span class="k">typeof</span> <span class="nx">returnCallback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">returnCallback</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span>
                    <span class="p">);</span>
            <span class="p">},</span> <span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-23"><td class="docs"><div class="pilwrap"><a href="#section-23" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to load a new JavaScript/HTML5 resource that can be loaded either locally (inside the platform/device storage) or using a remote URL.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>path </span><span class="dox_type">string</span><span>- A path to a resource stored in the platform or in a URL to a remote resource.</span></div><div class="dox_tag_detail"><span>[storageType] </span><span class="dox_type">Cocoon.App.StorageType</span><span>- If the path argument represents a locally stored resource, the developer can specify the storage where it is stored. If no value is passes, the {@link Cocoon.App.StorageType.APP_STORAGE} value is used by default.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">load</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">storageType</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;loadPath&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>

            <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">jsCode</span><span class="p">;</span></pre></div></td></tr><tr id="section-24"><td class="docs"><div class="pilwrap"><a href="#section-24" class="pilcrow">&#182;</a></div><p>If there is no webview, it means we are in the webview, so notify the CocoonJS environment</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;window.Cocoon &amp;&amp; window.Cocoon.App.onLoadInTheWebViewSucceed.notifyEventListeners(&#39;&quot;</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s2">&quot;&#39;);&quot;</span><span class="p">;</span>
                        <span class="p">}</span></pre></div></td></tr><tr id="section-25"><td class="docs"><div class="pilwrap"><a href="#section-25" class="pilcrow">&#182;</a></div><p>If there is a webview, it means we are in CocoonJS, so notify the webview environment</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="k">else</span> <span class="p">{</span>
                            <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;window.Cocoon &amp;&amp; window.Cocoon.App.onLoadInCocoonJSSucceed.notifyEventListeners(&#39;&quot;</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s2">&quot;&#39;);&quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
                        <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">path</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">404</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                        <span class="kd">var</span> <span class="nx">jsCode</span><span class="p">;</span></pre></div></td></tr><tr id="section-26"><td class="docs"><div class="pilwrap"><a href="#section-26" class="pilcrow">&#182;</a></div><p>If there is no webview, it means we are in the webview, so notify the CocoonJS environment</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon &amp;&amp; Cocoon.App.onLoadInTheWebViewFailed.notifyEventListeners(&#39;&quot;</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s2">&quot;&#39;);&quot;</span><span class="p">;</span>
                        <span class="p">}</span></pre></div></td></tr><tr id="section-27"><td class="docs"><div class="pilwrap"><a href="#section-27" class="pilcrow">&#182;</a></div><p>If there is a webview, it means we are in CocoonJS, so notify the webview environment</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="k">else</span> <span class="p">{</span>
                            <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon &amp;&amp; Cocoon.App.onLoadInCocoonJSFailed.notifyEventListeners(&#39;&quot;</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s2">&quot;&#39;);&quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">};</span>
            <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-28"><td class="docs"><div class="pilwrap"><a href="#section-28" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Reloads the last loaded path in the current context.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">reload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;reload&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">frames</span><span class="p">[</span><span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span><span class="p">].</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-29"><td class="docs"><div class="pilwrap"><a href="#section-29" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Opens a given URL using a system service that is able to open it. For example, open a HTTP URL using the system WebBrowser.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>url </span><span class="dox_type">string</span><span>- The URL to be opened by a system service.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">openURL</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;openURL&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="s1">&#39;_blank&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-30"><td class="docs"><div class="pilwrap"><a href="#section-30" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Forces the app to finish.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">exit</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;forceToFinish&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-31"><td class="docs"><div class="pilwrap"><a href="#section-31" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@memberof Cocoon.App</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">StorageType</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">APP_STORAGE</span><span class="o">:</span>        <span class="s2">&quot;APP_STORAGE&quot;</span><span class="p">,</span>
        <span class="nx">INTERNAL_STORAGE</span><span class="o">:</span>   <span class="s2">&quot;INTERNAL_STORAGE&quot;</span><span class="p">,</span>
        <span class="nx">EXTERNAL_STORAGE</span><span class="o">:</span>   <span class="s2">&quot;EXTERNAL_STORAGE&quot;</span><span class="p">,</span>
        <span class="nx">TEMPORARY_STORAGE</span><span class="o">:</span>  <span class="s2">&quot;TEMPORARY_STORAGE&quot;</span>
    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">onSuspended</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;onsuspended&quot;</span><span class="p">);</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">onActivated</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;onactivated&quot;</span><span class="p">);</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">onSuspending</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;onsuspending&quot;</span><span class="p">);</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">onMemoryWarning</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;onmemorywarning&quot;</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span></pre></div></td></tr><tr id="section-32"><td class="docs"><div class="pilwrap"><a href="#section-32" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events called when the application is suspended.<br />The callback function does not receive any parameter.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;suspended&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onSuspended</span><span class="p">);</span></pre></div></td></tr><tr id="section-33"><td class="docs"><div class="pilwrap"><a href="#section-33" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events called when the application is activated.<br />The callback function does not receive any parameter.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;activated&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onActivated</span><span class="p">);</span></pre></div></td></tr><tr id="section-34"><td class="docs"><div class="pilwrap"><a href="#section-34" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events called when the application is suspending.<br />The callback function does not receive any parameter.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;suspending&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onSuspending</span><span class="p">);</span></pre></div></td></tr><tr id="section-35"><td class="docs"><div class="pilwrap"><a href="#section-35" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to memory warning notifications from the system<br />It is strongly recommended that you implement this method and free up as much memory as possible by disposing of cached data objects, images on canvases that can be recreated.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>     <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;memorywarning&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onMemoryWarning</span><span class="p">);</span>


    <span class="nx">extension</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>
    
    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.App&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="kd">function</span> <span class="nx">checkEmulatedWebViewReady</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">emulatedWB</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebView</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">emulatedWB</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span> <span class="c1">//ready</span>
        <span class="p">}</span>

        <span class="nx">emulatedWB</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span> 
        <span class="nx">emulatedWB</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewDiv&#39;</span><span class="p">);</span> 
        <span class="nx">emulatedWB</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
        <span class="nx">emulatedWB</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
        <span class="nx">emulatedWB</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="s2">&quot;absolute&quot;</span><span class="p">;</span> 
        <span class="nx">emulatedWB</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
        <span class="nx">emulatedWB</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">emulatedWB</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s1">&#39;transparent&#39;</span><span class="p">;</span>
        <span class="nx">emulatedWB</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">border</span> <span class="o">=</span> <span class="s2">&quot;0px solid #000&quot;</span><span class="p">;</span> 

        <span class="kd">var</span> <span class="nx">frame</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;IFRAME&quot;</span><span class="p">);</span>
        <span class="nx">frame</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span><span class="p">);</span>
        <span class="nx">frame</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span><span class="p">);</span>
        <span class="nx">frame</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
        <span class="nx">frame</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
        <span class="nx">frame</span><span class="p">.</span><span class="nx">frameBorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">frame</span><span class="p">.</span><span class="nx">allowtransparency</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

        <span class="nx">emulatedWB</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">frame</span><span class="p">);</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebView</span> <span class="o">=</span> <span class="nx">emulatedWB</span><span class="p">;</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span> <span class="o">=</span> <span class="nx">frame</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">body</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebView</span><span class="p">);</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-36"><td class="docs"><div class="pilwrap"><a href="#section-36" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Pauses the Cocoon JavaScript execution loop.<br />The callback function does not receive any parameter.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">pause</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;pause&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-37"><td class="docs"><div class="pilwrap"><a href="#section-37" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Resumes the Cocoon JavaScript execution loop.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">resume</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;resume&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-38"><td class="docs"><div class="pilwrap"><a href="#section-38" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Loads a resource in the WebView environment from the Cocoon environment.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>path </span><span class="dox_type">string</span><span>- The path to the resource. It can be a remote URL or a path to a local file.</span></div><div class="dox_tag_detail"><span>[storageType] </span><span class="dox_type">Cocoon.App.StorageType</span><span>- An optional parameter to specify at which storage in the device the file path is stored. By default, APP_STORAGE is used.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">loadInTheWebView</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">storageType</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span> <span class="o">&amp;&amp;</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;loadInTheWebView&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>

            <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">((</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">&lt;=</span><span class="mi">299</span><span class="p">)</span> <span class="o">||</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="p">{</span>

                        <span class="nx">checkEmulatedWebViewReady</span><span class="p">();</span>
                        <span class="kd">var</span> <span class="nx">callback</span><span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
                            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">onLoadInTheWebViewSucceed</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
                            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;load&quot;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
                        <span class="p">};</span>

                        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span>
                            <span class="s2">&quot;load&quot;</span><span class="p">,</span> 
                            <span class="nx">callback</span>
                        <span class="p">);</span>
                        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span> <span class="nx">path</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">else</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">onLoadInTheWebViewFailed</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">};</span>
            <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-39"><td class="docs"><div class="pilwrap"><a href="#section-39" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Reloads the last loaded path in the WebView context.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">reloadWebView</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;reloadWebView&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="nx">checkEmulatedWebViewReady</span><span class="p">();</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-40"><td class="docs"><div class="pilwrap"><a href="#section-40" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows the webview.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>x </span><span class="dox_type">number</span><span>- The top lef x coordinate of the rectangle where the webview will be shown.</span></div><div class="dox_tag_detail"><span>y </span><span class="dox_type">number</span><span>- The top lef y coordinate of the rectangle where the webview will be shown.</span></div><div class="dox_tag_detail"><span>width </span><span class="dox_type">number</span><span>- The width of the rectangle where the webview will be shown.</span></div><div class="dox_tag_detail"><span>height </span><span class="dox_type">number</span><span>- The height of the rectangle where the webview will be shown.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">showTheWebView</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;showTheWebView&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="nx">checkEmulatedWebViewReady</span><span class="p">();</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="p">(</span><span class="nx">width</span> <span class="o">?</span> <span class="nx">width</span><span class="o">/</span><span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="p">(</span><span class="nx">height</span> <span class="o">?</span> <span class="nx">height</span><span class="o">/</span><span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebView</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">x</span> <span class="o">?</span> <span class="nx">x</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebView</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="p">(</span><span class="nx">y</span> <span class="o">?</span> <span class="nx">y</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebView</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="p">(</span><span class="nx">width</span> <span class="o">?</span> <span class="nx">width</span><span class="o">/</span><span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebView</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="p">(</span><span class="nx">height</span> <span class="o">?</span> <span class="nx">height</span><span class="o">/</span><span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebView</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s2">&quot;block&quot;</span><span class="p">;</span>

        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-41"><td class="docs"><div class="pilwrap"><a href="#section-41" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Hides the webview.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">hideTheWebView</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">javaScriptCodeToForward</span> <span class="o">=</span> <span class="s2">&quot;ext.IDTK_APP.makeCall(&#39;hide&#39;);&quot;</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="nx">javaScriptCodeToForward</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">checkEmulatedWebViewReady</span><span class="p">();</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebView</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-42"><td class="docs"><div class="pilwrap"><a href="#section-42" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sets a callback function that will be called whenever the system tries to finish the app.<br />The developer can specify how the system will react to the finish of the app by returning a<br />boolean value in the callback function: true means, close the app, false means that the developer<br />will handle the app close.<br />A common example of this is the back button in Android devices. When the back button is pressed, this<br />callback will be called and the system will react depending on the developers choice finishing, or not,<br />the application.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- A function object that will be called when the system</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">exitCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">appShouldFinishCallback</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span> <span class="o">&amp;&amp;</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">onidtkappfinish</span> <span class="o">=</span> <span class="nx">appShouldFinishCallback</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-43"><td class="docs"><div class="pilwrap"><a href="#section-43" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@private</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">forwardedEventFromTheWebView</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">eventName</span><span class="p">,</span> <span class="nx">eventDataString</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">eventData</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">eventDataString</span><span class="p">);</span>
        <span class="nx">eventData</span><span class="p">.</span><span class="nx">target</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Event</span><span class="p">(</span><span class="nx">eventName</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">att</span> <span class="k">in</span> <span class="nx">eventData</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">event</span><span class="p">[</span><span class="nx">att</span><span class="p">]</span> <span class="o">=</span> <span class="nx">eventData</span><span class="p">[</span><span class="nx">att</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="nx">event</span><span class="p">.</span><span class="nx">target</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">canvases</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;canvas&quot;</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">canvases</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">event</span><span class="p">.</span><span class="nx">target</span> <span class="o">=</span> <span class="nx">canvases</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">canvases</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">onLoadInTheWebViewSucceed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;forwardpageload&quot;</span><span class="p">);</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">onLoadInTheWebViewFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;forwardpagefail&quot;</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span>

    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;load&quot;</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">success</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onLoadInTheWebViewSucceed</span><span class="p">,</span>
        <span class="nx">error</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onLoadInTheWebViewFailed</span>
    <span class="p">});</span>
    
    <span class="nx">extension</span><span class="p">.</span><span class="nx">WebView</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">WebView</span> <span class="o">||</span> <span class="p">{};</span>
    <span class="nx">extension</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> * This namespace holds different utilities.</span>
<span class="cm"> * @namespace Cocoon.Utils</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Utils&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-44"><td class="docs"><div class="pilwrap"><a href="#section-44" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Prints in the console the memory usage of the currently alive textures.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">logMemoryInfo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;logMemoryInfo&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-45"><td class="docs"><div class="pilwrap"><a href="#section-45" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sets the texture reduction options. The texture reduction is a process that allows big images to be reduced/scaled down when they are loaded.<br />Although the quality of the images may decrease, it can be very useful in low end devices or those with limited amount of memory.<br />The function sets the threshold on image size (width or height) that will be used in order to know if an image should be reduced or not.<br />It also allows to specify a list of strings to identify in which images file paths should be applied (when they meet the size threshold requirement) <br />The developer will still think that the image is of the original size. CocoonJS handles all of the internals to be able to show the image correctly.<br />IMPORTANT NOTE: This function should be called when the application is initialized before any image is set to be loaded for obvious reasons ;).<br />and in which sould be forbid (even if they meet the threshold requirement).</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>sizeThreshold </span><span class="dox_type">number</span><span>- This parameter specifies the minimun size (either width or height) that an image should have in order to be reduced.</span></div><div class="dox_tag_detail"><span>applyTo </span><span class="dox_type">string</span><span class="dox_type">array</span><span>- This parameter can either be a string or an array of strings. It's purpose is to specify one (the string) or more (the array) substring(s) </span></div><div class="dox_tag_detail"><span>forbidFor </span><span class="dox_type">string</span><span class="dox_type">array</span><span>- This parameter can either be a string or an array of strings. It's purpose is to specify one (the string) or more (the array) substring(s) </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">textureReduction</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sizeThreshold</span><span class="p">,</span> <span class="nx">applyTo</span><span class="p">,</span> <span class="nx">forbidFor</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;setDefaultTextureReducerThreshold&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-46"><td class="docs"><div class="pilwrap"><a href="#section-46" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Marks a audio file to be used as music by the system. Cocoon, internally, differentiates among music files and sound files.<br />Music files are usually bigger in size and longer in duration that sound files. There can only be just one music file <br />playing at a specific given time. The developer can mark as many files as he/she wants to be treated as music. When the corresponding<br />HTML5 audio object is used, the system will automatically know how to treat the audio resource as music or as sound.<br />Note that it is not mandatory to use this function. The system automatically tries to identify if a file is suitable to be treated as music<br />or as sound by checking file size and duration thresholds. It is recommended, though, that the developer specifies him/herself what he/she considers<br />to be music.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>filePath </span><span class="dox_type">string</span><span>- File path to be marked as music</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">markAsMusic</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audioFilePath</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
           <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;addForceMusic&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-47"><td class="docs"><div class="pilwrap"><a href="#section-47" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Captures a image of the screen synchronously and saves it to a file. Sync mode allows to capture the screen in the middle of a frame rendering.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>fileName </span><span class="dox_type">string</span><span>- Desired file name and format (png or jpg). If no value is passed, &quot;capture.png&quot; value is used by default</span></div><div class="dox_tag_detail"><span>storageType </span><span class="dox_type">Cocoon.App.StorageType</span><span>- The developer can specify the storage where it is stored. If no value is passed, the {@link Cocoon.Utils.StorageType.TMP_STORAGE} value is used by default.</span></div><div class="dox_tag_detail"><span>captureType </span><span class="dox_type">Cocoon.Utils.CaptureType</span><span>- Optional value to choose capture type. See {@link Cocoon.Utils.CaptureType}.</span></div><div class="dox_tag_detail"><span>saveToGallery </span><span class="dox_type">boolean</span><span>- Optional value to specify if the capture image should be stored in the device image gallery or not.</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">The</span><span>URL of the saved file.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">captureScreen</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">storageType</span><span class="p">,</span> <span class="nx">captureType</span><span class="p">,</span> <span class="nx">saveToGallery</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;captureScreen&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-48"><td class="docs"><div class="pilwrap"><a href="#section-48" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Captures a image of the screen asynchronously and saves it to a file.<br />Async mode captures a final frame as soon as possible.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>fileName </span><span class="dox_type">string</span><span>- Desired file name and format (png or jpg). If no value is passed, &quot;capture.png&quot; value is used by default</span></div><div class="dox_tag_detail"><span>storageType </span><span class="dox_type">Cocoon.App.StorageType</span><span>- The developer can specify the storage where it is stored. If no value is passed, the {@see Cocoon.Utils.StorageType.TMP_STORAGE} value is used by default.</span></div><div class="dox_tag_detail"><span>captureType </span><span class="dox_type">Cocoon.Utils.CaptureType</span><span>- Optional value to choose capture type. See {@link Cocoon.Utils.CaptureType}.</span></div><div class="dox_tag_detail"><span>saveToGallery </span><span class="dox_type">boolean</span><span>- Optional value to specify if the capture image should be stored in the device image gallery or not.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- Response callback, check the error property to monitor errors. Check the 'url' property to get the URL of the saved Image</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">captureScreenAsync</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">storageType</span><span class="p">,</span> <span class="nx">captureType</span><span class="p">,</span> <span class="nx">saveToGallery</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;captureScreen&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-49"><td class="docs"><div class="pilwrap"><a href="#section-49" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Activates or deactivates the antialas functionality from the Cocoon rendering.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>enable </span><span class="dox_type">boolean</span><span>- A boolean value to enable (true) or disable (false) antialias.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setAntialias</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">enable</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
        <span class="p">{</span>
           <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;setDefaultAntialias&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-50"><td class="docs"><div class="pilwrap"><a href="#section-50" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Activates or deactivates the webgl functionality from the Cocoon Canvas+ rendering.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>enabled </span><span class="dox_type">boolean</span><span>- A boolean value to enable (true) or disable (false) webgl in Canvas+.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setWebGLEnabled</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">enabled</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
           <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;setDefaultAntialias&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-51"><td class="docs"><div class="pilwrap"><a href="#section-51" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Enables NPOT (not power of two) textures in Canvas+. <br />Canvas+ uses POT (power of two) textures by default. Enabling NPOT improves memory usage but may affect performance on old GPUs.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>enabled </span><span class="dox_type">boolean</span><span>- true to enable NPOT Textures</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setNPOTEnabled</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">enabled</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;setNPOTEnabled&quot;</span><span class="p">,</span> <span class="nx">enabled</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-52"><td class="docs"><div class="pilwrap"><a href="#section-52" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sets a max memory threshold in Canvas+ for canvas2D contexts.<br />If the maxMemory is enabled, CocoonJS checks the total amount of texture sizes (images and canvases). <br />When the memory size reaches the max memory threshold CocoonJS disposes least recently used textures until the memory fits the threshold. <br />It disposes textures used for JS Image objects (which can be reloaded later if needed).<br />It doesn't dispose canvas objects because they cannot be reconstructed if they are used again in a render operation.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>memoryInMBs </span><span class="dox_type">number</span><span>- max memory in megabytes</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setMaxMemory</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">memoryInMBs</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;setMaxMemory&quot;</span><span class="p">,</span> <span class="nx">memoryInMBs</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-53"><td class="docs"><div class="pilwrap"><a href="#section-53" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@memberof Cocoon.Utils</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">CaptureType</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">EVERYTHING</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="nx">COCOONJS_GL_SURFACE</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="nx">JUST_SYSTEM_VIEWS</span><span class="o">:</span><span class="mi">2</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-54"><td class="docs"><div class="pilwrap"><a href="#section-54" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Queries if a file exists in the specified path and storage type. If none or unknown storage type is specified, the TEMPORARY_STORAGE is used as default.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>path </span><span class="dox_type">string</span><span>- The relative path to look for inside the storage of the underlying system.</span></div><div class="dox_tag_detail"><span>storageType </span><span class="dox_type">Cocoon.App.StorageType</span><span>- The storage type where to look for the specified path inside the system.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">existsPath</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">storageType</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;existsPath&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-55"><td class="docs"><div class="pilwrap"><a href="#section-55" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Setups the internal text texture cache size.<br />In order to improve the performance of fill and stroke operations, a text texture cache is used internally. Once a text is drawn<br />a texture is stored that matches that text and that text configuration. If the same text is called to <br />be drawn, this cached texture would be used. <br />This function allows to set the size of the cache. A value of 0 would mean that no cache<br />will be used. </p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>{number} </span><span class="dox_type">size</span><span>- The size of the text cache.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setTextCacheSize</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">size</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;setTextCacheSize&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>

<span class="p">});;</span><span class="cm">/**</span>
<span class="cm">* Dialog functions (prompt / confirm).</span>
<span class="cm">*</span>
<span class="cm">*&lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm">* &lt;p&gt;Here you will find demos about this namespace: &lt;/p&gt; </span>
<span class="cm">* &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/master/Keyboard&quot;&gt;Keyboard demo&lt;/a&gt;.&lt;/li&gt;</span>
<span class="cm">* &lt;li&gt; &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/Vibration&quot;&gt;Vibration demo&lt;/a&gt;.&lt;/li&gt; &lt;/ul&gt;</span>
<span class="cm">*&lt;/div&gt;</span>
<span class="cm">* @namespace Cocoon.Dialog</span>
<span class="cm">*/</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Dialog&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-56"><td class="docs"><div class="pilwrap"><a href="#section-56" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@property {object} Cocoon.Dialog.keyboardType Types of input keyboard.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">keyboardType</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">TEXT</span><span class="o">:</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>

        <span class="nx">NUMBER</span><span class="o">:</span><span class="s2">&quot;num&quot;</span><span class="p">,</span>

        <span class="nx">PHONE</span><span class="o">:</span><span class="s2">&quot;phone&quot;</span><span class="p">,</span>

        <span class="nx">EMAIL</span><span class="o">:</span><span class="s2">&quot;email&quot;</span><span class="p">,</span>

        <span class="nx">URL</span><span class="o">:</span><span class="s2">&quot;url&quot;</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-57"><td class="docs"><div class="pilwrap"><a href="#section-57" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Pops up a text dialog so the user can introduce some text and the application can get it back. It is the first approach CocoonJS has taken to be able to introduce<br />text input in a easy way. The dialog execution events are passed to the application through the {@link Cocoon.Dialog.onTextDialogFinished} and the {@link Cocoon.Dialog.onTextDialogCancelled} event objects.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>param </span><span class="dox_type">object</span><span>- Object information.</span></div><div class="dox_tag_detail"><span>{string} </span><span class="dox_type">[param.title]</span><span>- The title to be displayed in the dialog.</span></div><div class="dox_tag_detail"><span>{string} </span><span class="dox_type">[param.message]</span><span>- The message to be displayed in the dialog, next to the text input field.</span></div><div class="dox_tag_detail"><span>{string} </span><span class="dox_type">[param.text]</span><span>- The initial text to be introduced in the text input field.</span></div><div class="dox_tag_detail"><span>{Cocoon.Dialog.keyboardType} </span><span class="dox_type">[param.type]</span><span>- Default value is Cocoon.Dialog.keyboardType.TEXT. The keyboard type to be used when the text has to be introduced.</span></div><div class="dox_tag_detail"><span>{string} </span><span class="dox_type">[param.cancelText]</span><span>- Default value is &quot;Cancel&quot;. The text to be displayed in the cancel button of the dialog.</span></div><div class="dox_tag_detail"><span>{string} </span><span class="dox_type">[param.confirmText]</span><span>- Default value is &quot;Ok&quot;. The text to be displayed in the ok button of the dialog.</span></div><div class="dox_tag_detail"><span>callbacks </span><span class="dox_type">callback</span><span>- - &lt;i&gt;success&lt;/i&gt; and &lt;i&gt;cancel&lt;/i&gt; callbacks called when the user confirms or cancel the dialog.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">prompt</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">callbacks</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">callbacks</span><span class="p">)</span>  <span class="k">throw</span><span class="p">(</span><span class="s2">&quot;Callback missing for Cocoon.Dialog.prompt();&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">defaultKeyboard</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">TEXT</span><span class="p">;</span>
        
        <span class="k">switch</span> <span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">type</span><span class="p">){</span>
            <span class="k">case</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">TEXT</span><span class="o">:</span>
                <span class="nx">defaultKeyboard</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">TEXT</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">NUMBER</span><span class="o">:</span>
                <span class="nx">defaultKeyboard</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">NUMBER</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">PHONE</span><span class="o">:</span>
                <span class="nx">defaultKeyboard</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">PHONE</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">EMAIL</span><span class="o">:</span>
                <span class="nx">defaultKeyboard</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">EMAIL</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">URL</span><span class="o">:</span>
                <span class="nx">defaultKeyboard</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">URL</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">title</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nx">message</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nx">text</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nx">type</span> <span class="o">:</span> <span class="nx">defaultKeyboard</span><span class="p">,</span>
            <span class="nx">cancelText</span> <span class="o">:</span> <span class="s2">&quot;Cancel&quot;</span><span class="p">,</span>
            <span class="nx">confirmText</span> <span class="o">:</span> <span class="s2">&quot;Ok&quot;</span>
        <span class="p">};</span>

        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">properties</span><span class="p">,</span><span class="nx">params</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">succedListener</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onTextDialogCancelled</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">errorListener</span><span class="p">);</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onTextDialogFinished</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">succedListener</span><span class="p">);</span>
            <span class="nx">callbacks</span><span class="p">.</span><span class="nx">success</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nb">window</span> <span class="p">,</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">));</span>
        <span class="p">};</span>
  
        <span class="kd">var</span> <span class="nx">errorListener</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onTextDialogCancelled</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">errorListener</span><span class="p">);</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onTextDialogFinished</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">succedListener</span><span class="p">);</span>
            <span class="nx">callbacks</span><span class="p">.</span><span class="nx">cancel</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nb">window</span> <span class="p">,</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">));</span>
        <span class="p">};</span>

        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onTextDialogCancelled</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">errorListener</span><span class="p">);</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onTextDialogFinished</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">succedListener</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;showTextDialog&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">prompt</span><span class="p">(</span><span class="nx">properties</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span> <span class="nx">properties</span><span class="p">.</span><span class="nx">text</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">eventObject</span> <span class="o">=</span> <span class="nx">result</span> <span class="o">?</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onTextDialogFinished</span> <span class="o">:</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onTextDialogCancelled</span><span class="p">;</span>
                <span class="nx">eventObject</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
            <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-58"><td class="docs"><div class="pilwrap"><a href="#section-58" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Pops up a message dialog so the user can decide between a yes or no like confirmation.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>params </span><span class="dox_type">object</span></div><div class="dox_tag_detail"><span>Default </span><span class="dox_type">params.title</span><span>- value is &quot;&quot;. The title to be displayed in the dialog.</span></div><div class="dox_tag_detail"><span>Default </span><span class="dox_type">params.message</span><span>- value is &quot;&quot;. The message to be displayed in the dialog, next to the text input field.</span></div><div class="dox_tag_detail"><span>Default </span><span class="dox_type">params.confirmText</span><span>- value is &quot;Ok&quot;. The text to be displayed for the confirm button.</span></div><div class="dox_tag_detail"><span>Default </span><span class="dox_type">params.cancelText</span><span>- value is &quot;Cancel&quot;. The text to be displayed for the deny button.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- - Called when the user accepts or cancel the dialog, it receives an argument true/false.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">confirm</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">callback</span><span class="p">)</span> <span class="k">throw</span><span class="p">(</span><span class="s2">&quot;Callback missing for Cocoon.Dialog.confirm();&quot;</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">title</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> 
            <span class="nx">message</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> 
            <span class="nx">cancelText</span> <span class="o">:</span> <span class="s2">&quot;Cancel&quot;</span><span class="p">,</span>
            <span class="nx">confirmText</span> <span class="o">:</span> <span class="s2">&quot;Ok&quot;</span>
        <span class="p">};</span>

        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">properties</span><span class="p">,</span><span class="nx">params</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">succedListener</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onMessageBoxDenied</span><span class="p">.</span><span class="nx">removeEventListenerOnce</span><span class="p">(</span><span class="nx">errorListener</span><span class="p">);</span>
            <span class="nx">callback</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="p">};</span>
        
        <span class="kd">var</span> <span class="nx">errorListener</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onMessageBoxConfirmed</span><span class="p">.</span><span class="nx">removeEventListenerOnce</span><span class="p">(</span><span class="nx">succedListener</span><span class="p">);</span>
            <span class="nx">callback</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
        <span class="p">};</span>

        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onMessageBoxDenied</span><span class="p">.</span><span class="nx">addEventListenerOnce</span><span class="p">(</span><span class="nx">errorListener</span><span class="p">);</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onMessageBoxConfirmed</span><span class="p">.</span><span class="nx">addEventListenerOnce</span><span class="p">(</span><span class="nx">succedListener</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;showMessageBox&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">confirm</span><span class="p">(</span><span class="nx">properties</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">eventObject</span> <span class="o">=</span> <span class="nx">result</span> <span class="o">?</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onMessageBoxConfirmed</span> <span class="o">:</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">onMessageBoxDenied</span><span class="p">;</span>
                <span class="nx">eventObject</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">();</span>
            <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-59"><td class="docs"><div class="pilwrap"><a href="#section-59" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows a keyboard to receive user input. The developer has to process input events and render the resulting text.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>param </span><span class="dox_type">object</span><span>- Object information.</span></div><div class="dox_tag_detail"><span>{Cocoon.Dialog.keyboardType} </span><span class="dox_type">[param.type]</span><span>- Default value is Cocoon.Dialog.keyboardType.TEXT. The keyboard type to be used when the text has to be introduced.</span></div><div class="dox_tag_detail"><span>callbacks </span><span class="dox_type">callback</span><span>- - &lt;i&gt;insertText&lt;/i&gt;, &lt;i&gt;deleteBackward&lt;/i&gt;, &lt;i&gt;done&lt;/i&gt;, &lt;i&gt;cancel&lt;/i&gt; callbacks called when the user clicks a key, confirms or cancels the keyboard session.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">showKeyboard</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">callbacks</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">||</span> <span class="p">{};</span>
        <span class="nx">params</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">type</span> <span class="o">||</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">keyboardType</span><span class="p">.</span><span class="nx">TEXT</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">insertCallback</span> <span class="o">=</span> <span class="nx">callbacks</span> <span class="o">&amp;&amp;</span> <span class="nx">callbacks</span><span class="p">.</span><span class="nx">insertText</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">deleteCallback</span> <span class="o">=</span> <span class="nx">callbacks</span> <span class="o">&amp;&amp;</span> <span class="nx">callbacks</span><span class="p">.</span><span class="nx">deleteBackward</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">doneCallback</span> <span class="o">=</span> <span class="nx">callbacks</span> <span class="o">&amp;&amp;</span> <span class="nx">callbacks</span><span class="p">.</span><span class="nx">done</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">cancelCallback</span> <span class="o">=</span>  <span class="nx">callbacks</span> <span class="o">&amp;&amp;</span> <span class="nx">callbacks</span><span class="p">.</span><span class="nx">cancel</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;showKeyboard&quot;</span><span class="p">,</span> 
                <span class="p">[</span><span class="nx">params</span><span class="p">,</span> <span class="nx">insertCallback</span><span class="p">,</span> <span class="nx">deleteCallback</span><span class="p">,</span> <span class="nx">doneCallback</span><span class="p">,</span> <span class="nx">cancelCallback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-60"><td class="docs"><div class="pilwrap"><a href="#section-60" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Dismisses a keyboard which was previusly shown by {@link Cocoon.Dialog.showKeyboard}</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">dismissKeyboard</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;dismissKeyboard&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-61"><td class="docs"><div class="pilwrap"><a href="#section-61" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows listening to events called when the text dialog is finished by accepting it's content.<br />The callback function's documentation is represented by {@link Cocoon.Dialog.OnTextDialogFinishedListener}</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">onTextDialogFinished</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;ontextdialogfinish&quot;</span><span class="p">);</span></pre></div></td></tr><tr id="section-62"><td class="docs"><div class="pilwrap"><a href="#section-62" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows listening to events called when the text dialog is finished by dismissing it's content.<br />The callback function does not receive any parameter.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">onTextDialogCancelled</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;ontextdialogcancel&quot;</span><span class="p">);</span></pre></div></td></tr><tr id="section-63"><td class="docs"><div class="pilwrap"><a href="#section-63" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows listening to events called when the text dialog is finished by accepting it's content.<br />The callback function does not receive any parameter.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">onMessageBoxConfirmed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;onmessageboxconfirmed&quot;</span><span class="p">);</span></pre></div></td></tr><tr id="section-64"><td class="docs"><div class="pilwrap"><a href="#section-64" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows listening to events called when the text dialog is finished by dismissing it's content.<br />The callback function does not receive any parameter.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">onMessageBoxDenied</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;onmessageboxdenied&quot;</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>

<span class="p">});</span>
<span class="p">;</span><span class="cm">/**</span>
<span class="cm">* This namespace represents all functionalities available in the WebView environment.</span>
<span class="cm">*</span>
<span class="cm">* &lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm">*   Here you will find a demo about this namespace: &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/Webview&quot;&gt;Webview demo&lt;/a&gt;.</span>
<span class="cm">*&lt;/div&gt;</span>
<span class="cm">*</span>
<span class="cm">* @namespace Cocoon.WebView</span>
<span class="cm">* @example</span>
<span class="cm">* Cocoon.WebView.on(&quot;load&quot;,{</span>
<span class="cm">*   success : function(){</span>
<span class="cm">*       Cocoon.App.showTheWebView();</span>
<span class="cm">*   },</span>
<span class="cm">*   error : function(){</span>
<span class="cm">*        console.log(&quot;Cannot show the Webview for some reason :/&quot;);</span>
<span class="cm">*   }</span>
<span class="cm">* });</span>
<span class="cm">* Cocoon.App.loadInTheWebView(&quot;WV.html&quot;);</span>
<span class="cm">*/</span>

<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.WebView&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">Cocoon</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="nx">Cocoon</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span>  <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span></pre></div></td></tr><tr id="section-65"><td class="docs"><div class="pilwrap"><a href="#section-65" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows a transparent WebView on top of the Cocoon hardware accelerated environment rendering context.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>[x] </span><span class="dox_type">number</span><span>- The horizontal position where to show the WebView.</span></div><div class="dox_tag_detail"><span>[y] </span><span class="dox_type">number</span><span>- The vertical position where to show the WebView.</span></div><div class="dox_tag_detail"><span>[width] </span><span class="dox_type">number</span><span>- The horitonzal size of the WebView.</span></div><div class="dox_tag_detail"><span>[height] </span><span class="dox_type">number</span><span>- the vertical size of the WebView.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">show</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
           <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;show&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewDiv&#39;</span><span class="p">);</span>
            <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">x</span> <span class="o">?</span> <span class="nx">x</span> <span class="o">:</span> <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="p">(</span><span class="nx">y</span> <span class="o">?</span> <span class="nx">y</span> <span class="o">:</span> <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="p">(</span><span class="nx">width</span> <span class="o">?</span> <span class="nx">width</span><span class="o">/</span><span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="p">(</span><span class="nx">height</span> <span class="o">?</span> <span class="nx">height</span><span class="o">/</span><span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s2">&quot;block&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span><span class="p">);</span>
            <span class="nx">iframe</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="p">(</span><span class="nx">width</span> <span class="o">?</span> <span class="nx">width</span><span class="o">/</span><span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
            <span class="nx">iframe</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="p">(</span><span class="nx">height</span> <span class="o">?</span> <span class="nx">height</span><span class="o">/</span><span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-66"><td class="docs"><div class="pilwrap"><a href="#section-66" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Hides the transparent WebView on top of the Cocoon hardware acceleration environment rendering contect.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">hide</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
           <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;hide&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewDiv&#39;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-67"><td class="docs"><div class="pilwrap"><a href="#section-67" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Loads a resource in the Cocoon environment from the WebView environment. </p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>path </span><span class="dox_type">string</span><span>- The path to the resource. It can be a remote URL or a path to a local file.</span></div><div class="dox_tag_detail"><span>cb </span><span class="dox_type">callbacks</span><span>- - An object containing two callbacks, { success : callback, error: callback }.</span></div><div class="dox_tag_detail"><span>[storageType] </span><span class="dox_type">Cocoon.App.StorageType</span><span>- An optional parameter to specify at which storage in the device the file path is stored. By default, APP_STORAGE is used.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">loadInCocoon</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">callbacks</span><span class="p">,</span> <span class="nx">storageType</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">javaScriptCodeToForward</span> <span class="o">=</span> <span class="s2">&quot;ext.IDTK_APP.makeCall(&#39;loadPath&#39;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">path</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nx">javaScriptCodeToForward</span> <span class="o">+=</span> <span class="s2">&quot;, &#39;&quot;</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">storageType</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="nx">javaScriptCodeToForward</span> <span class="o">+=</span> <span class="s2">&quot;, &#39;&quot;</span> <span class="o">+</span> <span class="nx">storageType</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">javaScriptCodeToForward</span> <span class="o">+=</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>

            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="nx">javaScriptCodeToForward</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="s2">&quot;Cocoon.App.load(&#39;&quot;</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s2">&quot;&#39;);&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">reloadCocoonJS</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="s2">&quot;ext.IDTK_APP.makeCall(&#39;reload&#39;);&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span>


    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;load&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        </pre></div></td></tr><tr id="section-68"><td class="docs"><div class="pilwrap"><a href="#section-68" class="pilcrow">&#182;</a></div><p>Only if we are completely outside CocoonJS (or CocoonJS' webview),
setup event forwarding from the webview (iframe) to Cocoon.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;CocoonJS_App_ForCocoonJS_WebViewIFrame&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardEventsToCocoonJSEnabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">EVENT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;timeStamp&#39;</span><span class="p">,</span> <span class="s1">&#39;button&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;pageX&#39;</span><span class="p">,</span> <span class="s1">&#39;pageY&#39;</span><span class="p">,</span> <span class="s1">&#39;clientX&#39;</span><span class="p">,</span> <span class="s1">&#39;clientY&#39;</span><span class="p">,</span> <span class="s1">&#39;offsetX&#39;</span><span class="p">,</span> <span class="s1">&#39;offsetY&#39;</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">EVENTS</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;dblclick&quot;</span><span class="p">,</span> <span class="s2">&quot;touchmove&quot;</span><span class="p">,</span> <span class="s2">&quot;mousemove&quot;</span><span class="p">,</span> <span class="s2">&quot;touchend&quot;</span><span class="p">,</span> <span class="s2">&quot;touchcancel&quot;</span><span class="p">,</span> <span class="s2">&quot;mouseup&quot;</span><span class="p">,</span> <span class="s2">&quot;touchstart&quot;</span><span class="p">,</span> <span class="s2">&quot;mousedown&quot;</span><span class="p">,</span> <span class="s2">&quot;release&quot;</span><span class="p">,</span> <span class="s2">&quot;dragleft&quot;</span><span class="p">,</span> <span class="s2">&quot;dragright&quot;</span><span class="p">,</span> <span class="s2">&quot;swipeleft&quot;</span><span class="p">,</span> <span class="s2">&quot;swiperight&quot;</span> <span class="p">];</span>
            <span class="kd">function</span> <span class="nx">forwardEventToCocoonJS</span><span class="p">(</span><span class="nx">eventName</span><span class="p">,</span> <span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">eventData</span> <span class="o">=</span> <span class="p">{};</span>
                <span class="kd">var</span> <span class="nx">att</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">att</span> <span class="k">in</span> <span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">i</span> <span class="o">=</span> <span class="nx">EVENT_ATTRIBUTES</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">att</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">eventData</span><span class="p">[</span><span class="nx">att</span><span class="p">]</span> <span class="o">=</span> <span class="nx">event</span><span class="p">[</span><span class="nx">att</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon &amp;&amp; Cocoon.App &amp;&amp; Cocoon.App.forwardedEventFromTheWebView &amp;&amp; Cocoon.App.forwardedEventFromTheWebView(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">eventName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &#39;&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">eventData</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;);&quot;</span><span class="p">;</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forward</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">EVENTS</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">EVENTS</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">eventName</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardEventsToCocoonJSEnabled</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">forwardEventToCocoonJS</span><span class="p">(</span><span class="nx">eventName</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">};</span>
                <span class="p">})(</span><span class="nx">EVENTS</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">});</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">onLoadInCocoonJSSucceed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;forwardpageload&quot;</span><span class="p">);</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">onLoadInCocoonJSFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="s2">&quot;forwardpagefail&quot;</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Proxify&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-69"><td class="docs"><div class="pilwrap"><a href="#section-69" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Proxies different functions of the WebView environment, like Audio objects and XHR.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-70"><td class="docs"><div class="pilwrap"><a href="#section-70" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@function getKeyForValueInDictionary</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">getKeyForValueInDictionary</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dictionary</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">finalKey</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">dictionary</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">dictionary</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">===</span> <span class="nx">value</span><span class="p">){</span>
                <span class="nx">finalKey</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">finalKey</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-71"><td class="docs"><div class="pilwrap"><a href="#section-71" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Setups a origin proxy for a given typeName. What this means is that after calling this function the environment that makes this call will suddenly<br />have a way of creating instances of the given typeName and those instances will act as a transparent proxy to counterpart instances in the destination environment.<br />Manipulating attributes, calling funcitions or handling events will all be performed in the destination environment but the developer will think they will be<br />happening in the origin environment.<br />IMPORTANT NOTE: These proxies only work with types that use attributes and function parameters and return types that are primitive like numbers, strings or arrays.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The name of the type to be proxified.</span></div><div class="dox_tag_detail"><span>[attributeNames] </span><span class="dox_type">array</span><span>- A list of the names of the attributes to be proxified.</span></div><div class="dox_tag_detail"><span>[functionNames] </span><span class="dox_type">array</span><span>- A list of the names of the functions to be proxified.</span></div><div class="dox_tag_detail"><span>[eventHandlerNames] </span><span class="dox_type">array</span><span>- A list of the names of the event handlers to be proxified (onXXXX like attributes that represent callbacks).</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setupOriginProxyType</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">,</span> <span class="nx">attributeNames</span><span class="p">,</span> <span class="nx">functionNames</span><span class="p">,</span> <span class="nx">eventHandlerNames</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">){</span></pre></div></td></tr><tr id="section-72"><td class="docs"><div class="pilwrap"><a href="#section-72" class="pilcrow">&#182;</a></div><p>Control the parameters.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">typeName</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;The given typeName must be valid.&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">attributeNames</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">functionNames</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">eventHandlerNames</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;There is no point on setting up a proxy for no attributes, functions nor eventHandlers.&quot;</span><span class="p">;</span>
            <span class="nx">attributeNames</span> <span class="o">=</span> <span class="nx">attributeNames</span> <span class="o">?</span> <span class="nx">attributeNames</span> <span class="o">:</span> <span class="p">[];</span>
            <span class="nx">functionNames</span> <span class="o">=</span> <span class="nx">functionNames</span> <span class="o">?</span> <span class="nx">functionNames</span> <span class="o">:</span> <span class="p">[];</span>
            <span class="nx">eventHandlerNames</span> <span class="o">=</span> <span class="nx">eventHandlerNames</span> <span class="o">?</span> <span class="nx">eventHandlerNames</span> <span class="o">:</span> <span class="p">[];</span></pre></div></td></tr><tr id="section-73"><td class="docs"><div class="pilwrap"><a href="#section-73" class="pilcrow">&#182;</a></div><p>The parent object will be the window. It could be another object but careful, the destination side should know about this.
TODO: Specify the parentObject as a parameter, obtain it's path from the window object and pass it to the destination environment so it knows about it.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span></pre></div></td></tr><tr id="section-74"><td class="docs"><div class="pilwrap"><a href="#section-74" class="pilcrow">&#182;</a></div><p>Setup the destination side too.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon.Proxify.setupDestinationProxyType(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">typeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">eventHandlerNames</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forward</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>

            <span class="kd">var</span> <span class="nx">originalType</span> <span class="o">=</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">];</span></pre></div></td></tr><tr id="section-75"><td class="docs"><div class="pilwrap"><a href="#section-75" class="pilcrow">&#182;</a></div><p>Constructor. This will be the new proxified type in the origin environment. Instances of this type will be created by the developer without knowing that they are
internally calling to their counterparts in the destination environment.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></pre></div></td></tr><tr id="section-76"><td class="docs"><div class="pilwrap"><a href="#section-76" class="pilcrow">&#182;</a></div><p>Each proxy object will have a origin object inside with all the necessary information to be a proxy to the destination.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span> <span class="o">=</span> <span class="p">{};</span></pre></div></td></tr><tr id="section-77"><td class="docs"><div class="pilwrap"><a href="#section-77" class="pilcrow">&#182;</a></div><p>The id is obtained calling to the destination side to create an instance of the type.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon.Proxify.newDestinationProxyObject(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">typeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forward</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span></pre></div></td></tr><tr id="section-78"><td class="docs"><div class="pilwrap"><a href="#section-78" class="pilcrow">&#182;</a></div><p>The eventHandlers dictionary contains objects of the type { eventHandlerName : string, eventHandler : function } to be able to make the callbacks when the 
webview makes the corresponding calls.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventHandlers</span> <span class="o">=</span> <span class="p">{};</span></pre></div></td></tr><tr id="section-79"><td class="docs"><div class="pilwrap"><a href="#section-79" class="pilcrow">&#182;</a></div><p>Also store the typename inside each instance.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">typeName</span> <span class="o">=</span> <span class="nx">typeName</span><span class="p">;</span></pre></div></td></tr><tr id="section-80"><td class="docs"><div class="pilwrap"><a href="#section-80" class="pilcrow">&#182;</a></div><p>A dictionary to store the event handlers</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventListeners</span> <span class="o">=</span> <span class="p">{};</span></pre></div></td></tr><tr id="section-81"><td class="docs"><div class="pilwrap"><a href="#section-81" class="pilcrow">&#182;</a></div><p>TODO: eventHandlers and eventListeners should be in the same list ;)</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-82"><td class="docs"><div class="pilwrap"><a href="#section-82" class="pilcrow">&#182;</a></div><p>Store all the proxy instances in a list that belongs to the type itself.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></pre></div></td></tr><tr id="section-83"><td class="docs"><div class="pilwrap"><a href="#section-83" class="pilcrow">&#182;</a></div><p>Create a setter and a getter for all the attribute names that have been specified. When the attributes are accessed (set or get) a call to the destination counterpart will be performed.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">attributeNames</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">attributeName</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">_this</span><span class="p">.</span><span class="nx">__defineSetter__</span><span class="p">(</span><span class="nx">attributeName</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
                            <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon.Proxify.setDestinationProxyObjectAttribute(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">typeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">attributeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
                            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forward</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
                        <span class="p">});</span>
                        <span class="nx">_this</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="nx">attributeName</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                            <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon.Proxify.getDestinationProxyObjectAttribute(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">typeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">attributeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
                            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forward</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
                        <span class="p">});</span>
                    <span class="p">})(</span><span class="nx">attributeNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="p">}</span></pre></div></td></tr><tr id="section-84"><td class="docs"><div class="pilwrap"><a href="#section-84" class="pilcrow">&#182;</a></div><p>Create a function that performs a call to the destination environment counterpart for all the function names that have been specified.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">functionNames</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">functionName</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">_this</span><span class="p">[</span><span class="nx">functionName</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span></pre></div></td></tr><tr id="section-85"><td class="docs"><div class="pilwrap"><a href="#section-85" class="pilcrow">&#182;</a></div><p>Get the arguments as an array and add the typeName, the proxy id and the functionName before all the other arguments before making the call to the destination counterpart.</p>
</td><td class="code"><div class="highlight"><pre>                            <span class="kd">var</span> <span class="nx">argumentsArray</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
                            <span class="nx">argumentsArray</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">functionName</span><span class="p">);</span>
                            <span class="nx">argumentsArray</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
                            <span class="nx">argumentsArray</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">typeName</span><span class="p">);</span></pre></div></td></tr><tr id="section-86"><td class="docs"><div class="pilwrap"><a href="#section-86" class="pilcrow">&#182;</a></div><p>Use the array to create the correct function call.</p>
</td><td class="code"><div class="highlight"><pre>                            <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon.Proxify.callDestinationProxyObjectFunction(&quot;</span><span class="p">;</span>
                            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">argumentsArray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-87"><td class="docs"><div class="pilwrap"><a href="#section-87" class="pilcrow">&#182;</a></div><p>The second argument (the id) should not be stringified</p>
</td><td class="code"><div class="highlight"><pre>                                <span class="nx">jsCode</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">i</span> <span class="o">!==</span> <span class="mi">1</span> <span class="o">?</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">argumentsArray</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">:</span> <span class="nx">argumentsArray</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">argumentsArray</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">?</span> <span class="s2">&quot;, &quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
                            <span class="p">}</span>
                            <span class="nx">jsCode</span> <span class="o">+=</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-88"><td class="docs"><div class="pilwrap"><a href="#section-88" class="pilcrow">&#182;</a></div><p>TODO: This next call should be synchronous but it seems that some customers are experiencing some crash issues. Making it async solves these crashes.
Another possible solution could be to be able to specify which calls could be async and which sync in the proxification array.</p>
</td><td class="code"><div class="highlight"><pre>                            <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
                            <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
                        <span class="p">};</span>
                    <span class="p">})(</span><span class="nx">functionNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="p">}</span></pre></div></td></tr><tr id="section-89"><td class="docs"><div class="pilwrap"><a href="#section-89" class="pilcrow">&#182;</a></div><p>Create a setter and getter for all the event handler names that have been specified. When the event handlers are accessed, store them inside the corresponding position on the eventHandlers
array so they can be called when the destination environment makes the corresponding callback call.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">eventHandlerNames</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">eventHandlerName</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">_this</span><span class="p">.</span><span class="nx">__defineSetter__</span><span class="p">(</span><span class="nx">eventHandlerName</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">_this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventHandlers</span><span class="p">[</span><span class="nx">eventHandlerName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
                        <span class="p">});</span>
                        <span class="nx">_this</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="nx">eventHandlerName</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                            <span class="k">return</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventHandlers</span><span class="p">[</span><span class="nx">eventHandlerName</span><span class="p">];</span>
                        <span class="p">});</span>
                    <span class="p">})(</span><span class="nx">eventHandlerNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="p">}</span></pre></div></td></tr><tr id="section-90"><td class="docs"><div class="pilwrap"><a href="#section-90" class="pilcrow">&#182;</a></div><p>Setup the add and remove event listeners in the proxy object</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">_this</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">eventTypeName</span><span class="p">,</span> <span class="nx">eventCallback</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">addEventCallback</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></pre></div></td></tr><tr id="section-91"><td class="docs"><div class="pilwrap"><a href="#section-91" class="pilcrow">&#182;</a></div><p>Check for the eventListeners</p>
</td><td class="code"><div class="highlight"><pre>                    <span class="kd">var</span> <span class="nx">eventListeners</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventListeners</span><span class="p">[</span><span class="nx">eventTypeName</span><span class="p">];</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">eventListeners</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-92"><td class="docs"><div class="pilwrap"><a href="#section-92" class="pilcrow">&#182;</a></div><p>As the eventListeners were already added, check that the same callback has not been added.</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="nx">addEventCallback</span> <span class="o">=</span> <span class="nx">eventListeners</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">eventCallback</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-93"><td class="docs"><div class="pilwrap"><a href="#section-93" class="pilcrow">&#182;</a></div><p>There are no event listeners, so add the one and add the listeners array for the specific event type name</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="nx">eventListeners</span> <span class="o">=</span> <span class="p">[];</span>
                        <span class="nx">_this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventListeners</span><span class="p">[</span><span class="nx">eventTypeName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">eventListeners</span><span class="p">;</span></pre></div></td></tr><tr id="section-94"><td class="docs"><div class="pilwrap"><a href="#section-94" class="pilcrow">&#182;</a></div><p>Forward the call so the other end registers a event listener (only one is needed).</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon.Proxify.addDestinationProxyObjectEventListener(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">typeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">eventTypeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
                        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
                    <span class="p">}</span></pre></div></td></tr><tr id="section-95"><td class="docs"><div class="pilwrap"><a href="#section-95" class="pilcrow">&#182;</a></div><p>Only if the alforithm above specify so, add the eventcallback and notify the destination environment to do the same</p>
</td><td class="code"><div class="highlight"><pre>                    <span class="k">if</span> <span class="p">(</span><span class="nx">addEventCallback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">eventListeners</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">eventCallback</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">};</span>

                <span class="nx">_this</span><span class="p">.</span><span class="nx">removeEventListener</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">eventTypeName</span><span class="p">,</span> <span class="nx">eventCallback</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-96"><td class="docs"><div class="pilwrap"><a href="#section-96" class="pilcrow">&#182;</a></div><p>Check for the eventListeners</p>
</td><td class="code"><div class="highlight"><pre>                    <span class="kd">var</span> <span class="nx">eventListeners</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventListeners</span><span class="p">[</span><span class="nx">eventTypeName</span><span class="p">];</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">eventListeners</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">eventCallbackIndex</span> <span class="o">=</span> <span class="nx">eventListeners</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">eventCallback</span><span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">eventCallbackIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">eventListeners</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">eventCallbackIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">};</span></pre></div></td></tr><tr id="section-97"><td class="docs"><div class="pilwrap"><a href="#section-97" class="pilcrow">&#182;</a></div><p>Return the proxy instance.</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
            <span class="p">};</span></pre></div></td></tr><tr id="section-98"><td class="docs"><div class="pilwrap"><a href="#section-98" class="pilcrow">&#182;</a></div><p>The type will contain a proxy data structure to store all the instances that are created so they are available when the destination environment calls back. </p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span> <span class="o">=</span>
            <span class="p">{</span>
                <span class="nx">originalType</span><span class="o">:</span><span class="nx">originalType</span><span class="p">,</span>
                <span class="nx">proxyObjects</span><span class="o">:</span><span class="p">[]</span>
            <span class="p">};</span></pre></div></td></tr><tr id="section-99"><td class="docs"><div class="pilwrap"><a href="#section-99" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Deletes a proxy instance from both the CocoonJS environment structures and also deleting it's webview environment counterpart.<br />This function should be manually called whenever a proxy instance won't be accessed anymore.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>object </span><span class="dox_type">object</span><span>- The proxy object to be deleted.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">deleteProxyObject</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">proxyObjectKey</span> <span class="o">=</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">getKeyForValueInDictionary</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">,</span> <span class="nx">object</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">proxyObjectKey</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon.Proxify.deleteDestinationProxyObject(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">typeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">object</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
                    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
                    <span class="nx">object</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                    <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="nx">proxyObjectKey</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">};</span></pre></div></td></tr><tr id="section-100"><td class="docs"><div class="pilwrap"><a href="#section-100" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Calls an event handler for the given proxy object id and an eventHandlerName.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>id </span><span class="dox_type">number</span><span>- The id to be used to look for the proxy object for which to make the call to it's event handler.</span></div><div class="dox_tag_detail"><span>eventHandlerName </span><span class="dox_type">string</span><span>- The name of the handler to be called.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">callProxyObjectEventHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">eventHandlerName</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">object</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">eventHandler</span> <span class="o">=</span> <span class="nx">object</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventHandlers</span><span class="p">[</span><span class="nx">eventHandlerName</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">eventHandler</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">eventHandler</span><span class="p">({</span> <span class="nx">target</span><span class="o">:</span><span class="nx">object</span> <span class="p">});</span>
                <span class="p">}</span>
            <span class="p">};</span>

            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">callProxyObjectEventListeners</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">eventTypeName</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">object</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">eventListeners</span> <span class="o">=</span> <span class="nx">object</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventListeners</span><span class="p">[</span><span class="nx">eventTypeName</span><span class="p">].</span><span class="nx">slice</span><span class="p">();</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">eventListeners</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">eventListeners</span><span class="p">[</span><span class="nx">i</span><span class="p">]({</span> <span class="nx">target</span><span class="o">:</span><span class="nx">object</span> <span class="p">});</span>
                <span class="p">}</span>
            <span class="p">};</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-101"><td class="docs"><div class="pilwrap"><a href="#section-101" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Takes down the proxification of a type and restores it to it's original type. Do not worry if you pass a type name that is not proxified yet. The<br />function will handle it correctly for compativility reasons.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The name of the type to be deproxified (take down the proxification and restore the type to it's original state)</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">takedownOriginProxyType</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">originalType</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-102"><td class="docs"><div class="pilwrap"><a href="#section-102" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Deletes everything related to a proxy object in both environments. Do not worry of you do not pass a proxified object to the<br />function. For compatibility reasons, you can still have calls to this function even when no poxification of a type has been done.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>object </span><span class="dox_type">object</span><span>- The proxified object to be deleted.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">deleteOriginProxyObject</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">object</span> <span class="o">&amp;&amp;</span> <span class="nx">object</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">parentObject</span><span class="p">[</span><span class="nx">object</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">deleteProxyObject</span><span class="p">(</span><span class="nx">object</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-103"><td class="docs"><div class="pilwrap"><a href="#section-103" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Calls the origin proxy object when an event handler need to be updated/called from the destination environment.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The type name of the proxified type.</span></div><div class="dox_tag_detail"><span>id </span><span class="dox_type">number</span><span>- The id of the proxy object.</span></div><div class="dox_tag_detail"><span>eventHandlerName </span><span class="dox_type">string</span><span>- The name of the event handler to be called.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">callOriginProxyObjectEventHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">eventHandlerName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">callProxyObjectEventHandler</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">eventHandlerName</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-104"><td class="docs"><div class="pilwrap"><a href="#section-104" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Calls the origin proxy object when all the event listeners related to a specific event need to be updated/called from the destination environment.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The type name of the proxified type.</span></div><div class="dox_tag_detail"><span>id </span><span class="dox_type">number</span><span>- The id of the proxy object.</span></div><div class="dox_tag_detail"><span>eventTypeName </span><span class="dox_type">string</span><span>- The name of the event type to call the listeners related to it.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">callOriginProxyObjectEventListeners</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">eventTypeName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">callProxyObjectEventListeners</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">eventTypeName</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-105"><td class="docs"><div class="pilwrap"><a href="#section-105" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Setups all the structures that are needed to proxify a destination type to an origin type.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The name of the type to be proxified.</span></div><div class="dox_tag_detail"><span>eventHandlerNames </span><span class="dox_type">array</span><span>- An array with al the event handlers to be proxified. Needed in order to be able to create callbacks for all the event handlers</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setupDestinationProxyType</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">,</span> <span class="nx">eventHandlerNames</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span></pre></div></td></tr><tr id="section-106"><td class="docs"><div class="pilwrap"><a href="#section-106" class="pilcrow">&#182;</a></div><p>Add a cocoonjs structure to the destination proxified type to store some useful information like all the proxy instances that are created, plus the id counter 
and the names of all the event handlers and some utility functions.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span> <span class="o">=</span>
            <span class="p">{</span>
                <span class="nx">nextId</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span>
                <span class="nx">proxyObjects</span><span class="o">:</span><span class="p">{},</span>
                <span class="nx">eventHandlerNames</span><span class="o">:</span><span class="nx">eventHandlerNames</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-107"><td class="docs"><div class="pilwrap"><a href="#section-107" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Takes down the proxy type at the destination environment. Just removes the data structure related to proxies that was added to the type when proxification tool place.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The name of the type to take the proxification down.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">takedownDestinationProxyType</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">parent</span><span class="p">[</span><span class="nx">typeName</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">delete</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-108"><td class="docs"><div class="pilwrap"><a href="#section-108" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Creates a new destination object instance and generates a id to reference it from the original environment.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The name of the type to be proxified and to generate an instance.</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">The</span><span>id to be used from the original environment to identify the corresponding destination object instance.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">newDestinationProxyObject</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>

            <span class="kd">var</span> <span class="nx">proxyObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">]();</span></pre></div></td></tr><tr id="section-109"><td class="docs"><div class="pilwrap"><a href="#section-109" class="pilcrow">&#182;</a></div><p>Also store some additional information in the proxy object</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">proxyObject</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span> <span class="o">=</span> <span class="p">{};</span></pre></div></td></tr><tr id="section-110"><td class="docs"><div class="pilwrap"><a href="#section-110" class="pilcrow">&#182;</a></div><p>Like the type name, that could be useful late ;)</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">proxyObject</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">typeName</span> <span class="o">=</span> <span class="nx">typeName</span><span class="p">;</span></pre></div></td></tr><tr id="section-111"><td class="docs"><div class="pilwrap"><a href="#section-111" class="pilcrow">&#182;</a></div><p>Caculate the id for the object. It will be returned to the origin environment so this object can be referenced later</p>
</td><td class="code"><div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">proxyObjectId</span> <span class="o">=</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">nextId</span><span class="p">;</span></pre></div></td></tr><tr id="section-112"><td class="docs"><div class="pilwrap"><a href="#section-112" class="pilcrow">&#182;</a></div><p>Store the created object in the structure defined in the setup of proxification with an id associated to it</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="nx">proxyObjectId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">proxyObject</span><span class="p">;</span></pre></div></td></tr><tr id="section-113"><td class="docs"><div class="pilwrap"><a href="#section-113" class="pilcrow">&#182;</a></div><p>Also store the id inside the proxy object itself</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">proxyObject</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">proxyObjectId</span><span class="p">;</span></pre></div></td></tr><tr id="section-114"><td class="docs"><div class="pilwrap"><a href="#section-114" class="pilcrow">&#182;</a></div><p>Calculate a new id for the next object.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">nextId</span><span class="o">++</span><span class="p">;</span></pre></div></td></tr><tr id="section-115"><td class="docs"><div class="pilwrap"><a href="#section-115" class="pilcrow">&#182;</a></div><p>Setup all the event handlers.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">eventHandlerNames</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">eventHandlerName</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">proxyObject</span><span class="p">[</span><span class="nx">eventHandlerName</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">proxyObject</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// event.target;</span></pre></div></td></tr><tr id="section-116"><td class="docs"><div class="pilwrap"><a href="#section-116" class="pilcrow">&#182;</a></div><p>var eventHandlerName = Cocoon.getKeyForValueInDictionary(proxyObject, this); // Avoid closures ;)</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon.App.callOriginProxyObjectEventHandler(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">proxyObject</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">typeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">proxyObject</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">eventHandlerName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
                        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
                    <span class="p">};</span>
                <span class="p">})(</span><span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">eventHandlerNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span></pre></div></td></tr><tr id="section-117"><td class="docs"><div class="pilwrap"><a href="#section-117" class="pilcrow">&#182;</a></div><p>Add the dictionary where the event listeners (callbacks) will be added.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">proxyObject</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventListeners</span> <span class="o">=</span> <span class="p">{};</span>

            <span class="k">return</span> <span class="nx">proxyObjectId</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-118"><td class="docs"><div class="pilwrap"><a href="#section-118" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Calls a function of a destination object idetified by it's typeName and id.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The name of the type of the proxy.</span></div><div class="dox_tag_detail"><span>id </span><span class="dox_type">number</span><span>- The id of the proxy object.</span></div><div class="dox_tag_detail"><span>functionName </span><span class="dox_type">string</span><span>- The name of the function to be called.</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Whatever</span><span>the function call returns.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">callDestinationProxyObjectFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">functionName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">argumentsArray</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
            <span class="nx">argumentsArray</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">proxyObject</span> <span class="o">=</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">proxyObject</span><span class="p">[</span><span class="nx">functionName</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">proxyObject</span><span class="p">,</span> <span class="nx">argumentsArray</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-119"><td class="docs"><div class="pilwrap"><a href="#section-119" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sets a value to the corresponding attributeName of a proxy object represented by it's typeName and id.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The name of the type of the proxy.</span></div><div class="dox_tag_detail"><span>id </span><span class="dox_type">number</span><span>- The id of the proxy object.</span></div><div class="dox_tag_detail"><span>attributeName </span><span class="dox_type">string</span><span>- The name of the attribute to be set.</span></div><div class="dox_tag_detail"><span>attributeValue </span><span class="dox_type">unknown</span><span>- The value to be set to the attribute.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setDestinationProxyObjectAttribute</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">attributeName</span><span class="p">,</span> <span class="nx">attributeValue</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">proxyObject</span> <span class="o">=</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
            <span class="nx">proxyObject</span><span class="p">[</span><span class="nx">attributeName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">attributeValue</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-120"><td class="docs"><div class="pilwrap"><a href="#section-120" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieves the value of the corresponding attributeName of a proxy object represented by it's typeName and id.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The name of the type of the proxy.</span></div><div class="dox_tag_detail"><span>id </span><span class="dox_type">number</span><span>- The id of the proxy object.</span></div><div class="dox_tag_detail"><span>attributeName </span><span class="dox_type">string</span><span>- The name of the attribute to be retrieved.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">getDestinationProxyObjectAttribute</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">attributeName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">proxyObject</span> <span class="o">=</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
            <span class="k">return</span> <span class="nx">proxyObject</span><span class="p">[</span><span class="nx">attributeName</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-121"><td class="docs"><div class="pilwrap"><a href="#section-121" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Deletes a proxy object identifying it using it's typeName and id. Deleting a proxy object mainly means to remove the instance from the global structure<br />that hold all the instances.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>typeName </span><span class="dox_type">string</span><span>- The name of the type of the proxy.</span></div><div class="dox_tag_detail"><span>id </span><span class="dox_type">number</span><span>- The id of the proxy object.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">deleteDestinationProxyObject</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span>
            <span class="k">delete</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-122"><td class="docs"><div class="pilwrap"><a href="#section-122" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@function addDestinationProxyObjectEventListener</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">addDestinationProxyObjectEventListener</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">typeName</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">eventTypeName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">parentObject</span> <span class="o">=</span> <span class="nb">window</span><span class="p">;</span></pre></div></td></tr><tr id="section-123"><td class="docs"><div class="pilwrap"><a href="#section-123" class="pilcrow">&#182;</a></div><p>Look for the proxy object</p>
</td><td class="code"><div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">proxyObject</span> <span class="o">=</span> <span class="nx">parentObject</span><span class="p">[</span><span class="nx">typeName</span><span class="p">].</span><span class="nx">_cocoonjs_proxy_type_data</span><span class="p">.</span><span class="nx">proxyObjects</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>

            <span class="kd">var</span> <span class="nx">callback</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">proxyObject</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// event.target;</span></pre></div></td></tr><tr id="section-124"><td class="docs"><div class="pilwrap"><a href="#section-124" class="pilcrow">&#182;</a></div><p>var eventTypeName = Cocoon.getKeyForValueInDictionary(proxyObject.<em>cocoonjs</em>proxy<em>object</em>data.eventListeners, this); // Avoid closures ;)
TODO: Is there a way to retrieve the callbackId without a closure?</p>
</td><td class="code"><div class="highlight"><pre>                <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Cocoon.Proxify.callOriginProxyObjectEventListeners(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">proxyObject</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">typeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">proxyObject</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">eventTypeName</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
            <span class="p">};</span>

            <span class="nx">proxyObject</span><span class="p">.</span><span class="nx">_cocoonjs_proxy_object_data</span><span class="p">.</span><span class="nx">eventListeners</span><span class="p">[</span><span class="nx">eventTypeName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span></pre></div></td></tr><tr id="section-125"><td class="docs"><div class="pilwrap"><a href="#section-125" class="pilcrow">&#182;</a></div><p>Finally add the event listener callback to the proxy object</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">proxyObject</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">eventTypeName</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-126"><td class="docs"><div class="pilwrap"><a href="#section-126" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Proxifies the XMLHttpRequest type for the environment where this call is made. After calling this function, all the new objects<br />of XMLHttpRequest that are instantiated, will be proxified objects that will make calls to the counterparts in the other environment (CocoonJS &lt;-> WebView viceversa).<br />IMPORTANT NOTE: Remember to take down the proxification once you are done or to delete proxy objects whenever they are not needed anymore or memory leaks may occur.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">xhr</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ATTRIBUTE_NAMES</span> <span class="o">=</span>
            <span class="p">[</span>
                <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
                <span class="s2">&quot;withCredentials&quot;</span><span class="p">,</span>
                <span class="s2">&quot;upload&quot;</span><span class="p">,</span>
                <span class="s2">&quot;status&quot;</span><span class="p">,</span>
                <span class="s2">&quot;statusText&quot;</span><span class="p">,</span>
                <span class="s2">&quot;responseType&quot;</span><span class="p">,</span>
                <span class="s2">&quot;response&quot;</span><span class="p">,</span>
                <span class="s2">&quot;responseText&quot;</span><span class="p">,</span>
                <span class="s2">&quot;responseXML&quot;</span><span class="p">,</span>
                <span class="s2">&quot;readyState&quot;</span>
            <span class="p">];</span>
        <span class="kd">var</span> <span class="nx">FUNCTION_NAMES</span> <span class="o">=</span>
            <span class="p">[</span>
                <span class="s2">&quot;open&quot;</span><span class="p">,</span>
                <span class="s2">&quot;setRequestHeader&quot;</span><span class="p">,</span>
                <span class="s2">&quot;send&quot;</span><span class="p">,</span>
                <span class="s2">&quot;abort&quot;</span><span class="p">,</span>
                <span class="s2">&quot;getResponseHeader&quot;</span><span class="p">,</span>
                <span class="s2">&quot;getAllResponseHeaders&quot;</span><span class="p">,</span>
                <span class="s2">&quot;overrideMimeType&quot;</span>
            <span class="p">];</span>
        <span class="kd">var</span> <span class="nx">EVENT_HANDLER_NAMES</span> <span class="o">=</span>
            <span class="p">[</span>
                <span class="s2">&quot;onloadstart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;onprogress&quot;</span><span class="p">,</span>
                <span class="s2">&quot;onabort&quot;</span><span class="p">,</span>
                <span class="s2">&quot;onerror&quot;</span><span class="p">,</span>
                <span class="s2">&quot;onload&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ontimeout&quot;</span><span class="p">,</span>
                <span class="s2">&quot;onloadend&quot;</span><span class="p">,</span>
                <span class="s2">&quot;onreadystatechange&quot;</span>
            <span class="p">];</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Proxify</span><span class="p">.</span><span class="nx">setupOriginProxyType</span><span class="p">(</span><span class="s2">&quot;XMLHttpRequest&quot;</span><span class="p">,</span> <span class="nx">ATTRIBUTE_NAMES</span><span class="p">,</span> <span class="nx">FUNCTION_NAMES</span><span class="p">,</span> <span class="nx">EVENT_HANDLER_NAMES</span><span class="p">);</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-127"><td class="docs"><div class="pilwrap"><a href="#section-127" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Proxifies the Audio type for the environment where this call is made. After calling this function, all the new objects<br />of Audio that are instantiated, will be proxified objects that will make calls to the counterparts in the other environment (CocoonJS &lt;-> WebView viceversa).<br />IMPORTANT NOTE: Remember to take down the proxification once you are done or to delete proxy objects whenever they are not needed anymore or memory leaks may occur.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">audio</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ATTRIBUTE_NAMES</span> <span class="o">=</span>
            <span class="p">[</span>
                <span class="s2">&quot;src&quot;</span><span class="p">,</span>
                <span class="s2">&quot;loop&quot;</span><span class="p">,</span>
                <span class="s2">&quot;volume&quot;</span><span class="p">,</span>
                <span class="s2">&quot;preload&quot;</span>
            <span class="p">];</span>
        <span class="kd">var</span> <span class="nx">FUNCTION_NAMES</span> <span class="o">=</span>
            <span class="p">[</span>
                <span class="s2">&quot;play&quot;</span><span class="p">,</span>
                <span class="s2">&quot;pause&quot;</span><span class="p">,</span>
                <span class="s2">&quot;load&quot;</span><span class="p">,</span>
                <span class="s2">&quot;canPlayType&quot;</span>
            <span class="p">];</span>
        <span class="kd">var</span> <span class="nx">EVENT_HANDLER_NAMES</span> <span class="o">=</span>
            <span class="p">[</span>
                <span class="s2">&quot;onended&quot;</span><span class="p">,</span>
                <span class="s2">&quot;oncanplay&quot;</span><span class="p">,</span>
                <span class="s2">&quot;oncanplaythrough&quot;</span><span class="p">,</span>
                <span class="s2">&quot;onerror&quot;</span>
            <span class="p">];</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Proxify</span><span class="p">.</span><span class="nx">setupOriginProxyType</span><span class="p">(</span><span class="s2">&quot;Audio&quot;</span><span class="p">,</span> <span class="nx">ATTRIBUTE_NAMES</span><span class="p">,</span> <span class="nx">FUNCTION_NAMES</span><span class="p">,</span> <span class="nx">EVENT_HANDLER_NAMES</span><span class="p">);</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-128"><td class="docs"><div class="pilwrap"><a href="#section-128" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This function allows to forward console messages from the WebView to the CocoonJS<br />debug console. What it does is to change the console object for a new one<br />with all it's methods (log, error, info, debug and warn) forwarding their<br />messages to the CocoonJS environment.<br />The original console object is stored in the Cocoon.originalConsole property.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">console</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> 
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">originalConsole</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">originalConsole</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">functions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">];</span>

        <span class="kd">var</span> <span class="nx">newConsole</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">functions</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nx">newConsole</span><span class="p">[</span><span class="nx">functions</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">functionName</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">try</span><span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">jsCode</span> <span class="o">=</span> <span class="s2">&quot;Proxified log: &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
                        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">originalConsole</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jsCode</span><span class="p">);</span>
                        <span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCallAsync</span><span class="p">(</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="nx">jsCode</span><span class="p">);</span>
                    <span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
                        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Proxified log: &quot;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">};</span>
            <span class="p">}(</span><span class="nx">functions</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">newConsole</span><span class="p">.</span><span class="nx">assert</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">newConsole</span><span class="p">.</span><span class="nx">assert</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">assert</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;Assertion failed: &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
                    <span class="nx">newConsole</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>        
        <span class="nb">window</span><span class="p">.</span><span class="nx">console</span> <span class="o">=</span> <span class="nx">newConsole</span><span class="p">;</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-129"><td class="docs"><div class="pilwrap"><a href="#section-129" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This function restores the original console object and removes the proxified console object.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">deproxifyConsole</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span> <span class="o">||</span> <span class="o">!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">originalConsole</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">console</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">originalConsole</span><span class="p">;</span>
            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">originalConsole</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>

<span class="p">});;</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Device&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-130"><td class="docs"><div class="pilwrap"><a href="#section-130" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>All functions related to the device.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-131"><td class="docs"><div class="pilwrap"><a href="#section-131" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>An object that defines the getDeviceInfo returned information.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">DeviceInfo</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">os</span><span class="o">:</span>         <span class="kc">null</span><span class="p">,</span>
        <span class="nx">version</span><span class="o">:</span>    <span class="kc">null</span><span class="p">,</span>
        <span class="nx">dpi</span><span class="o">:</span>        <span class="kc">null</span><span class="p">,</span>
        <span class="nx">brand</span><span class="o">:</span>      <span class="kc">null</span><span class="p">,</span>
        <span class="nx">model</span><span class="o">:</span>      <span class="kc">null</span><span class="p">,</span>
        <span class="nx">imei</span><span class="o">:</span>       <span class="kc">null</span><span class="p">,</span>
        <span class="nx">platformId</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">odin</span><span class="o">:</span>       <span class="kc">null</span><span class="p">,</span>
        <span class="nx">openudid</span><span class="o">:</span>   <span class="kc">null</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-132"><td class="docs"><div class="pilwrap"><a href="#section-132" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns the device UUID.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">string</span><span>The device UUID</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">getDeviceId</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;getDeviceId&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-133"><td class="docs"><div class="pilwrap"><a href="#section-133" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns the device Info.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Cocoon.Device.DeviceInfo</span><span>The device Info</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">getDeviceInfo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;getDeviceInfo&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-134"><td class="docs"><div class="pilwrap"><a href="#section-134" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieves the preferred orientation that has been set in the system.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">number</span><span>The preferred orientation in the system as a combination of the possible {@link Cocoon.Device.Orientations}.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">getOrientation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;getPreferredOrientation&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-135"><td class="docs"><div class="pilwrap"><a href="#section-135" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sets the preferred orientation in the system.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>preferredOrientation </span><span class="dox_type">number</span><span>- The preferred orientation to be set. A combination of the possible {@link Cocoon.Device.Orientations}.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setOrientation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">preferredOrientation</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;setPreferredOrientation&quot;</span><span class="p">,</span> <span class="nx">preferredOrientation</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-136"><td class="docs"><div class="pilwrap"><a href="#section-136" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The predefined possible orientations. There can be a bit level combination of them using the OR operator.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">Orientations</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">PORTRAIT</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">PORTRAIT_UPSIDE_DOWN</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="nx">LANDSCAPE_LEFT</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="nx">LANDSCAPE_RIGHT</span> <span class="o">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="nx">LANDSCAPE</span> <span class="o">:</span> <span class="mi">4</span> <span class="o">|</span> <span class="mi">8</span><span class="p">,</span>
        <span class="nx">BOTH</span> <span class="o">:</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">4</span> <span class="o">|</span> <span class="mi">8</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-137"><td class="docs"><div class="pilwrap"><a href="#section-137" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Enables or disables the auto lock to control if the screen keeps on after an inactivity period.<br />When the auto lock is enabled and the application has no user input for a short period, the system puts the device into a "sleep state where the screen dims or turns off.<br />When the auto lock is disabled the screen keeps on even when there is no user input for long times.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>enabled </span><span class="dox_type">Bool</span><span>- A boolean value that controls whether to enable or disable the auto lock.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">autoLock</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">enabled</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;setAutoLockEnabled&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>

<span class="p">});;</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Motion&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-138"><td class="docs"><div class="pilwrap"><a href="#section-138" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>All functions related to the Accelerometer and Gyroscope.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">;</span></pre></div></td></tr><tr id="section-139"><td class="docs"><div class="pilwrap"><a href="#section-139" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Setups the update interval in seconds (1 second / X frames) to receive the accelerometer updates.<br />It defines the rate at which the devicemotion events are updated.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>seconds </span><span class="dox_type">number</span><span>- The update interval in seconds to be set.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setAccelerometerInterval</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">updateIntervalInSeconds</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Motion</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;setAccelerometerUpdateIntervalInSeconds&quot;</span><span class="p">,</span> <span class="nx">updateIntervalInSeconds</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-140"><td class="docs"><div class="pilwrap"><a href="#section-140" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns the update interval in seconds that is currently set for accelerometer related events.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">number</span><span>The update interval in seconds that is currently set for accelerometer related events.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">getAccelerometerInterval</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Motion</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;getAccelerometerUpdateIntervalInSeconds&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-141"><td class="docs"><div class="pilwrap"><a href="#section-141" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Setups the update interval in seconds (1 second / X frames) to receive the gyroscope updates.<br />It defines the rate at which the devicemotion and deviceorientation events are updated.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>seconds </span><span class="dox_type">number</span><span>- The update interval in seconds to be set.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">setGyroscopeInterval</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">updateIntervalInSeconds</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Motion</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;setGyroscopeUpdateIntervalInSeconds&quot;</span><span class="p">,</span> <span class="nx">updateIntervalInSeconds</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-142"><td class="docs"><div class="pilwrap"><a href="#section-142" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns the update interval in seconds that is currently set for gyroscope related events.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">number</span><span>The update interval in seconds that is currently set for gyroscope related events.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">getGyroscopeInterval</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Motion</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;getGyroscopeUpdateIntervalInSeconds&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>

<span class="p">});;</span><span class="cm">/**</span>
<span class="cm">* The &quot;Cocoon.Touch&quot; object holds some functions to handle the touch events in both surfaces ( Cocoon &amp; WebView )</span>
<span class="cm">* @namespace Cocoon.Touch</span>
<span class="cm">*/</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Touch&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">addADivToDisableInput</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;CocoonJSInputBlockingDiv&quot;</span><span class="p">;</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="s2">&quot;100%&quot;</span><span class="p">;</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="s2">&quot;100%&quot;</span><span class="p">;</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="s2">&quot;absolute&quot;</span><span class="p">;</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s1">&#39;transparent&#39;</span><span class="p">;</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">border</span> <span class="o">=</span> <span class="s2">&quot;0px solid #000&quot;</span><span class="p">;</span> 
        <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zIndex</span> <span class="o">=</span> <span class="mi">999999999</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">removeTheDivToEnableInput</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;CocoonJSInputBlockingDiv&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">div</span><span class="p">)</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-143"><td class="docs"><div class="pilwrap"><a href="#section-143" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Disables the touch events in the Cocoon environment.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">disable</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;disableTouchLayer&quot;</span><span class="p">,</span> <span class="s2">&quot;CocoonJSView&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardEventsToCocoonJSEnabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="s2">&quot;Cocoon &amp;&amp; Cocoon.Touch &amp;&amp; Cocoon.Touch.disable();&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-144"><td class="docs"><div class="pilwrap"><a href="#section-144" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Enables the touch events in the Cocoon environment.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">enable</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;enableTouchLayer&quot;</span><span class="p">,</span> <span class="s2">&quot;CocoonJSView&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardEventsToCocoonJSEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="s2">&quot;Cocoon &amp;&amp; Cocoon.Touch &amp;&amp; Cocoon.Touch.enable();&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-145"><td class="docs"><div class="pilwrap"><a href="#section-145" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Disables the touch events in the WebView environment.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">disableInWebView</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;disableTouchLayer&quot;</span><span class="p">,</span> <span class="s2">&quot;WebView&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Touch</span><span class="p">.</span><span class="nx">addADivToDisableInput</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="s2">&quot;Cocoon &amp;&amp; Cocoon.Touch &amp;&amp; Cocoon.Touch.disableInWebView();&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-146"><td class="docs"><div class="pilwrap"><a href="#section-146" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Enables the touch events in the WebView environment.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">enableInWebView</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;enableTouchLayer&quot;</span><span class="p">,</span> <span class="s2">&quot;WebView&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">EmulatedWebViewIFrame</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Touch</span><span class="p">.</span><span class="nx">removeTheDivToEnableInput</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Touch</span><span class="p">.</span><span class="nx">forwardAsync</span><span class="p">(</span><span class="s2">&quot;Cocoon &amp;&amp; Cocoon.Touch &amp;&amp; Cocoon.Touch.enableInWebView();&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>

<span class="p">});;</span><span class="cm">/** </span>
<span class="cm">* This namespace holds the WebDialog widget, which essentially shows a Webview on top of the CocoonJS layer.</span>
<span class="cm">* @namespace Cocoon.Widget</span>
<span class="cm">*/</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Widget&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-147"><td class="docs"><div class="pilwrap"><a href="#section-147" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Creates the WebDialog</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">WebDialog</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">webDialogID</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCall</span><span class="p">(</span><span class="s2">&quot;createWebDialog&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;iframe&quot;</span><span class="p">);</span>
            <span class="nx">iframe</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;CocoonJSWebDialogIFrame&quot;</span><span class="p">;</span>
            <span class="nx">iframe</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;CocoonJSWebDialogIFrame&quot;</span><span class="p">;</span>
            <span class="nx">iframe</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">=</span> <span class="s2">&quot;position:fixed;left:0;top:0;bottom:0;right:0; width:100%; height:100%;margin:0;padding:0;&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="nx">iframe</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">iframeloaded</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">js</span> <span class="o">=</span> <span class="s2">&quot;Cocoon = {}; Cocoon.Widget = {}; Cocoon.Widget.WebDialog = {} Cocoon.Widget.WebDialog.close = function()&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;{&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;   window.parent.CocoonJSCloseWebDialog();&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;};&quot;</span><span class="p">;</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">evalIframe</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">me</span><span class="p">.</span><span class="nx">pendingEvals</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">evalIframe</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">pendingEvals</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="p">}</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">pendingEvals</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="p">}</span>
            <span class="nx">iframe</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span> <span class="o">=</span> <span class="nx">iframe</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">pendingEvals</span> <span class="o">=</span> <span class="p">[];</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">CocoonJSCloseWebDialog</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
               <span class="nx">me</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">WebDialog</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span></pre></div></td></tr><tr id="section-148"><td class="docs"><div class="pilwrap"><a href="#section-148" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows the dialog.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>url </span><span class="dox_type">string</span><span>- The url to be opened on the Web Dialog.</span></div><div class="dox_tag_detail"><span>closeCallback </span><span class="dox_type">function</span><span>- The callback that will be fired when the dialog is closed.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">show</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">closeCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Touch</span><span class="p">.</span><span class="nx">enable</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Touch</span><span class="p">.</span><span class="nx">disable</span><span class="p">();</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCallAsync</span><span class="p">(</span><span class="s2">&quot;showWebDialog&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">webDialogID</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">closeCallback</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
                <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">);</span>
            <span class="p">}</span>

        <span class="p">},</span>
        </pre></div></td></tr><tr id="section-149"><td class="docs"><div class="pilwrap"><a href="#section-149" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Closes the dialog.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">close</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCallAsync</span><span class="p">(</span><span class="s2">&quot;closeWebDialog&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">webDialogID</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">closeCallback</span><span class="p">)</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">closeCallback</span><span class="p">();</span>
        <span class="p">},</span>
        <span class="nx">evalIframe</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">js</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">frames</span><span class="p">[</span><span class="s2">&quot;CocoonJSWebDialogIFrame&quot;</span><span class="p">].</span><span class="nb">eval</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-150"><td class="docs"><div class="pilwrap"><a href="#section-150" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Evaluates a javascript string in the WebDialog environment.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nb">eval</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">js</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_APP</span><span class="p">.</span><span class="nx">makeCallAsync</span><span class="p">(</span><span class="s2">&quot;evalWebDialog&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">webDialogID</span><span class="p">,</span> <span class="nx">js</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iframeloaded</span><span class="p">)</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">evalIframe</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span>
                <span class="k">else</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">pendingEvals</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>

<span class="p">});;</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Camera&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-151"><td class="docs"><div class="pilwrap"><a href="#section-151" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This namespace represents the CocoonJS camera extension API.</p></div><div class="details"></div><div class="body"><div class="alert alert-success">
    *   Here you will find a demo about this namespace: <a href="https://github.com/ludei/cocoonjs-demos/tree/master/Camera/videopuzzle">Videopuzzle demo</a>.
    *</div></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">navigator</span><span class="p">.</span><span class="nx">getUserMedia_</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">getUserMedia</span> <span class="o">||</span>
                                <span class="nx">navigator</span><span class="p">.</span><span class="nx">webkitGetUserMedia</span> <span class="o">||</span>
                                <span class="nx">navigator</span><span class="p">.</span><span class="nx">mozGetUserMedia</span> <span class="o">||</span>
                                <span class="nx">navigator</span><span class="p">.</span><span class="nx">msGetUserMedia</span><span class="p">);</span>
    </pre></div></td></tr><tr id="section-152"><td class="docs"><div class="pilwrap"><a href="#section-152" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@namespace</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-153"><td class="docs"><div class="pilwrap"><a href="#section-153" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The predefined possible camera types.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">CameraType</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">FRONT</span> <span class="o">:</span> <span class="s2">&quot;FRONT&quot;</span><span class="p">,</span>
      <span class="nx">BACK</span> <span class="o">:</span> <span class="s2">&quot;BACK&quot;</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-154"><td class="docs"><div class="pilwrap"><a href="#section-154" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The predefined possible camera video capturing image format types.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">CaptureFormatType</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">JPEG</span> <span class="o">:</span> <span class="s2">&quot;JPEG&quot;</span><span class="p">,</span>
      <span class="nx">RGB_565</span> <span class="o">:</span> <span class="s2">&quot;RGB_565&quot;</span><span class="p">,</span>
      <span class="nx">NV21</span> <span class="o">:</span> <span class="s2">&quot;NV21&quot;</span><span class="p">,</span> 
      <span class="nx">NV16</span> <span class="o">:</span> <span class="s2">&quot;NV16&quot;</span><span class="p">,</span>
      <span class="nx">YUY2</span> <span class="o">:</span> <span class="s2">&quot;YUY2&quot;</span><span class="p">,</span>
      <span class="nx">YV12</span> <span class="o">:</span> <span class="s2">&quot;YV12&quot;</span><span class="p">,</span>
      <span class="nx">BGRA32</span> <span class="o">:</span> <span class="s2">&quot;32BGRA&quot;</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-155"><td class="docs"><div class="pilwrap"><a href="#section-155" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents the information of a camera. It includes all the information to be able to setup a camera to capture video or to take pictures.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">CameraInfo</span> <span class="o">=</span>  <span class="p">{</span>

    <span class="nx">cameraIndex</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

    <span class="nx">cameraType</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">CameraType</span><span class="p">.</span><span class="nx">BACK</span><span class="p">,</span>

    <span class="nx">supportedVideoSizes</span> <span class="o">:</span> <span class="p">[],</span>

    <span class="nx">supportedVideoFrameRates</span> <span class="o">:</span> <span class="p">[],</span>

    <span class="nx">supportedVideoCaptureImageFormats</span> <span class="o">:</span> <span class="p">[]</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-156"><td class="docs"><div class="pilwrap"><a href="#section-156" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns the number of available camera in the platform/device.
<ul><li>@memberof Cocoon.Camera</li>
<li>@function getNumberOfCameras</li>
<li>@returns {number} The number of cameras available in the platform/device.</li>
<li>@example</li>
<li>console.log(Cocoon.Camera.getNumberOfCameras());</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">getNumberOfCameras</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_CAMERA&quot;</span><span class="p">,</span> <span class="s2">&quot;getNumberOfCameras&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">getUserMedia_</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-157"><td class="docs"><div class="pilwrap"><a href="#section-157" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns an array of {@link Cocoon.Camera.CameraInfo} objects representing all the information of all the cameras available in the platform/device.
<ul><li>@memberof Cocoon.Camera</li>
<li>@function getAllCamerasInfo</li>
<li>@returns {Array} An array of {@link Cocoon.Camera.CameraInfo} objects.</li>
<li>@example</li>
<li>console.log(JSON.stringify(Cocoon.Camera.getAllCamerasInfo()));</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">getAllCamerasInfo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_CAMERA&quot;</span><span class="p">,</span> <span class="s2">&quot;getAllCamerasInfo&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-158"><td class="docs"><div class="pilwrap"><a href="#section-158" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns the {@link Cocoon.Camera.CameraInfo} object that represents all the information of the specified camera index in the platform/device.
<ul><li>@memberof Cocoon.Camera</li>
<li>@function getCameraInfoByIndex</li>
<li>@param {number} cameraIndex The index of the camera to get the info from. The index should be between 0 and N (Being N the value returned by {@link Cocoon.Camera.getNumberOfCameras}).</li>
<li>@returns {Cocoon.Camera.CameraInfo} The {@link Cocoon.Camera.CameraInfo} of the given camera index.</li>
<li>@example</li>
<li>console.log(JSON.stringify(Cocoon.Camera.getCameraInfoByIndex(0)));</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">getCameraInfoByIndex</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cameraIndex</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_CAMERA&quot;</span><span class="p">,</span> <span class="s2">&quot;getCameraInfoByIndex&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-159"><td class="docs"><div class="pilwrap"><a href="#section-159" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns the {@link Cocoon.Camera.CameraInfo} object that represents all the information of the first camera of the specified type found in the platform/device.
<ul><li>@memberof Cocoon.Camera</li>
<li>@function getCameraInfoByType</li>
<li>@param {Cocoon.Camera.CameraType} cameraType The type of the camera to get the info from. </li>
<li>@returns {Cocoon.Camera.CameraInfo} The {@link Cocoon.Camera.CameraInfo} of the first camera of the given camera type that has been found in the platform/device.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">getCameraInfoByType</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cameraType</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_CAMERA&quot;</span><span class="p">,</span> <span class="s2">&quot;getCameraInfoByType&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>
  </pre></div></td></tr><tr id="section-160"><td class="docs"><div class="pilwrap"><a href="#section-160" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Starts a camera to capture video. The developer must specify at least the index of the camera to be used. Some other setup parameters can also be passed to control the video capture. An image object
<ul><li>that will be automatically updated with the captured frames is returned so the developer just need to draw the image in every frame. A null image object is returned if the setup did not work or there is</li>
<li>no available camera.</li>
<li>@memberof Cocoon.Camera</li>
<li>@function start</li>
<li>@param {object} params - The object itself</li>
<li>@param {number} params.cameraIndex The index of the camera to start video capture with.</li>
<li>@param {number} params.captureWidth The hozirontal size of the video capture resolution. If the value does not correspond to any of the sizes supported by the camera, the closest one is used. See {@link Cocoon.Camera.CameraInfo}.</li>
<li>If no value is given, the maximum size available is used.</li>
<li>@param {number} params.captureHeight The vertical size of the video capture resolution. If value does not correspond to any of the sizes supported by the camera, the closest one is used. See {@link Cocoon.Camera.CameraInfo}.</li>
<li>If no value is given, the maximum size available is used.</li>
<li>@param {number} params.captureFrameRate The frame rate to capture the video at. If the value does not correspond to any of the frame rates supported by the camera, the closest one is used. See {@link Cocoon.Camera.CameraInfo}.</li>
<li>If no value is given, the maximum frame rate available is used.
*@param {value} params.captureImageFormat A value from the available {@link Cocoon.Camera.CaptureFormatType} formats to specify the format of the images that will be captured. See {@link Cocoon.Camera.CameraInfo}.</li>
<li>If no value is given, the first available capture image format is used.</li>
<li>@returns {image} An image object that will automatically update itself with the captured frames or null if the camera capture could not start.</li>
<li>@example</li>
<li>Cocoon.Camera.start({</li>
<li>success : function(stream){</li>
<li>ctx.fillRect(0, 0, w, h);</li>
<li>ctx.drawImage(stream, 0, 0, w, h);</li>
<li>},</li>
<li>error : function(){</li>
<li>console.log("Error", arguments);</li>
<li>}</li>
<li>});</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="p">((</span><span class="nb">Boolean</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">success</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">Boolean</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">error</span><span class="p">)))</span> <span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Missing callbacks for Cocoon.Camera.start();&quot;</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">cameraIndex</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> 
        <span class="nx">width</span> <span class="o">:</span> <span class="mi">50</span><span class="p">,</span> 
        <span class="nx">height</span> <span class="o">:</span> <span class="mi">50</span><span class="p">,</span>
        <span class="nx">frameRate</span> <span class="o">:</span> <span class="mi">25</span>
      <span class="p">};</span>

      <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">properties</span><span class="p">,</span><span class="nx">params</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">img</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_CAMERA&quot;</span><span class="p">,</span> <span class="s2">&quot;startCapturing&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
      
      <span class="k">if</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">(</span><span class="nx">img</span><span class="p">))</span> <span class="p">{</span> <span class="nx">params</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="nx">img</span><span class="p">);</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span> <span class="nx">params</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span> <span class="p">}</span>
            
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="nx">navigator</span><span class="p">.</span><span class="nx">getUserMedia_</span><span class="p">(</span> <span class="p">{</span>
              <span class="nx">video</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span> <span class="nx">audio</span><span class="o">:</span><span class="kc">false</span>
            <span class="p">},</span>    
            <span class="kd">function</span><span class="p">(</span><span class="nx">stream</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">params</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="nx">stream</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">params</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>

    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-161"><td class="docs"><div class="pilwrap"><a href="#section-161" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Stops a camera that is already started capturing video.
<ul><li>@memberof Cocoon.Camera</li>
<li>@function stop</li>
<li>@param cameraIndex The index of the camera to stop capturing video.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">stop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cameraIndex</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_CAMERA&quot;</span><span class="p">,</span> <span class="s2">&quot;stopCapturing&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-162"><td class="docs"><div class="pilwrap"><a href="#section-162" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Indicates if a camera is capturing video or not.
<ul><li>@memberof Cocoon.Camera</li>
<li>@function isCapturing</li>
<li>@param cameraIndex The index of the camera to check if is capturing video or not.</li>
<li>@returns {boolean} A flag indicating if the given camera (by index) is capturing video (true) or not (false).</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">isCapturing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cameraIndex</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_CAMERA&quot;</span><span class="p">,</span> <span class="s2">&quot;isCapturing&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Ad&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-163"><td class="docs"><div class="pilwrap"><a href="#section-163" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This namespace represents the Cocoon Advertisement extension API.</p></div><div class="details"></div><div class="body"><div class="alert alert-success">
    *   Here you will find a demo about this namespace: <a href="https://github.com/ludei/cocoonjs-demos/tree/master/Ads">Ads demo</a>.
    *</div>

<p><pre><code>* &lt;div class="alert alert-warning"&gt;
*    &lt;strong&gt;Warning!&lt;/strong&gt; This JavaScript extension requires some configuration parameters on the &lt;a href="<a href='https://ludei.zendesk.com/hc/en-us'>https://ludei.zendesk.com/hc/en-us</a>"&gt;cloud compiler&lt;/a&gt;!
* &lt;/div&gt;
</code></pre></div></div></p>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="p">(</span><span class="o">!!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_SRV_AD</span><span class="p">);</span></pre></div></td></tr><tr id="section-164"><td class="docs"><div class="pilwrap"><a href="#section-164" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The predefined possible layouts for a banner ad.<br />    * @name Cocoon.Ad.BannerLayout<br />    * @memberOf Cocoon.Ad<br />    * @property {string} TOP_CENTER  Specifies that the banner must be shown in the top of the screen and vertically centered.<br />    * @property {string} BOTTOM_CENTER  Specifies that the banner must be shown in the bottom of the screen and vertically centered.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">BannerLayout</span> <span class="o">=</span> 
  <span class="p">{</span>

      <span class="nx">TOP_CENTER</span>      <span class="o">:</span> <span class="s2">&quot;TOP_CENTER&quot;</span><span class="p">,</span>

      <span class="nx">BOTTOM_CENTER</span>   <span class="o">:</span> <span class="s2">&quot;BOTTOM_CENTER&quot;</span>
  <span class="p">};</span>
  </pre></div></td></tr><tr id="section-165"><td class="docs"><div class="pilwrap"><a href="#section-165" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>A rectangle object that contains the banner dimensions<br />    * @memberOf Cocoon.Ad<br />    * @function Rectangle<br />    * @private<br />    * @param {number} x The top lef x coordinate of the rectangle<br />    * @param {number} y The top lef y coordinate of the rectangle<br />    * @param {number} width The rectangle width<br />    * @param {number} height The rectangle height<br />    * @example<br />    * var rect = new Cocoon.Ad.Rectangle(0,0,300,300);</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Rectangle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">)</span> 
  <span class="p">{</span>
  
      <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">Banner</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">id</span> <span class="o">!==</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;The given ad ID is not a number.&quot;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">onBannerShown</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onbannershow&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
        <span class="p">{</span>
          <span class="nx">sourceListener</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">});</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">onBannerHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onbannerhide&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
        <span class="p">{</span>
          <span class="nx">sourceListener</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">});</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">onBannerReady</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onbannerready&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
        <span class="p">{</span>
          <span class="nx">sourceListener</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
        <span class="p">}</span>
      <span class="p">});</span>

      <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span>

    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;ready&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onBannerReady</span><span class="p">);</span>

    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;shown&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onBannerShown</span><span class="p">);</span>

    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;hidden&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onBannerHidden</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">Banner</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

    <span class="nx">showBanner</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;showBanner&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">hideBanner</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;hideBanner&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">load</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;refreshBanner&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">getRectangle</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;getRectangle&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">setRectangle</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">rect</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;setRectangle&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">rect</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">setBannerLayout</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">bannerLayout</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;setBannerLayout&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">bannerLayout</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">Interstitial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">id</span> <span class="o">!==</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;The given ad ID is not a number.&quot;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">onFullScreenShown</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onfullscreenshow&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
          <span class="nx">sourceListener</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">});</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">onFullScreenHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onfullscreenhide&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
          <span class="nx">sourceListener</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">});</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">onFullScreenReady</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onfullscreenready&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
          <span class="nx">sourceListener</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">});</span>

      <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span>

    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;ready&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onFullScreenReady</span><span class="p">);</span>
    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;shown&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onFullScreenShown</span><span class="p">);</span>
    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;hidden&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onFullScreenHidden</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>

  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">Interstitial</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

    <span class="nx">showInterstitial</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;showFullScreen&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">refreshInterstitial</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;refreshFullScreen&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">configure</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parameters</span><span class="p">)</span>
  <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">parameters</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parameters</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;requestInitialization&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">createBanner</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parameters</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">parameters</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parameters</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">adId</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;createBanner&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">parameters</span><span class="p">]);</span>
      <span class="kd">var</span> <span class="nx">banner</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">Banner</span><span class="p">(</span><span class="nx">adId</span><span class="p">);</span>

      <span class="k">return</span> <span class="nx">banner</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">releaseBanner</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">banner</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">banner</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="s2">&quot;The banner ad object to be released is undefined&quot;</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;releaseBanner&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">banner</span><span class="p">.</span><span class="nx">id</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">createInterstitial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parameters</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">parameters</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parameters</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">adId</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;createFullscreen&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">parameters</span><span class="p">]);</span>
      <span class="kd">var</span> <span class="nx">fullscreen</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">Interstitial</span><span class="p">(</span><span class="nx">adId</span><span class="p">);</span>

      <span class="k">return</span> <span class="nx">fullscreen</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">releaseInterstitial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fullscreen</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fullscreen</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="s2">&quot;The fullscreen ad object to be released is undefined&quot;</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;releaseFullscreen&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">fullscreen</span><span class="p">.</span><span class="nx">id</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-166"><td class="docs"><div class="pilwrap"><a href="#section-166" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows a banner ad if available.<br />    * @memberOf Cocoon.Ad<br />    * @function showBanner<br />    * @example<br />    * Cocoon.Ad.showBanner();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">showBanner</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;showBanner&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-167"><td class="docs"><div class="pilwrap"><a href="#section-167" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Hides the banner ad if it was being shown.<br />    * @memberOf Cocoon.Ad<br />    * @function hideBanner<br />    * @example<br />    * Cocoon.Ad.hideBanner();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">hideBanner</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;hideBanner&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-168"><td class="docs"><div class="pilwrap"><a href="#section-168" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Loads a new banner ad.<br />    * @memberOf Cocoon.Ad<br />    * @function refreshBanner<br />    * @private<br />    * @example<br />    * Cocoon.Ad.refreshBanner();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">refreshBanner</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;refreshBanner&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-169"><td class="docs"><div class="pilwrap"><a href="#section-169" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Loads a new interstitial ad.<br />    * @memberOf Cocoon.Ad<br />    * @function showInterstitial<br />    * @example<br />    * Cocoon.Ad.showInterstitial();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">showInterstitial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;showFullScreen&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-170"><td class="docs"><div class="pilwrap"><a href="#section-170" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows a full screen ad if available.<br />    * @memberOf Cocoon.Ad<br />    * @function refreshInterstitial<br />    * @private<br />    * @example<br />    * Cocoon.Ad.refreshInterstitial();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">refreshInterstitial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;refreshFullScreen&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-171"><td class="docs"><div class="pilwrap"><a href="#section-171" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Makes a request to preload a banner ad.<br />    * @memberOf Cocoon.Ad<br />    * @function loadBanner<br />    * @example<br />    * Cocoon.Ad.loadBanner();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">preloadedBanner</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="nx">extension</span><span class="p">.</span><span class="nx">loadBanner</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">){</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">preloadedBanner</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">refreshBanner</span><span class="p">();</span>
      <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">preloadedBanner</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;preloadBanner&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-172"><td class="docs"><div class="pilwrap"><a href="#section-172" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Makes a request to load a full screen ad (interstitial).<br />    * @memberOf Cocoon.Ad<br />    * @function loadInterstitial<br />    * @example<br />    * Cocoon.Ad.loadInterstitial();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">preloadedInterstitial</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="nx">extension</span><span class="p">.</span><span class="nx">loadInterstitial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">){</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">preloadedInterstitial</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">refreshInterstitial</span><span class="p">();</span>
      <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">preloadedInterstitial</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;preloadFullScreen&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-173"><td class="docs"><div class="pilwrap"><a href="#section-173" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sets the rectangle where the banner ad is going to be shown.<br />    * @memberOf Cocoon.Ad<br />    * @function setRectangle<br />    * @private<br />    * @param {Cocoon.Ad.Rectangle} rect The rectangle representing the banner position and domensions.<br />    * @example<br />    * Cocoon.Ad.setRectangle();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">setRectangle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;setRectangle&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-174"><td class="docs"><div class="pilwrap"><a href="#section-174" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Gets the rectangle representing the banner screen position.<br />    * @memberOf Cocoon.Ad<br />    * @private<br />    * @function getRectangle<br />    * @example<br />    * Cocoon.Ad.getRectangle();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">getRectangle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;getRectangle&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-175"><td class="docs"><div class="pilwrap"><a href="#section-175" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sets the rectangle where the banner ad is going to be shown.<br />    * @memberOf Cocoon.Ad<br />    * @function setBannerLayout<br />    * @param {Cocoon.Ad.BannerLayout} bannerLayout The layout where the bannerwill be placed.<br />    * @example<br />    * Cocoon.Ad.load();</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">setBannerLayout</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">bannerLayout</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Ad</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;setBannerLayout&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onBannerShown</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onbannershow&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onBannerHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onbannerhide&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onBannerReady</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onbannerready&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onFullScreenShown</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onfullscreenshow&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onFullScreenHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onfullscreenhide&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onFullScreenReady</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_AD&quot;</span><span class="p">,</span> <span class="s2">&quot;Ad&quot;</span><span class="p">,</span> <span class="s2">&quot;onfullscreenready&quot;</span><span class="p">);</span> 

  <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span></pre></div></td></tr><tr id="section-176"><td class="docs"><div class="pilwrap"><a href="#section-176" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events called when a banner is ready.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>width </span><span class="dox_type">number</span><span>- The banner width</span></div><div class="dox_tag_detail"><span>height </span><span class="dox_type">number</span><span>- The banner height</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;ready&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onBannerReady</span><span class="p">);</span></pre></div></td></tr><tr id="section-177"><td class="docs"><div class="pilwrap"><a href="#section-177" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events called when a banner is shown.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;shown&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onBannerShown</span><span class="p">);</span></pre></div></td></tr><tr id="section-178"><td class="docs"><div class="pilwrap"><a href="#section-178" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events called when a banner is hidden.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;hidden&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onBannerHidden</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">banner</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="nx">extension</span><span class="p">.</span><span class="nx">banner</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>

  <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span></pre></div></td></tr><tr id="section-179"><td class="docs"><div class="pilwrap"><a href="#section-179" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events called when a full screen ad is ready.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;ready&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onFullScreenReady</span><span class="p">);</span></pre></div></td></tr><tr id="section-180"><td class="docs"><div class="pilwrap"><a href="#section-180" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events called when a full screen ad is shown.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;shown&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onFullScreenShown</span><span class="p">);</span></pre></div></td></tr><tr id="section-181"><td class="docs"><div class="pilwrap"><a href="#section-181" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events called when a full screen ad is hidden.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;hidden&quot;</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onFullScreenHidden</span><span class="p">);</span>
  
  <span class="nx">extension</span><span class="p">.</span><span class="nx">interstitial</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="nx">extension</span><span class="p">.</span><span class="nx">interstitial</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>

  <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Store&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div></td></tr><tr id="section-182"><td class="docs"><div class="pilwrap"><a href="#section-182" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This namespace represents the In-app purchases extension API.</p>

<div class="alert alert-success">
    *   Here you will find a demo about this namespace: <a href="https://github.com/ludei/cocoonjs-demos/tree/master/Store-skeleton">Store-skeleton demo</a>.
    *</div>

<pre><code>*
</code></pre>

<div class="alert alert-warning">
    *    <strong>Warning!</strong> This JavaScript extension requires some configuration parameters on the <a href="https://ludei.zendesk.com/hc/en-us">cloud compiler</a>!
    * </div></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="p">(</span><span class="o">!!</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_SRV_STORE</span><span class="p">);</span></pre></div></td></tr><tr id="section-183"><td class="docs"><div class="pilwrap"><a href="#section-183" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>The object that represents the information of a product in the store.
<ul><li>@memberof Cocoon.Store</li>
<li>@name Cocoon.Store.ProductInfo</li>
<li>@property {object} Cocoon.Store.ProductInfo - The object itself</li>
<li>@property {string} Cocoon.Store.ProductInfo.productId The id of the product.</li>
<li>@property {string} Cocoon.Store.ProductInfo.productAlias The alias of the product.</li>
<li>@property {Cocoon.Store.ProductType} Cocoon.Store.ProductInfo.productType The product type.</li>
<li>@property {string} Cocoon.Store.ProductInfo.title The title of the product.</li>
<li>@property {string} Cocoon.Store.ProductInfo.description The description of the product.</li>
<li>@property {string} Cocoon.Store.ProductInfo.price The price of the product.</li>
<li>@property {string} Cocoon.Store.ProductInfo.localizedPrice The localized price of the product.</li>
<li>@property {string} Cocoon.Store.ProductInfo.downloadURL The URL of the asset to be downloaded for this purchase.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">ProductInfo</span> <span class="o">=</span> <span class="p">{</span>

    <span class="nx">productId</span> <span class="o">:</span> <span class="s2">&quot;productId&quot;</span><span class="p">,</span>

    <span class="nx">productAlias</span> <span class="o">:</span> <span class="s2">&quot;productAlias&quot;</span><span class="p">,</span>

    <span class="nx">productType</span> <span class="o">:</span> <span class="s2">&quot;productType&quot;</span><span class="p">,</span>

    <span class="nx">title</span> <span class="o">:</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span>

    <span class="nx">description</span> <span class="o">:</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span>

    <span class="nx">price</span> <span class="o">:</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span>

    <span class="nx">localizedPrice</span> <span class="o">:</span> <span class="s2">&quot;localizedPrice&quot;</span><span class="p">,</span>

    <span class="nx">downloadURL</span> <span class="o">:</span> <span class="s2">&quot;downloadURL&quot;</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-184"><td class="docs"><div class="pilwrap"><a href="#section-184" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>The predefined possible states of product types.
<ul><li>@memberof Cocoon.Store</li>
<li>@name Cocoon.Store.ProductType</li>
<li>@property {object} Cocoon.Store.ProductType - The object itself</li>
<li>@property {string} Cocoon.Store.ProductType.CONSUMABLE A consumable product. See platform documentation for further information.</li>
<li>@property {string} Cocoon.Store.ProductType.NON_CONSUMABLE See platform documentation for further information.</li>
<li>@property {string} Cocoon.Store.ProductType.AUTO_RENEWABLE_SUBSCRIPTION An auto-renewable subscription. See platform documentation for further information.</li>
<li>@property {string} Cocoon.Store.ProductType.FREE_SUBSCRIPTION A free subscription. See platform documentation for further information.</li>
<li>@property {string} Cocoon.Store.ProductType.NON_RENEWABLE_SUBSCRIPTION A non-renewable subscription. See platform documentation for further information.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">ProductType</span> <span class="o">=</span> 
  <span class="p">{</span>

      <span class="nx">CONSUMABLE</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

      <span class="nx">NON_CONSUMABLE</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>

      <span class="nx">AUTO_RENEWABLE_SUBSCRIPTION</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span>

      <span class="nx">FREE_SUBSCRIPTION</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span>

      <span class="nx">NON_RENEWABLE_SUBSCRIPTION</span> <span class="o">:</span> <span class="mi">4</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-185"><td class="docs"><div class="pilwrap"><a href="#section-185" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>The predefined possible store types.
<ul><li>@memberof Cocoon.Store</li>
<li>@name Cocoon.Store.StoreType</li>
<li>@property {object} Cocoon.Store.StoreType - The object itself</li>
<li>@property {string} Cocoon.Store.StoreType.APP_STORE Apple AppStore.</li>
<li>@property {string} Cocoon.Store.StoreType.PLAY_STORE Android Play Store.</li>
<li>@property {string} Cocoon.Store.StoreType.MOCK_STORE Mock Store (Used for testing).</li>
<li>@property {string} Cocoon.Store.StoreType.CHROME_STORE Chrome AppStore.</li>
<li>@property {string} Cocoon.Store.StoreType.AMAZON_STORE Amazon AppStore.</li>
<li>@property {string} Cocoon.Store.StoreType.NOOK_STORE Nook Store.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">StoreType</span> <span class="o">=</span> 
  <span class="p">{</span>

      <span class="nx">APP_STORE</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

      <span class="nx">PLAY_STORE</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>

    <span class="nx">MOCK_STORE</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span>

      <span class="nx">CHROME_STORE</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span>

      <span class="nx">AMAZON_STORE</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span>

      <span class="nx">NOOK_STORE</span> <span class="o">:</span> <span class="mi">5</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-186"><td class="docs"><div class="pilwrap"><a href="#section-186" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>The object that represents the information of a purchase.
<ul><li>@memberof Cocoon.Store</li>
<li>@name Cocoon.Store.PurchaseInfo</li>
<li>@property {object} Cocoon.Store.PurchaseInfo - The object itself</li>
<li>@property {string} Cocoon.Store.PurchaseInfo.transactionId The transaction id of a purchase.</li>
<li>@property {string} Cocoon.Store.PurchaseInfo.purchaseTime The time when the purchase was done in seconds since 1970.</li>
<li>@property {Cocoon.Store.PurchaseState} Cocoon.Store.PurchaseInfo.purchaseState The state of the purchase.</li>
<li>@property {string} Cocoon.Store.PurchaseInfo.productId The product id related to this purchase.</li>
<li>@property {string} Cocoon.Store.PurchaseInfo.quantity The number of products of the productId kind purchased in this transaction.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">PurchaseInfo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">,</span> <span class="nx">purchaseTime</span><span class="p">,</span> <span class="nx">purchaseState</span><span class="p">,</span> <span class="nx">productId</span><span class="p">,</span> <span class="nx">quantity</span><span class="p">)</span>
  <span class="p">{</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">transactionId</span> <span class="o">=</span> <span class="nx">transactionId</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">purchaseTime</span> <span class="o">=</span> <span class="nx">purchaseTime</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">purchaseState</span> <span class="o">=</span> <span class="nx">purchaseState</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">productId</span> <span class="o">=</span> <span class="nx">productId</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">=</span> <span class="nx">quantity</span><span class="p">;</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-187"><td class="docs"><div class="pilwrap"><a href="#section-187" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The predefined possible states of a purchase.<br />    * @memberof Cocoon.Store<br />    * @name Cocoon.Store.PurchaseState<br />    * @property {object} Cocoon.Store.PurchaseState - The object itself<br />    * @property {string} Cocoon.Store.PurchaseState.PURCHASED The product has been successfully purchased. The transaction has ended successfully.<br />    * @property {string} Cocoon.Store.PurchaseState.CANCELED The purchase has been canceled.<br />    * @property {string} Cocoon.Store.PurchaseState.REFUNDED The purchase has been refunded.<br />    * @property {string} Cocoon.Store.PurchaseState.EXPIRED The purchase (subscriptions only) has expired and is no longer valid.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">PurchaseState</span> <span class="o">=</span> 
  <span class="p">{</span>

      <span class="nx">PURCHASED</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

      <span class="nx">CANCELED</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>

      <span class="nx">REFUNDED</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span>

      <span class="nx">EXPIRED</span> <span class="o">:</span> <span class="mi">3</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-188"><td class="docs"><div class="pilwrap"><a href="#section-188" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Gets the name of the native store implementation. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function getStoreType</li>
<li>@returns {Cocoon.Store.StoreType} The store type.</li>
<li>@example</li>
<li>console.log(Cocoon.Store.getStoreType());</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">getStoreType</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;getStoreType&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-189"><td class="docs"><div class="pilwrap"><a href="#section-189" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Starts the Store Service. This will make the system to initialize the 
<ul><li>Store Service and probably Store callbacks will start to be received </li>
<li>after calling this method. Because of this, you should have set your event handler </li>
<li>before calling this method, so you don't lose any callback.</li>
<li>@memberof Cocoon.Store</li>
<li>@function initialize</li>
<li>@example</li>
<li>Cocoon.Store.initialize();</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">initialize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">){</span>
    
    <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">||</span> <span class="p">{};</span>

    <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">sandbox</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">managed</span> <span class="o">:</span> <span class="kc">true</span>
        <span class="p">};</span>

        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">properties</span><span class="p">,</span><span class="nx">params</span><span class="p">);</span>

    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">requestInitialization</span><span class="p">({</span> 
      <span class="nx">sandbox</span><span class="o">:</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
      <span class="nx">managed</span><span class="o">:</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">});</span>
    
    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
  <span class="p">}</span></pre></div></td></tr><tr id="section-190"><td class="docs"><div class="pilwrap"><a href="#section-190" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>@memberof Cocoon.Store
<ul><li>@function requestInitialization</li>
<li>@private</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">requestInitialization</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parameters</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">parameters</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> 
        <span class="p">{</span>
            <span class="nx">parameters</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">parameters</span><span class="p">[</span><span class="s1">&#39;managed&#39;</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">parameters</span><span class="p">[</span><span class="s1">&#39;remote&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parameters</span><span class="p">[</span><span class="s1">&#39;managed&#39;</span><span class="p">];</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">parameters</span><span class="p">[</span><span class="s1">&#39;sandbox&#39;</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">parameters</span><span class="p">[</span><span class="s1">&#39;debug&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parameters</span><span class="p">[</span><span class="s1">&#39;sandbox&#39;</span><span class="p">];</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;requestInitialization&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-191"><td class="docs"><div class="pilwrap"><a href="#section-191" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>@memberof Cocoon.Store
<ul><li>@function start</li>
<li>@private</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-192"><td class="docs"><div class="pilwrap"><a href="#section-192" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>This method allows you to check is the  Store service is available in this platform. 
<ul><li>Not all iOS and Android devices will have the Store service </li>
<li>available so you should check if it is before calling any other method.</li>
<li>@memberof Cocoon.Store</li>
<li>@function canPurchase</li>
<li>@returns {boolean} True if the service is available and false otherwise.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">canPurchase</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;canPurchase&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-193"><td class="docs"><div class="pilwrap"><a href="#section-193" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Fetches the products from the CocoonJS Cloud Compiling service store configuration. 
<ul><li>The request is monitored using the "load" signal events.</li>
<li>@memberof Cocoon.Store</li>
<li>@function fetchProductsFromServer</li>
<li>@private</li>
<li>@example</li>
<li>// First register callbacks
Cocoon.Store.on("load",{
started: function(){ ... },
success: function(products){ ... },
error: function(errorMessage){ ... }
});
// Then call the fetch method
Cocoon.Store.fetchProductsFromServer();</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">fetchProductsFromServer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;fetchProductsFromServer&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-194"><td class="docs"><div class="pilwrap"><a href="#section-194" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Fetches the products information from the Store. 
<ul><li>The request is monitored using the "load" signal events.</li>
<li>@memberof Cocoon.Store</li>
<li>@function loadProducts</li>
<li>@example</li>
<li>// First register callbacks
Cocoon.Store.on("load",{
started: function(){ ... },
success: function(products){ ... },
error: function(errorMessage){ ... }
});
// Then call the fetch method
Cocoon.Store.loadProducts(["magic.sword", "health.potion"]);</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">loadProducts</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">productIds</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;fetchProductsFromStore&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-195"><td class="docs"><div class="pilwrap"><a href="#section-195" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Finishes a purchase transaction and removes the transaction from the transaction queue. 
<ul><li>This method must be called after a purchase finishes successfully and the "success" </li>
<li>event inside of the "on purchase products" callback has been received. </li>
<li>If the purchase includes some asset to download from an external server this method must be called after the asset has been successfully downloaded. </li>
<li>If you do not finish the transaction because the asset has not been correctly downloaded the {@link Cocoon.Store.onProductPurchaseStarted} method will be called again later on.</li>
<li>@memberof Cocoon.Store</li>
<li>@function finish</li>
<li>@param {string} transactionId The transactionId of the purchase to finish.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">finish</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;finishPurchase&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-196"><td class="docs"><div class="pilwrap"><a href="#section-196" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Consumes a purchase. This makes that product to be purchasable again. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function consume</li>
<li>@param {string} transactionId The transaction Id of the purchase to consume.</li>
<li>@param {string} productId The product Id of the product to be consumed.</li>
<li>@example
Cocoon.Store.on("consume",{
started: function(transactionId){ ... },
success: function(transactionId){ ... },
error: function(transactionId, err){ ... }
});</li>
<li>Cocoon.Store.consume("magic.sword");</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">consume</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">,</span> <span class="nx">productId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;consumePurchase&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-197"><td class="docs"><div class="pilwrap"><a href="#section-197" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Requests a product purchase given it's product id. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function purchase</li>
<li>@param {string} productId The id or alias of the product to be purchased.</li>
<li>@example
Cocoon.Store.on("purchase",{
started: function(productId){ ... },
success: function(purchaseInfo){ ... },
verification: function(productId,data){ ... }, // This callback will be fired only when using "unmanaged" mode
error: function(productId, err){ ... }
});</li>
<li>Cocoon.Store.purchase("magic.sword");</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">purchase</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">productId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;purchaseFeature&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-198"><td class="docs"><div class="pilwrap"><a href="#section-198" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Requests a product purchase given it's product id showing a modal progress dialog. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function puchaseProductModal</li>
<li>@param {string} productId The id or alias of the product to be purchased.</li>
<li>@private</li>
<li>@example
Cocoon.Store.on("purchase",{
started: function(productId){ ... },
success: function(purchaseInfo){ ... },
verification: function(productId,data){ ... }, // This callback will be fired only when using "unmanaged" mode
error: function(productId, err){ ... }
});</li>
<li>Cocoon.Store.puchaseProductModal("magic.sword");</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">puchaseProductModal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">productId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;purchaseFeatureModal&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-199"><td class="docs"><div class="pilwrap"><a href="#section-199" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Requests a product purchase given it's product id showing a modal progress dialog. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function purchaseProductModalWithPreview</li>
<li>@param {string} productId The id or alias of the product to be purchased.</li>
<li>@private</li>
<li>@example
Cocoon.Store.on("purchase",{
started: function(productId){ ... },
success: function(purchaseInfo){ ... },
verification: function(productId,data){ ... }, // This callback will be fired only when using "unmanaged" mode
error: function(productId, err){ ... }
});</li>
<li>Cocoon.Store.purchaseProductModalWithPreview("magic.sword");</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">purchaseProductModalWithPreview</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">productId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;purchaseFeatureModalWithPreview&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-200"><td class="docs"><div class="pilwrap"><a href="#section-200" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns if a product has been already purchased or not. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function isProductPurchased</li>
<li>@param {string} productId The product id or alias of the product to be checked.</li>
<li>@returns {boolean} A boolean that indicates whether the product has been already purchased.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">isProductPurchased</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">productId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;isFeaturePurchased&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-201"><td class="docs"><div class="pilwrap"><a href="#section-201" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Restores all the purchases from the platform's market. 
<ul><li>For each already purchased product the event "restore" will be called.</li>
<li>@memberof Cocoon.Store</li>
<li>@function restore</li>
<li>@example
Cocoon.Store.on("restore",{
started: function(){ ... },
success: function(){ ... },
error: function(errorMessage){ ... }
});</li>
<li>Cocoon.Store.restore();</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">restore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;restorePurchases&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-202"><td class="docs"><div class="pilwrap"><a href="#section-202" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>@memberof Cocoon.Store
<ul><li>@private</li>
<li>@function restore</li>
<li>@example
Cocoon.Store.on("restore",{
started: function(){ ... },
success: function(){ ... },
error: function(errorMessage){ ... }
});</li>
<li>Cocoon.Store.restorePurchasesModal();</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">restorePurchasesModal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;restorePurchasesModal&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-203"><td class="docs"><div class="pilwrap"><a href="#section-203" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns all the locally stored products.
<ul><li>@memberof Cocoon.Store</li>
<li>@function getProducts</li>
<li>@returns {Cocoon.Store.ProductInfo} An array with all the objects available for purchase.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">getProducts</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;getProducts&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-204"><td class="docs"><div class="pilwrap"><a href="#section-204" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Adds a product to the products local DB. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function addProduct</li>
<li>@param {Cocoon.Store.ProductInfo} product The product to be added to the local products DB.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">addProduct</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">product</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;addProduct&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-205"><td class="docs"><div class="pilwrap"><a href="#section-205" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Removes a product from the products local DB given its productId. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function removeProduct</li>
<li>@param {string} productId The product or alias of the product to be removed from the local products DB.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">removeProduct</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">productId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;removeProduct&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-206"><td class="docs"><div class="pilwrap"><a href="#section-206" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns all the locally stored purchases.
<ul><li>@memberof Cocoon.Store</li>
<li>@function getPurchases</li>
<li>@returns {Cocoon.Store.PurchaseInfo} An array with all the completed purchases.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">getPurchases</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;getPurchases&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-207"><td class="docs"><div class="pilwrap"><a href="#section-207" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Adds a purchase to the local purchases DB. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function addPurchase</li>
<li>@param {Cocoon.Store.PurchaseInfo} purchase The purchase to be added.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">addPurchase</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">purchase</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;addPurchase&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-208"><td class="docs"><div class="pilwrap"><a href="#section-208" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Removes a purchase from the local purchases DB given it's transaction id. 
<ul><li>@memberof Cocoon.Store</li>
<li>@function removePurchase</li>
<li>@param {string} transactionId The id of the transaction to be removed.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">removePurchase</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;removePurchase&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-209"><td class="docs"><div class="pilwrap"><a href="#section-209" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>(TESTING ONLY) Simulate a purchase cancel. 
<ul><li>This method is not allowed in production services and will only work in Mocks. </li>
<li>@private</li>
<li>@memberof Cocoon.Store</li>
<li>@function cancelPurchase</li>
<li>@param {string} transactionId The transactionId of the purchase to be canceled.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">cancelPurchase</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;cancelPurchase&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-210"><td class="docs"><div class="pilwrap"><a href="#section-210" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>(TESTING ONLY) Simulates a purchase refundment. 
<ul><li>This method is not allowed in production services and will only work in Mocks.</li>
<li>@private</li>
<li>@memberof Cocoon.Store</li>
<li>@function refundPurchase</li>
<li>@param {string} transactionId The transactionId of the purchase to be refunded.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">refundPurchase</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;refundPurchase&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-211"><td class="docs"><div class="pilwrap"><a href="#section-211" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>(TESTING ONLY) Simulates a purchase expiration. 
<ul><li>This method is not allowed in production services and will only work in Mocks.</li>
<li>@private</li>
<li>@memberof Cocoon.Store</li>
<li>@function expirePurchase</li>
<li>@param {string} transactionId The transactionId of the purchase to be expired.</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">expirePurchase</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;expirePurchase&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductsFetchStarted</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onProductsFetchStarted&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductsFetchCompleted</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onProductsFetchCompleted&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductsFetchFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onProductsFetchFailed&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductPurchaseStarted</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onProductPurchaseStarted&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductPurchaseVerificationRequestReceived</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onProductPurchaseVerificationRequestReceived&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductPurchaseCompleted</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onProductPurchaseCompleted&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductPurchaseFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onProductPurchaseFailed&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onRestorePurchasesStarted</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onRestorePurchasesStarted&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onRestorePurchasesCompleted</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onRestorePurchasesCompleted&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onRestorePurchasesFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onRestorePurchasesFailed&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onConsumePurchaseStarted</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onConsumePurchaseStarted&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onConsumePurchaseCompleted</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onConsumePurchaseCompleted&quot;</span><span class="p">);</span> 

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onConsumePurchaseFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_STORE&quot;</span><span class="p">,</span> <span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;onConsumePurchaseFailed&quot;</span><span class="p">);</span>
  
  <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span>
  </pre></div></td></tr><tr id="section-212"><td class="docs"><div class="pilwrap"><a href="#section-212" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events about the loading process. <br />- The callback 'started' receives no parameters when the products fetch has started.<br />- The callback 'success' receives a parameter with the valid products array when the products fetch has completed.<br />- The callback 'error' receives an error message as a parameter when the products fetch has failed.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;load&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">started</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductsFetchStarted</span><span class="p">,</span>
    <span class="nx">success</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductsFetchCompleted</span><span class="p">,</span>
    <span class="nx">error</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductsFetchFailed</span>
  <span class="p">});</span></pre></div></td></tr><tr id="section-213"><td class="docs"><div class="pilwrap"><a href="#section-213" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events about the purchasing process.<br />- The callback 'started' receives a parameters with the product id of the product being purchased when the purchase of a product starts.<br />     * - The callback 'success' receives as parameter the information of the purchase {@link Cocoon.Store.PurchaseInfo} when the purchase of a product succeeds. <br /><br />- The callback 'verification' receives two parameters, one with the productId of the purchased product and another one with a JSON object containing the data to be verified when a request for purchase verification has been received from the Store. <br />In Android this JSON object will containt two keys: signedData and signature. You will need that information to verify the purchase against the backend server.<br />     * - The callback 'error' receives a parameters with the product id and an error message when the purchase of a product fails.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;purchase&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">started</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductPurchaseStarted</span><span class="p">,</span>
    <span class="nx">success</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductPurchaseCompleted</span><span class="p">,</span>
    <span class="nx">verification</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductPurchaseVerificationRequestReceived</span><span class="p">,</span>
    <span class="nx">error</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onProductPurchaseFailed</span>
  <span class="p">});</span></pre></div></td></tr><tr id="section-214"><td class="docs"><div class="pilwrap"><a href="#section-214" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events about the consuming process.<br />- The callback 'started' receives a parameters with the transaction id of the purchase being consumed when the consume purchase operation has started.<br />- The callback 'success' receives a parameters with the transaction id of the consumed purchase when the consume purchase operation has completed.<br />- The callback 'error' receives a parameters with the transaction id  of the purchase that couldn't be consumed and the error message when the consume purchase operation has failed.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;consume&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">started</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onConsumePurchaseStarted</span><span class="p">,</span>
    <span class="nx">success</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onConsumePurchaseCompleted</span><span class="p">,</span>
    <span class="nx">error</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onConsumePurchaseFailed</span>
  <span class="p">});</span></pre></div></td></tr><tr id="section-215"><td class="docs"><div class="pilwrap"><a href="#section-215" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events about the restoring process.<br />- The callback 'started' receives no parameters when the restore purchases operation has started.<br />- The callback 'success' receives no parameters when the restore purchases operation has completed.<br />- The callback 'error' receives an error message as a parameter when the restore purchases operation has failed.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;restore&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">started</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onRestorePurchasesStarted</span><span class="p">,</span>
    <span class="nx">success</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onRestorePurchasesCompleted</span><span class="p">,</span>
    <span class="nx">error</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onRestorePurchasesFailed</span>
  <span class="p">});</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>

  <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> * This namespace represents the Cocoon Notification extension.</span>
<span class="cm"> * The following image illustrates how the notification would look like when it arrives to your device. </span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div&gt; &lt;img src=&quot;img/cocoon-notification.jpg&quot;  height=&quot;35%&quot; width=&quot;35%&quot;/&gt; &lt;br/&gt; &lt;br/&gt;&lt;/div&gt;</span>
<span class="cm"> * &lt;p&gt;You will find a complete example about how to use this extension in the Local namespace.&lt;p&gt; </span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm"> *   Here you will find a demo about this namespace: &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/master/Notifications&quot;&gt;Notifications demo&lt;/a&gt;.</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> * </span>
<span class="cm"> * @namespace Cocoon.Notification</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Notification&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">.</span><span class="nx">IDTK_SRV_NOTIFICATION</span><span class="p">);</span></pre></div></td></tr><tr id="section-216"><td class="docs"><div class="pilwrap"><a href="#section-216" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>This namespace represents the Cocoon Notification extension for local notifications.
<ul><li>@namespace Cocoon.Notification.Local</li>
<li>@example </li>
<li>Cocoon.Notification.Local.on("notification", {</li>
<li>received: function(userData){
  console.log("A local notification has been received: " + JSON.stringify(userData));
}</li>
<li>});
*</li>
<li>var notificationConfig = {</li>
<li>message : "Hi, I am a notification",</li>
<li>soundEnabled : true,</li>
<li>badgeNumber : 0,</li>
<li>userData : {"key1" : "value1", "key2": "value2"},</li>
<li>contentBody : "",</li>
<li>contentTitle : "",</li>
<li>date : new Date().valueOf() + 1000</li>
<li>};</li>
<li>
<ul><li>var localNotification = Cocoon.Notification.Local.create(notificationConfig);
*</li></ul></li>
<li>Cocoon.Notification.Local.send(localNotification);</li>
<li>Cocoon.Notification.start();</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">Local</span> <span class="o">=</span> <span class="p">{};</span></pre></div></td></tr><tr id="section-217"><td class="docs"><div class="pilwrap"><a href="#section-217" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>This namespace represents the Cocoon Notification extension for push notifications.
<ul><li>@namespace Cocoon.Notification.Push</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">Push</span> <span class="o">=</span> <span class="p">{};</span></pre></div></td></tr><tr id="section-218"><td class="docs"><div class="pilwrap"><a href="#section-218" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns an object that represents the information of a local notification.
<ul><li>@memberOf Cocoon.Notification.Local</li>
<li>@function create</li>
<li>@example</li>
<li>var notificationConfig = {</li>
<li>message : "Hi, I am a notification",</li>
<li>soundEnabled : true,</li>
<li>badgeNumber : 0,</li>
<li>userData : {"key1" : "value1", "key2": "value2"},</li>
<li>contentBody : "",</li>
<li>contentTitle : "",</li>
<li>date : new Date().valueOf() + 5000 // It will be fired in 5 seconds. </li>
<li>};</li>
<li>
<ul><li>var localNotification = Cocoon.Notification.Local.create(notificationConfig);</li></ul></li></ul></li>
</ul></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>    params </span><span class="dox_type">object</span><span>- - The object itself</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Local</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">message</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="nx">soundEnabled</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">badgeNumber</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">userData</span> <span class="o">:</span> <span class="p">{},</span>
      <span class="nx">contentBody</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="nx">contentTitle</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="nx">date</span> <span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">valueOf</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1000</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">properties</span><span class="p">,</span><span class="nx">params</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;createLocalNotification&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-219"><td class="docs"><div class="pilwrap"><a href="#section-219" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns an object structure that represents the information of a push notification.
<ul><li>@memberOf Cocoon.Notification.Push</li>
<li>@function create</li>
<li>@example </li>
<li>var notificationConfig = {</li>
<li>message : "Hi, I am a notification",</li>
<li>soundEnabled : true, </li>
<li>badgeNumber : 0, </li>
<li>userData : {"key1" : "value1", "key2": "value2"},</li>
<li>channels : "", </li>
<li>expirationTime : new Date().valueOf() +  3600, // The notification will be no longer valid in a hour. </li>
<li>expirationTimeInterval :  3600 // The notification will be no longer valid in a hour. </li>
<li>};</li>
<li>
<ul><li>var pushNotification = Cocoon.Notification.Push.create(notificationConfig);</li></ul></li></ul></li>
</ul></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>    params </span><span class="dox_type">object</span><span>- - The object itself</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Push</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">message</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="nx">soundEnabled</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">badgeNumber</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">userData</span> <span class="o">:</span> <span class="p">{},</span>
    <span class="nx">channels</span> <span class="o">:</span> <span class="p">[],</span>
    <span class="nx">expirationTime</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">expirationTimeInterval</span> <span class="o">:</span> <span class="mi">0</span>
    <span class="p">};</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">params</span><span class="p">[</span><span class="nx">prop</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">params</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">properties</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">params</span><span class="p">;</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-220"><td class="docs"><div class="pilwrap"><a href="#section-220" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Starts processing received notifications. The user must call this method when the game is ready to process notifications. Notifications received before being prepared are stored and processed later.
<ul><li>@memberOf Cocoon.Notification</li>
<li>@function start</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-221"><td class="docs"><div class="pilwrap"><a href="#section-221" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Registers to be able to receive push notifications.
<ul><li>@memberOf Cocoon.Notification.Push</li>
<li>@function register</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Push</span><span class="p">.</span><span class="nx">register</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;registerForPushNotifications&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-222"><td class="docs"><div class="pilwrap"><a href="#section-222" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Unregisters from receiving push notifications.
<ul><li>@memberOf Cocoon.Notification.Push</li>
<li>@function unregister</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Push</span><span class="p">.</span><span class="nx">unregister</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;unregisterForPushNotifications&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-223"><td class="docs"><div class="pilwrap"><a href="#section-223" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Cancels the local notification with Id provided.
<ul><li>The last sent local notification will be remove from the notifications bar.</li>
<li>@memberOf Cocoon.Notification.Local</li>
<li>@function cancel</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Local</span><span class="p">.</span><span class="nx">cancel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;cancelLocalNotification&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-224"><td class="docs"><div class="pilwrap"><a href="#section-224" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Cancels the last sent local notification.
<ul><li>The last sent local notification will be remove from the notifications bar.</li>
<li>@memberOf Cocoon.Notification.Local</li>
<li>@function cancelLast</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Local</span><span class="p">.</span><span class="nx">cancelLast</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;cancelLocalNotification&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-225"><td class="docs"><div class="pilwrap"><a href="#section-225" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Cancels all sent local notifications.
<ul><li>All the notifications will ve removed from the notifications bar.</li>
<li>@memberOf Cocoon.Notification.Local</li>
<li>@function cancelAllNotifications</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Local</span><span class="p">.</span><span class="nx">cancelAllNotifications</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;cancelAllLocalNotifications&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-226"><td class="docs"><div class="pilwrap"><a href="#section-226" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Sends a local notification.
<ul><li>@memberOf Cocoon.Notification.Local</li>
<li>@function send</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Local</span><span class="p">.</span><span class="nx">send</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">localNotification</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;sendLocalNotification&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-227"><td class="docs"><div class="pilwrap"><a href="#section-227" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Subscribes to a channel in order to receive notifications targeted to that channel.
<ul><li>@memberOf Cocoon.Notification</li>
<li>@function subscribe</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">subscribe</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">channel</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;subscribe&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-228"><td class="docs"><div class="pilwrap"><a href="#section-228" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Unsubscribes from a channel in order to stop receiving notifications targeted to it.
<ul><li>@memberOf Cocoon.Notification</li>
<li>@function unsubscribe</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">unsubscribe</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">channel</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;unsubscribe&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-229"><td class="docs"><div class="pilwrap"><a href="#section-229" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Sends a push notification.
<ul><li>@memberOf Cocoon.Notification.Push</li>
<li>@function send</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Push</span><span class="p">.</span><span class="nx">send</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pushNotification</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;sendPushNotification&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-230"><td class="docs"><div class="pilwrap"><a href="#section-230" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>(iOS only) Sets the badge number for this application.
<ul><li>This is useful if you want to modify the badge number set by a notification.</li>
<li>@memberOf Cocoon.Notification</li>
<li>@function setBadgeNumber</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">setBadgeNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">badgeNumber</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;setBadgeNumber&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-231"><td class="docs"><div class="pilwrap"><a href="#section-231" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>(iOS only) Returns the current badge number.
<ul><li>@memberOf Cocoon.Notification</li>
<li>@function getBadgeNumber</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">getBadgeNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;getBadgeNumber&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-232"><td class="docs"><div class="pilwrap"><a href="#section-232" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns the last received user data from a Local notification.
<ul><li>@memberOf Cocoon.Notification.Local</li>
<li>@function getLastNotificationData</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Local</span><span class="p">.</span><span class="nx">getLastNotificationData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;getLastReceivedLocalNotificationData&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-233"><td class="docs"><div class="pilwrap"><a href="#section-233" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns the last received user data from a Push notification.
<ul><li>@memberOf Cocoon.Notification.Push</li>
<li>@function getLastNotificationData</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Push</span><span class="p">.</span><span class="nx">getLastNotificationData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;getLastReceivedPushNotificationData&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onRegisterForPushNotificationsSucceed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;Notification&quot;</span><span class="p">,</span> <span class="s2">&quot;pushNotificationServiceRegistered&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onUnregisterForPushNotificationsSucceed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;Notification&quot;</span><span class="p">,</span> <span class="s2">&quot;pushNotificationServiceUnregistered&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onRegisterForPushNotificationsFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;Notification&quot;</span><span class="p">,</span> <span class="s2">&quot;pushNotificationServiceFailedToRegister&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onPushNotificationReceived</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;Notification&quot;</span><span class="p">,</span> <span class="s2">&quot;pushNotificationReceived&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onLocalNotificationReceived</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;Notification&quot;</span><span class="p">,</span> <span class="s2">&quot;localNotificationReceived&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onPushNotificationDeliverySucceed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;Notification&quot;</span><span class="p">,</span> <span class="s2">&quot;pushNotificationSuccessfullyDelivered&quot;</span><span class="p">);</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">onPushNotificationDeliveryFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_NOTIFICATION&quot;</span><span class="p">,</span> <span class="s2">&quot;Notification&quot;</span><span class="p">,</span> <span class="s2">&quot;pushNotificationDeliveryError&quot;</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span></pre></div></td></tr><tr id="section-234"><td class="docs"><div class="pilwrap"><a href="#section-234" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Allows to listen  to events called when a local notification is received.
<ul><li><ul><li>The callback 'received' receives a parameter with the userData of the received notification when a local notification is received.</li></ul></li></ul></li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;notification&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">received</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onLocalNotificationReceived</span>
    <span class="p">});</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">Local</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>

  <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span></pre></div></td></tr><tr id="section-235"><td class="docs"><div class="pilwrap"><a href="#section-235" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Allows to listen to events called about the registration for push notification.
<ul><li><ul><li>The callback 'success' does not receive any parameter when the registration for push notification succeeds.</li></ul></li>
<li><ul><li>The callback 'unregister' does not receive any parameter when the unregistration for push notifications succeeds.</li></ul></li>
<li><ul><li>The callback 'error' receives a parameter with error information when the registration for push notifications fails.</li></ul></li></ul></li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;register&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">success</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onRegisterForPushNotificationsSucceed</span><span class="p">,</span>
      <span class="nx">unregister</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onUnregisterForPushNotificationsSucceed</span><span class="p">,</span>
      <span class="nx">error</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onRegisterForPushNotificationsFailed</span>
    <span class="p">});</span></pre></div></td></tr><tr id="section-236"><td class="docs"><div class="pilwrap"><a href="#section-236" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Allows to listen to events called when a push notification  is received.
<ul><li><ul><li>The callback 'received' receives a parameter with the userData of the received notification when a push notification is received.</li></ul></li></ul></li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;notification&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">received</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onPushNotificationReceived</span><span class="p">,</span>
    <span class="p">});</span></pre></div></td></tr><tr id="section-237"><td class="docs"><div class="pilwrap"><a href="#section-237" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Allows to listen to events called about the delivery proccess.
<ul><li><ul><li>The callback 'success' receives a parameter with the notificationId of the delivered notification when a notification is successfully delivered.</li></ul></li>
<li><ul><li>The callback 'error' receives a parameter with error information when the delivery of a push notification fails.</li></ul></li></ul></li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;deliver&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">success</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onPushNotificationDeliverySucceed</span><span class="p">,</span>
      <span class="nx">error</span> <span class="o">:</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">onPushNotificationDeliveryFailed</span>
    <span class="p">});</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">Push</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>

<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> * This namespace provides an abstraction API for all the Social Services.</span>
<span class="cm"> * Each Social service has it&#39;s own official API but can also be used within this API interface.&lt;br/&gt;</span>
<span class="cm"> * Note that this javascript extension can be used to manage &lt;b&gt;Leaderboards and Achievements.&lt;/b&gt; &lt;br/&gt;</span>
<span class="cm"> * In order to understand how to use the social javascript extension refer to the social service you would like to to use:</span>
<span class="cm"> * - &lt;a href=&quot;Cocoon.Social.Facebook.html&quot;&gt;Facebook&lt;/a&gt;</span>
<span class="cm"> * - &lt;a href=&quot;Cocoon.Social.GooglePlayGames.html&quot;&gt;Google Play Games&lt;/a&gt;</span>
<span class="cm"> * - &lt;a href=&quot;Cocoon.Social.GameCenter.html&quot;&gt;Game Center&lt;/a&gt;</span>
<span class="cm"> * @namespace Cocoon.Social</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Social&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span></pre></div></td></tr><tr id="section-238"><td class="docs"><div class="pilwrap"><a href="#section-238" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This interface provides an abstraction API for all the Social Services, this is an interface and never should be call directly. <br />Each Social service has it's own official API but can also be used within this API interface. In order to use this <br />interface you should call the method getSocialInterface(); that is available in the following classes:<br />- <a href="Cocoon.Social.Facebook.html">Facebook</a><br />- <a href="Cocoon.Social.GooglePlayGames.html">Google Play Games</a><br />- <a href="Cocoon.Social.GameCenter.html">Game Center</a></p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">Interface</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">onLoginStatusChanged</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;dummy&quot;</span><span class="p">,</span> <span class="s2">&quot;onLoginStatusChanged&quot;</span><span class="p">);</span>
        
        <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span>
        <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;loginStatusChanged&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">onLoginStatusChanged</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
     </pre></div></td></tr><tr id="section-239"><td class="docs"><div class="pilwrap"><a href="#section-239" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Checks if the user is logged in.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">boolean</span><span>true if the user is still logged in, false otherwise.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">isLoggedIn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
             <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-240"><td class="docs"><div class="pilwrap"><a href="#section-240" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Authenticates the user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. Response params: loggedIn(boolean) and error</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">login</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">callback</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-241"><td class="docs"><div class="pilwrap"><a href="#section-241" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Logs the user out of your application.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>[callback] </span><span class="dox_type">function</span><span>- The callback function. Response params: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">logout</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-242"><td class="docs"><div class="pilwrap"><a href="#section-242" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns the information of the currently logged in user.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">@link</span><span>Cocoon.Social.User}</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getLoggedInUser</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-243"><td class="docs"><div class="pilwrap"><a href="#section-243" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Checks if the current logged in user has publish permissions.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">callback</span><span>- callback function. It receives the following parameters: permissions granted and error</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">hasPublishPermissions</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-244"><td class="docs"><div class="pilwrap"><a href="#section-244" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Requests publish permissions for the current logged in user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">callback</span><span>- callback function. It receives the following parameters: granted and error</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">requestPublishPermissions</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">callback</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-245"><td class="docs"><div class="pilwrap"><a href="#section-245" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieves user information for a specific user ID.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- - The callback function. It receives the following parameters: </span></div><div class="dox_tag_detail"><span>userID </span><span class="dox_type">string</span><span>- - The id of the user to retrieve the information from. If no userID is specified, the currently logged in user is assumed.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">requestUser</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">});</span>
        <span class="p">},</span>
        </pre></div></td></tr><tr id="section-246"><td class="docs"><div class="pilwrap"><a href="#section-246" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Requests to retrieve the profile image of a user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: </span></div><div class="dox_tag_detail"><span>userID </span><span class="dox_type">string</span><span>- The id of the user to get the image for. If no userID is specified, the currently logged user is used.</span></div><div class="dox_tag_detail"><span>imageSize </span><span class="dox_type">Cocoon.Social.ImageSize</span><span>- The desired size of the image. Default value: SMALL.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">requestUserImage</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">,</span> <span class="nx">imageSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">})</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-247"><td class="docs"><div class="pilwrap"><a href="#section-247" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieves user friends for a specific user ID.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- - The callback function. It receives the following parameters: </span></div><div class="dox_tag_detail"><span>userID </span><span class="dox_type">string</span><span>- - The id of the user to retrieve the information from. If no userID is specified, the currently logged in user is assumed.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">requestFriends</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">([],</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-248"><td class="docs"><div class="pilwrap"><a href="#section-248" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shares a message without the intervention of the user.<br />This action might require publish permissions. If the user has not publish permissions they are automatically requested.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>message </span><span class="dox_type">Cocoon.Social.Message</span><span>- A object representing the information to be published.</span></div><div class="dox_tag_detail"><span>[callback] </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">publishMessage</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-249"><td class="docs"><div class="pilwrap"><a href="#section-249" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Presents a native/web dialog that allows the user to share a message.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>message </span><span class="dox_type">Cocoon.Social.Message</span><span>- A object representing the information to be published</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: error</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">publishMessageWithDialog</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingService</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingService</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingService</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">_cachedAchievements</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">_achievementsMap</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">_leaderboardsTemplate</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">_achievementsTemplate</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
      </pre></div></td></tr><tr id="section-250"><td class="docs"><div class="pilwrap"><a href="#section-250" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieves the score for a user from a specific leaderboard</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: </span></div><div class="dox_tag_detail"><span>[params] </span><span class="dox_type">Cocoon.Social.ScoreParams</span><span>- The params to retrieve the score. If no params are specified, the currently logged in user and the default leaderboard are assumed.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">requestScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">})</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-251"><td class="docs"><div class="pilwrap"><a href="#section-251" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Submits the score for a user to a specific leaderboard</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>score </span><span class="dox_type">number</span><span>- The score to submit</span></div><div class="dox_tag_detail"><span>[callback] </span><span class="dox_type">function</span><span>- The callback function. Response params: error.</span></div><div class="dox_tag_detail"><span>[params] </span><span class="dox_type">Cocoon.Social.ScoreParams</span><span>- The params to submit the score. If no params are specified, the currently logged in user and the default leaderboard are assumed.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">submitScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">score</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">})</span>
        <span class="p">},</span>
        </pre></div></td></tr><tr id="section-252"><td class="docs"><div class="pilwrap"><a href="#section-252" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows a modal leaderboard view using a platform dependant view.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>[params] </span><span class="dox_type">Cocoon.Social.ScoreParams</span><span>- The params to choose the leaderboard and other settings. If no params are specified the default leaderboard id and settings will be assumed.</span></div><div class="dox_tag_detail"><span>[callback] </span><span class="dox_type">function</span><span>- The callback function invoked when the modal leaderboard view is closed by the user. Response params: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">showLeaderboard</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">})</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-253"><td class="docs"><div class="pilwrap"><a href="#section-253" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieves all the achievements of the application.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">requestAllAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">([],</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">})</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-254"><td class="docs"><div class="pilwrap"><a href="#section-254" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieves the achievements earned by a user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: </span></div><div class="dox_tag_detail"><span>[userId] </span><span class="dox_type">string</span><span>- The id of the user to retrieve the information from. If no userID is specified, the currently logged in user is assumed.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">requestAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">([],</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">})</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-255"><td class="docs"><div class="pilwrap"><a href="#section-255" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Submits the achievement for the current logged In user</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">achievementID</span><span>- achievement ID to submit</span></div><div class="dox_tag_detail"><span>[callback] </span><span class="dox_type">callback</span><span>- The callback function. Response params: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">submitAchievement</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">})</span>
        <span class="p">},</span>
        </pre></div></td></tr><tr id="section-256"><td class="docs"><div class="pilwrap"><a href="#section-256" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Resets all the achievements of the current logged in user</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>[callback] </span><span class="dox_type">function</span><span>- The callback function. Response params: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">resetAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">callback</span><span class="p">([],</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemented!&quot;</span><span class="p">})</span>
        <span class="p">},</span>
     </pre></div></td></tr><tr id="section-257"><td class="docs"><div class="pilwrap"><a href="#section-257" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows a modal achievements view using a platform dependant view.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>[callback] </span><span class="dox_type">function</span><span>- The callback function invoked when the modal achievements view is closed by the user. Response params: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">showAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_achievementsTemplate</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;Please, provide a html template for achievements with the setTemplates method&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">dialog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">WebDialog</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">callbackSent</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="nx">dialog</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_achievementsTemplate</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">dialog</span><span class="p">.</span><span class="nx">closed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">callbackSent</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">requestAchievements</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">dialog</span><span class="p">.</span><span class="nx">closed</span><span class="p">)</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callbackSent</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="kd">var</span> <span class="nx">achs</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">me</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">ach</span> <span class="o">=</span> <span class="nx">me</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                        <span class="nx">achs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">ach</span><span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">achievements</span> <span class="o">&amp;&amp;</span> <span class="nx">achievements</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span> <span class="nx">achievements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">achievements</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">achievementID</span> <span class="o">===</span> <span class="nx">ach</span><span class="p">.</span><span class="nx">achievementID</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">ach</span><span class="p">.</span><span class="nx">achieved</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                    <span class="k">break</span><span class="p">;</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="kd">var</span> <span class="nx">js</span> <span class="o">=</span> <span class="s2">&quot;addAchievements(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">achs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
                <span class="nx">dialog</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-258"><td class="docs"><div class="pilwrap"><a href="#section-258" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Set the map for using custom achievement IDs.<br />The map must be a customID to realID map (accessing map.customID must return the real achievement ID).<br />Whenever this map is enabled users are able to submit achievements with the real achievement ID or with the custom one.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">setAchievementsMap</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">map</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_achievementsMap</span> <span class="o">=</span> <span class="nx">map</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">this</span><span class="p">.</span><span class="nx">syncAchievementsMap</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-259"><td class="docs"><div class="pilwrap"><a href="#section-259" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Provides some templates to be used in the leaderboards and achievements views<br />Some social services (like Facebook) don't have a native view to show achievements or leaderboards views, and use html templates instead.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>leaderboardsTemplate </span><span class="dox_type">string</span><span>- Relative path to the leaderboards template.</span></div><div class="dox_tag_detail"><span>achievementsTemplate </span><span class="dox_type">string</span><span>- Relative path to the achievements template.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">setTemplates</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">leaderboardsTemplate</span><span class="p">,</span> <span class="nx">achievementsTemplate</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_leaderboardsTemplate</span> <span class="o">=</span> <span class="nx">leaderboardsTemplate</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_achievementsTemplate</span> <span class="o">=</span> <span class="nx">achievementsTemplate</span><span class="p">;</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-260"><td class="docs"><div class="pilwrap"><a href="#section-260" class="pilcrow">&#182;</a></div><p>Internal utility methods</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">setCachedAchievements</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievements</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span> <span class="o">=</span> <span class="nx">achievements</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">achievements</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_achievementsMap</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">syncAchievementsMap</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">findAchievement</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">achievementID</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">translateAchievementID</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_achievementsMap</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">customID</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">_achievementsMap</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">customID</span> <span class="o">==</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//important: compare with double equal, because id can be numeric</span>
                        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_achievementsMap</span><span class="p">[</span><span class="nx">customID</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">id</span><span class="p">;</span>
        <span class="p">},</span>
        
        <span class="nx">syncAchievementsMap</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievements</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_achievementsMap</span><span class="p">)</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">achievements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">customID</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">_achievementsMap</span><span class="p">)</span> <span class="p">{</span>
                     <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_achievementsMap</span><span class="p">[</span><span class="nx">customID</span><span class="p">]</span> <span class="o">===</span> <span class="nx">achievements</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">achievementID</span><span class="p">)</span> <span class="p">{</span>
                         <span class="nx">achievements</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">customID</span> <span class="o">=</span> <span class="nx">customID</span><span class="p">;</span>
                     <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    
    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingService</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">Interface</span><span class="p">);</span></pre></div></td></tr><tr id="section-261"><td class="docs"><div class="pilwrap"><a href="#section-261" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object represents the possible images that can be obtained for a user in the social gaming extension.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">ImageSize</span> <span class="o">=</span>
    <span class="p">{</span>
    
        <span class="nx">THUMB</span> <span class="o">:</span> <span class="s2">&quot;thumb&quot;</span><span class="p">,</span>
    
        <span class="nx">SMALL</span> <span class="o">:</span> <span class="s2">&quot;small&quot;</span><span class="p">,</span>
    
        <span class="nx">MEDIUM</span> <span class="o">:</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span>
    
        <span class="nx">LARGE</span> <span class="o">:</span> <span class="s2">&quot;large&quot;</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-262"><td class="docs"><div class="pilwrap"><a href="#section-262" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents the information of a user inside the social gaming extension.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">User</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">userID</span><span class="p">,</span> <span class="nx">userName</span><span class="p">,</span> <span class="nx">userImage</span><span class="p">)</span>
    <span class="p">{</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">userID</span> <span class="o">=</span> <span class="nx">userID</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">userName</span> <span class="o">=</span> <span class="nx">userName</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">userImage</span> <span class="o">=</span> <span class="nx">userImage</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-263"><td class="docs"><div class="pilwrap"><a href="#section-263" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object represents a message to be published.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">Message</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">mediaURL</span><span class="p">,</span> <span class="nx">linkURL</span><span class="p">,</span> <span class="nx">linkText</span><span class="p">,</span> <span class="nx">linkCaption</span><span class="p">)</span>
    <span class="p">{</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="nx">message</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">mediaURL</span> <span class="o">=</span> <span class="nx">mediaURL</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">linkURL</span> <span class="o">=</span> <span class="nx">linkURL</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">linkText</span> <span class="o">=</span> <span class="nx">linkText</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">linkCaption</span> <span class="o">=</span> <span class="nx">linkCaption</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-264"><td class="docs"><div class="pilwrap"><a href="#section-264" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object that represents the information of the user score in the application.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">Score</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">userID</span><span class="p">,</span> <span class="nx">score</span><span class="p">,</span> <span class="nx">userName</span><span class="p">,</span> <span class="nx">imageURL</span><span class="p">,</span> <span class="nx">leaderboardID</span><span class="p">)</span>
    <span class="p">{</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">userID</span> <span class="o">=</span> <span class="nx">userID</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">score</span> <span class="o">=</span> <span class="nx">score</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">userName</span> <span class="o">=</span> <span class="nx">userName</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">imageURL</span> <span class="o">=</span> <span class="nx">imageURL</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">leaderboardID</span> <span class="o">=</span> <span class="nx">leaderboardID</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-265"><td class="docs"><div class="pilwrap"><a href="#section-265" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents params to retrieve or submit scores.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">ScoreParams</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">userID</span><span class="p">,</span> <span class="nx">leaderboardID</span><span class="p">,</span> <span class="nx">friends</span><span class="p">,</span> <span class="nx">timeScope</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">userID</span> <span class="o">=</span> <span class="nx">userID</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">leaderboardID</span> <span class="o">=</span> <span class="nx">leaderboardID</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">friends</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">friends</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">timeScope</span> <span class="o">=</span> <span class="nx">timeScope</span> <span class="o">||</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-266"><td class="docs"><div class="pilwrap"><a href="#section-266" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object represents the possible Time Scopes for a leaderboard query.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">TimeScope</span> <span class="o">=</span>
    <span class="p">{</span>
        <span class="nx">ALL_TIME</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">WEEK</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">TODAY</span><span class="o">:</span><span class="mi">2</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-267"><td class="docs"><div class="pilwrap"><a href="#section-267" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object represents the possible Time Scopes for a leaderboard query.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">Achievement</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">,</span> <span class="nx">title</span><span class="p">,</span> <span class="nx">description</span><span class="p">,</span> <span class="nx">imageURL</span><span class="p">,</span> <span class="nx">points</span><span class="p">)</span>
    <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">achievementID</span> <span class="o">=</span> <span class="nx">achievementID</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">customID</span> <span class="o">=</span> <span class="nx">achievementID</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">title</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">description</span> <span class="o">=</span> <span class="nx">description</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">imageURL</span> <span class="o">=</span> <span class="nx">imageURL</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">points</span> <span class="o">=</span> <span class="nx">points</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-268"><td class="docs"><div class="pilwrap"><a href="#section-268" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Opens a given share native window to share some specific text content in <br />any system specific social sharing options. For example, Twitter, Facebook, SMS, Mail, ...</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>{string} </span><span class="dox_type">textToShare</span><span>- textToShare The text content that will be shared.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">share</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">textToShare</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="s2">&quot;IDTK_APP&quot;</span><span class="p">,</span> <span class="s2">&quot;share&quot;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-269"><td class="docs"><div class="pilwrap"><a href="#section-269" class="pilcrow">&#182;</a></div><p>TODO: Is there something we could do to share in a browser?</p>
</td><td class="code"><div class="highlight"><pre>        <span class="p">}</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> * </span>
<span class="cm"> * @private</span>
<span class="cm"> * @namespace Cocoon.Social.Manager</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Social&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">ManagerService</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">services</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">ManagerService</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">services</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>

        <span class="nx">registerSocialService</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">service</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">services</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">service</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">submitAchievement</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">services</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">service</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">services</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">service</span><span class="p">.</span><span class="nx">readOnlyHint</span> <span class="o">&amp;&amp;</span> <span class="nx">service</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">())</span>  <span class="p">{</span>
                    <span class="nx">service</span><span class="p">.</span><span class="nx">submitAchievement</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span>
                            <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error submitting achievement: &quot;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
                    <span class="p">});</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">submitScore</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">score</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">services</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">service</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">services</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">service</span><span class="p">.</span><span class="nx">readOnlyHint</span> <span class="o">&amp;&amp;</span> <span class="nx">service</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">())</span>  <span class="p">{</span>
                    <span class="nx">service</span><span class="p">.</span><span class="nx">submitScore</span><span class="p">(</span><span class="nx">score</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span>
                            <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error submitting score: &quot;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
                    <span class="p">},</span> <span class="nx">params</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">getLoggedInServices</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">result</span><span class="o">=</span> <span class="p">[];</span>

            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">services</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">service</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">services</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">service</span><span class="p">.</span><span class="nx">fakeSocialService</span> <span class="o">&amp;&amp;</span>  <span class="nx">service</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">())</span>  <span class="p">{</span>
                    <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">service</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">isLoggedInAnySocialService</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLoggedInServices</span><span class="p">().</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">Manager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">ManagerService</span><span class="p">();</span>
    
    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> * This namespace represents all the basic functionalities available in the CocoonJS extension API.</span>
<span class="cm"> * @private</span>
<span class="cm"> * @namespace Cocoon.Social.LocalStorage</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Social&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">LocalStorageService</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">LocalStorageService</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fakeSocialService</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">LocalStorageService</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">loggedIn</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">keys</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">score</span><span class="o">:</span> <span class="s2">&quot;Cocoon.Social.LocalStorageService.score&quot;</span><span class="p">,</span>
            <span class="nx">earnedAchievements</span><span class="o">:</span> <span class="s2">&quot;Cocoon.Social.LocalStorageService.earned&quot;</span>
        <span class="p">},</span>
        <span class="nx">isLoggedIn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">loggedIn</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">login</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">loggedIn</span><span class="p">)</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">onLoginStatusChanged</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">loggedIn</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">callback</span><span class="p">(</span><span class="kc">true</span><span class="p">)},</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">logout</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loggedIn</span><span class="p">)</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">onLoginStatusChanged</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">loggedIn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">callback</span><span class="p">()},</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">getLoggedInUser</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">User</span><span class="p">(</span><span class="s2">&quot;me&quot;</span><span class="p">,</span> <span class="s2">&quot;LocalStorage&quot;</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">requestUser</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">User</span><span class="p">(</span><span class="nx">userID</span> <span class="o">||</span> <span class="s2">&quot;me&quot;</span><span class="p">,</span> <span class="s2">&quot;LocalStorage&quot;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">callback</span><span class="p">(</span><span class="nx">user</span><span class="p">)},</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">requestScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">scoreItem</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">keys</span><span class="p">.</span><span class="nx">score</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">score</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">scoreItem</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">callback</span><span class="p">(</span><span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">Score</span><span class="p">(</span><span class="s2">&quot;me&quot;</span><span class="p">,</span> <span class="nx">score</span><span class="p">))},</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">submitScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">score</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span> <span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">scoreItem</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">keys</span><span class="p">.</span><span class="nx">score</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">topScore</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">scoreItem</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">score</span> <span class="o">&gt;</span> <span class="nx">topScore</span><span class="p">)</span>
                <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">keys</span><span class="p">.</span><span class="nx">score</span><span class="p">,</span> <span class="nx">score</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">callback</span><span class="p">()},</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">getLocalStorageEarnedAchievements</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">achievementsItem</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">keys</span><span class="p">.</span><span class="nx">earnedAchievements</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">earned</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">achievementsItem</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">achievementsItem</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">array</span> <span class="o">&amp;&amp;</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">earned</span> <span class="o">=</span> <span class="nx">array</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">earned</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">requestAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">earned</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLocalStorageEarnedAchievements</span><span class="p">();</span>
            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">callback</span><span class="p">(</span><span class="nx">earned</span><span class="p">)},</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">submitAchievement</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">achievementID</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">achievementID</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;No achievementID specified&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">earned</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLocalStorageEarnedAchievements</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">exists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">earned</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="nx">earned</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">achievementID</span><span class="p">)</span> <span class="p">{</span>
                   <span class="nx">exists</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                   <span class="k">break</span><span class="p">;</span>
               <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">exists</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">earned</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">);</span>
                <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">keys</span><span class="p">.</span><span class="nx">earnedAchievements</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">earned</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">callback</span><span class="p">()},</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">resetAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">keys</span><span class="p">.</span><span class="nx">earnedAchievements</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">callback</span><span class="p">()},</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">extension</span><span class="p">.</span><span class="nx">LocalStorageService</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingService</span><span class="p">);</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">LocalStorage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">LocalStorageService</span><span class="p">();</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> * This namespace represents all the basic functionalities available in the CocoonJS extension API.</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm"> *   Here you will find a demo about this namespace: &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/Google%20Play%20Games&quot;&gt;Google Play Games demo&lt;/a&gt;.</span>
<span class="cm"> *&lt;/div&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-warning&quot;&gt;</span>
<span class="cm"> *    &lt;strong&gt;Warning!&lt;/strong&gt; This JavaScript extension requires some configuration parameters on the &lt;a href=&quot;https://ludei.zendesk.com/hc/en-us&quot;&gt;cloud compiler&lt;/a&gt;!</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> * The following example shows the full process of how to publish a message using GooglePlay extension.The following image illustrates how the result should look like.  </span>
<span class="cm"> * &lt;div&gt;&lt;br/&gt;&lt;img src=&quot;img/cocoon-socialgp-publish3.png&quot; heigh=&quot;50%&quot; width=&quot;55%&quot;/&gt; &lt;/div&gt;</span>
<span class="cm"> * @namespace Cocoon.Social.GooglePlayGames</span>
<span class="cm"> * @example</span>
<span class="cm"> * var gp =  Cocoon.Social.GooglePlayGames;</span>
<span class="cm"> *</span>
<span class="cm"> * var iosClientId = &quot;Your iOS Client ID&quot;; //clientId is not required in android</span>
<span class="cm"> * var webClientId = &quot;Your Web Client ID&quot;;</span>
<span class="cm"> *</span>
<span class="cm"> * gp.init({</span>
<span class="cm"> *     clientId: webClientId,</span>
<span class="cm"> *     defaultLeaderboard:&quot;Your leaderboard ID&quot;</span>
<span class="cm"> * });</span>
<span class="cm"> *</span>
<span class="cm"> * var socialService = gp.getSocialInterface();</span>
<span class="cm"> *     </span>
<span class="cm"> * function loginGP() {</span>
<span class="cm"> *  if (!socialService.isLoggedIn()) {</span>
<span class="cm"> *      socialService.login(function(loggedIn, error) {</span>
<span class="cm"> *          if (error) {</span>
<span class="cm"> *              console.error(&quot;login error: &quot; + error.message);</span>
<span class="cm"> *          }</span>
<span class="cm"> *          else if (loggedIn) {</span>
<span class="cm"> *              var message = new Cocoon.Social.Message(</span>
<span class="cm"> *                  &quot;Hello from the CocoonJS Launcher App! Are you a HTML5 game developer? Come and check out CocoonJS!&quot;,</span>
<span class="cm"> *                  &quot;Ludei - We love HTML5 games!&quot;);</span>
<span class="cm"> *   </span>
<span class="cm"> *              socialService.publishMessageWithDialog(message, function(error) {</span>
<span class="cm"> *                  if (error) {</span>
<span class="cm"> *                      console.error(&quot;Error publishing message: &quot; + error.message);</span>
<span class="cm"> *                  }</span>
<span class="cm"> *              });</span>
<span class="cm"> *          }</span>
<span class="cm"> *          else {</span>
<span class="cm"> *              console.log(&quot;login cancelled&quot;);</span>
<span class="cm"> *          }</span>
<span class="cm"> *      });</span>
<span class="cm"> *  }</span>
<span class="cm"> * }</span>
<span class="cm"> *</span>
<span class="cm"> * loginGP();  </span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Social&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">GooglePlayGamesExtension</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span> <span class="o">=</span> <span class="s2">&quot;IDTK_SRV_GOOGLE_PLAY_GAMES&quot;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span> <span class="o">=</span> <span class="s2">&quot;Social.GooglePlayGames&quot;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span>  <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">auth</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">GooglePlayGamesAuthExtension</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">GooglePlayGamesClientExtension</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">defaultScopes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;https://www.googleapis.com/auth/games&quot;</span><span class="p">,</span><span class="s2">&quot;https://www.googleapis.com/auth/plus.login&quot;</span><span class="p">];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">gamesAPI</span> <span class="o">=</span> <span class="s2">&quot;/games/v1&quot;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">plusAPI</span> <span class="o">=</span> <span class="s2">&quot;/plus/v1&quot;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">onSessionChanged</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="s2">&quot;onSessionChanged&quot;</span><span class="p">);</span>

        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">GooglePlayGames</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> <span class="c1">//the object it&#39;s being created but the addEventListener needs it now</span>
        <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">onSessionChanged</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">session</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">me</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="nx">fromSessionToAuthTokenObject</span><span class="p">(</span><span class="nx">session</span><span class="p">,</span><span class="nx">error</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">session</span> <span class="o">&amp;&amp;</span> <span class="nx">session</span><span class="p">.</span><span class="nx">access_token</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-270"><td class="docs"><div class="pilwrap"><a href="#section-270" class="pilcrow">&#182;</a></div><p>fetch user data</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">me</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="nx">me</span><span class="p">.</span><span class="nx">gamesAPI</span> <span class="o">+</span> <span class="s2">&quot;/players/me&quot;</span><span class="p">,</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">currentPlayer</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
                <span class="p">}});</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">GooglePlayGamesExtension</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">token</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">settings</span><span class="o">:</span> <span class="p">{},</span>
        <span class="nx">socialService</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">currentPlayer</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">initialized</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>

        <span class="nx">auth</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">client</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></pre></div></td></tr><tr id="section-271"><td class="docs"><div class="pilwrap"><a href="#section-271" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initializes the service and tries to restore the last session.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>params </span><span class="dox_type">Object</span><span>- Initialization options.</span></div><div class="dox_tag_detail"><span>params.clientId </span><span class="dox_type">string</span><span>- The application clientID. Omit if its already provided in the native application via cloud configuration.</span></div><div class="dox_tag_detail"><span>params.defaultLeaderboard </span><span class="dox_type">string</span><span>- The default leaderboard ID. You can omit it if you specify the leaderboardID in all the score queries or submits.</span></div><div class="dox_tag_detail"><span>params.showAchievementNotifications </span><span class="dox_type">boolean</span><span>- Enables or disables the native view notifications when an achievement is unlocked.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">params</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">params</span> <span class="o">!==</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;Invalid params argument&quot;</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="nx">params</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">initialized</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;init&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">clientId</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>

                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">initWebAPi</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="nx">gapi</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">authorize</span><span class="p">({</span><span class="nx">immediate</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">scope</span><span class="o">:</span> <span class="nx">me</span><span class="p">.</span><span class="nx">defaultScopes</span><span class="p">,</span> <span class="nx">client_id</span><span class="o">:</span><span class="nx">me</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">clientId</span><span class="p">},</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">access_token</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">me</span><span class="p">.</span><span class="nx">onSessionChanged</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">})</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">gapi</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nb">window</span><span class="p">.</span><span class="nx">onGapiLoadCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div></td></tr><tr id="section-272"><td class="docs"><div class="pilwrap"><a href="#section-272" class="pilcrow">&#182;</a></div><p>initialization timeout recommended by google to avoid some race conditions</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="nb">window</span><span class="p">.</span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">initWebAPi</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">);</span>
                    <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;https://apis.google.com/js/client.js?onload=onGapiLoadCallback&quot;</span><span class="p">;</span>
                    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">initWebAPi</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-273"><td class="docs"><div class="pilwrap"><a href="#section-273" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns a Cocoon SocialGaming interface for the Google Play Games Extension.<br />You can use the Google Play Games extension in two ways, with the official SDK API equivalent or with the CocoonJS Social API abstraction.</p></div><div class="details"><div class="dox_tag_title">See</div><div class="dox_tag_detail"><span class="dox_type">Cocoon.Social.Interface</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getSocialInterface</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">initialized</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;You must call init() before getting the Social Interface&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">socialService</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">socialService</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingServiceGooglePlayGames</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">socialService</span><span class="p">;</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-274"><td class="docs"><div class="pilwrap"><a href="#section-274" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns a Cocoon Multiplayer interface for the Game Center Extension.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getMultiplayerInterface</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">GooglePlayGames</span><span class="p">;</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-275"><td class="docs"><div class="pilwrap"><a href="#section-275" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Return a Cocoon Multiplayer interface for the Game Center Extension.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">share</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

            <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">href</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;</span><span class="p">);</span><span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

        <span class="p">}</span>

    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">GooglePlayGamesAuthExtension</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">extension</span> <span class="o">=</span> <span class="nx">extension</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">GooglePlayGamesAuthExtension</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span></pre></div></td></tr><tr id="section-276"><td class="docs"><div class="pilwrap"><a href="#section-276" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initiates the OAuth 2.0 authorization process.<br />The browser displays a popup window prompting the user authenticate and authorize.<br />After the user authorizes, the popup closes and the callback function fires.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>params </span><span class="dox_type">object</span><span>- A key/value map of parameters for the request (client_id, inmediate, response_type, scope)</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The function to call once the login process is complete. The function takes an OAuth 2.0 token object as its only parameter.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">authorize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;authorize&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">params</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="nx">fromSessionToAuthTokenObject</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span><span class="nx">error</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">token</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">gapi</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">onSessionChanged</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">response</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-277"><td class="docs"><div class="pilwrap"><a href="#section-277" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Logs the user out of the application</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span> </span><span class="dox_type">callback</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">disconnect</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;disconnect&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-278"><td class="docs"><div class="pilwrap"><a href="#section-278" class="pilcrow">&#182;</a></div><p>TODO</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">({</span><span class="nx">error</span><span class="o">:</span> <span class="s2">&quot;Not implemented yet&quot;</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-279"><td class="docs"><div class="pilwrap"><a href="#section-279" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initializes the authorization feature. Call this when the client loads to prevent popup blockers from blocking the auth window on gapi.auth.authorize calls.<br /> @param {Function} callback A callback to execute when the auth feature is ready to make authorization calls</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">callback</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">gapi</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-280"><td class="docs"><div class="pilwrap"><a href="#section-280" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieves the OAuth 2.0 token for the application.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getToken</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">token</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">gapi</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">getToken</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-281"><td class="docs"><div class="pilwrap"><a href="#section-281" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieves the OAuth 2.0 token for the application.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">setToken</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="nx">token</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">gapi</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">setToken</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="nx">extension</span><span class="p">.</span><span class="nx">GooglePlayGamesClientExtension</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">extension</span> <span class="o">=</span> <span class="nx">extension</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">GooglePlayGamesClientExtension</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span></pre></div></td></tr><tr id="section-282"><td class="docs"><div class="pilwrap"><a href="#section-282" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sets the API key for the application, which can be found in the Developer Console. Some APIs require this to be set in order to work.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">apiKey</span><span>- API key to set.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">setApiKey</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;setApiKey&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">apiKey</span><span class="p">],</span><span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">setApiKey</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-283"><td class="docs"><div class="pilwrap"><a href="#section-283" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Creates a HTTP request for making RESTful requests.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>args </span><span class="dox_type">object</span><span>- (More info: https://developers.google.com/api-client-library/javascript/reference/referencedocs#gapiclientrequest)</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">object</span><span>If no callback is supplied, a request object is returned. The request can then be executed using gapi.client.HttpRequest.execute(callback).</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">request</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;request&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">args</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span><span class="nx">error</span><span class="p">){</span>
                        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">result</span> <span class="o">=</span> <span class="nx">response</span> <span class="o">||</span> <span class="p">{};</span>
                            <span class="nx">result</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="nx">error</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">args</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
                    <span class="p">}],</span><span class="kc">true</span><span class="p">);</span>
                    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></pre></div></td></tr><tr id="section-284"><td class="docs"><div class="pilwrap"><a href="#section-284" class="pilcrow">&#182;</a></div><p>return a function to mimic the HttpRequest class</p>
</td><td class="code"><div class="highlight"><pre>                    <span class="kd">var</span> <span class="nx">httpRequest</span> <span class="o">=</span>  <span class="p">{</span>
                        <span class="nx">execute</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;request&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">args</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                                <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">result</span> <span class="o">=</span> <span class="nx">response</span> <span class="o">||</span> <span class="p">{};</span>
                                    <span class="nx">result</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="nx">error</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="nx">callback</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
                            <span class="p">}],</span><span class="kc">true</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">};</span>
                    <span class="k">return</span> <span class="nx">httpRequest</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="nx">extension</span><span class="p">.</span><span class="nx">GooglePlayGames</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">GooglePlayGamesExtension</span><span class="p">();</span></pre></div></td></tr><tr id="section-285"><td class="docs"><div class="pilwrap"><a href="#section-285" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@ignore</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">fromSessionToAuthTokenObject</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">response</span> <span class="o">||</span> <span class="p">{};</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">access_token</span><span class="o">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">access_token</span><span class="p">,</span>
            <span class="nx">state</span><span class="o">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span>
            <span class="nx">error</span><span class="o">:</span> <span class="nx">error</span><span class="p">,</span>
            <span class="nx">expires_in</span><span class="o">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">expirationDate</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">expirationDate</span> <span class="o">-</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">player_id</span><span class="o">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">playerId</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingServiceGooglePlayGames</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">apiObject</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingServiceGooglePlayGames</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span> <span class="o">=</span> <span class="nx">apiObject</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">onSessionChanged</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">session</span><span class="p">){</span>
            <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">session</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="nx">me</span><span class="p">.</span><span class="nx">onLoginStatusChanged</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="o">!!</span><span class="nx">obj</span><span class="p">.</span><span class="nx">access_token</span><span class="p">,</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingServiceGooglePlayGames</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span>  <span class="p">{</span>

        <span class="nx">isLoggedIn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">token</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">token</span><span class="p">.</span><span class="nx">access_token</span><span class="p">)</span> <span class="o">?</span> <span class="kc">true</span><span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">login</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">authorize</span><span class="p">({</span><span class="nx">client_id</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">clientId</span><span class="p">,</span> <span class="nx">scope</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">defaultScopes</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">(),</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">logout</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">getLoggedInUser</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">currentPlayer</span> <span class="o">?</span> <span class="nx">fromGPUserToCocoonUser</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">currentPlayer</span><span class="p">)</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">requestUser</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userId</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">playerId</span> <span class="o">=</span> <span class="nx">userId</span> <span class="o">||</span> <span class="s2">&quot;me&quot;</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">gamesAPI</span> <span class="o">+</span> <span class="s2">&quot;/players/&quot;</span> <span class="o">+</span> <span class="nx">playerId</span><span class="p">,</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">?</span> <span class="nx">fromGPPlayerToCocoonUser</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">callback</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">}});</span>
        <span class="p">},</span>
        <span class="nx">requestUserImage</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">,</span> <span class="nx">imageSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">requestUser</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">user</span> <span class="o">&amp;&amp;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">userImage</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">pixelSize</span> <span class="o">=</span> <span class="nx">fromImageSizeToGPSize</span><span class="p">(</span><span class="nx">imageSize</span> <span class="o">||</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">ImageSize</span><span class="p">.</span><span class="nx">MEDIUM</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">userImage</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;sz=&quot;</span><span class="p">)</span> <span class="o">===</span>  <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">user</span><span class="p">.</span><span class="nx">userImage</span><span class="o">+=</span><span class="s2">&quot;?sz=&quot;</span> <span class="o">+</span> <span class="nx">pixelSize</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">user</span><span class="p">.</span><span class="nx">userImage</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">userImage</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/sz=\d+/g</span><span class="p">,</span><span class="s2">&quot;sz=&quot;</span> <span class="o">+</span> <span class="nx">pixelSize</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="nx">callback</span><span class="p">(</span><span class="nx">user</span> <span class="o">?</span> <span class="nx">user</span><span class="p">.</span><span class="nx">userImage</span> <span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
            <span class="p">},</span> <span class="nx">userID</span><span class="p">);</span>

        <span class="p">},</span>
        <span class="nx">requestFriends</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userId</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">orderBy</span><span class="o">:</span> <span class="s2">&quot;best&quot;</span><span class="p">};</span>
            <span class="kd">var</span> <span class="nx">playerId</span> <span class="o">=</span> <span class="nx">userId</span> <span class="o">||</span> <span class="s2">&quot;me&quot;</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">plusAPI</span> <span class="o">+</span> <span class="s2">&quot;/people/&quot;</span> <span class="o">+</span> <span class="nx">playerId</span> <span class="o">+</span> <span class="s2">&quot;/people/visible&quot;</span><span class="p">,</span> <span class="nx">params</span><span class="o">:</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">friends</span> <span class="o">=</span> <span class="p">[];</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">friends</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fromGPPersonToCocoonUser</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
                    <span class="p">}</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">friends</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">callback</span><span class="p">([],</span> <span class="nx">response</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}});</span>
        <span class="p">},</span>

        <span class="nx">publishMessage</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">callback</span><span class="p">(</span><span class="s2">&quot;Not supported... use publishMessageWithDialog method instead&quot;</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">publishMessageWithDialog</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="nx">prefilledText</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
                    <span class="nx">mediaUrl</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">mediaURL</span><span class="p">,</span>
                    <span class="nx">mediaTitle</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">linkCaption</span><span class="p">,</span>
                    <span class="nx">mediaDescription</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">linkText</span><span class="p">,</span>
                    <span class="nx">url</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">linkURL</span>
                <span class="p">}</span>

                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;shareMessage&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">params</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>

                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">share</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="nx">contenturl</span><span class="o">:</span> <span class="s1">&#39;https://plus.google.com/pages/&#39;</span><span class="p">,</span>
                        <span class="nx">contentdeeplinkid</span><span class="o">:</span> <span class="s1">&#39;/pages&#39;</span><span class="p">,</span>
                        <span class="nx">clientid</span><span class="o">:</span> <span class="nx">me</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">clientId</span><span class="p">,</span>
                        <span class="nx">cookiepolicy</span><span class="o">:</span> <span class="s1">&#39;single_host_origin&#39;</span><span class="p">,</span>
                        <span class="nx">prefilltext</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
                        <span class="nx">calltoactionlabel</span><span class="o">:</span> <span class="s1">&#39;CREATE&#39;</span><span class="p">,</span>
                        <span class="nx">calltoactionurl</span><span class="o">:</span> <span class="s1">&#39;http://plus.google.com/pages/create&#39;</span><span class="p">,</span>
                        <span class="nx">calltoactiondeeplinkid</span><span class="o">:</span> <span class="s1">&#39;/pages/create&#39;</span>
                    <span class="p">};</span>

                    <span class="nx">gapi</span><span class="p">.</span><span class="nx">interactivepost</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;sharePost&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">interactivepost</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span> <span class="nx">script</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span> <span class="nx">script</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">&#39;https://apis.google.com/js/plusone.js&#39;</span><span class="p">;</span>
                    <span class="nx">script</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                        <span class="nx">share</span><span class="p">();</span>
                    <span class="p">}</span>
                    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">share</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">requestScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="kd">var</span> <span class="nx">playerId</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">userID</span> <span class="o">||</span> <span class="s2">&quot;me&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">leaderboardID</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">leaderboardID</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">defaultLeaderboard</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">leaderboardID</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;leaderboardID not provided in the params. You can also set the default leaderboard in the init method&quot;</span><span class="p">;</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">gamesAPI</span> <span class="o">+</span> <span class="s2">&quot;/players/&quot;</span> <span class="o">+</span> <span class="nx">playerId</span> <span class="o">+</span> <span class="s2">&quot;/leaderboards/&quot;</span> <span class="o">+</span> <span class="nx">leaderboardID</span> <span class="o">+</span> <span class="s2">&quot;/scores/ALL_TIME&quot;</span><span class="p">,</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">items</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">Score</span><span class="p">(</span><span class="nx">playerId</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">scoreValue</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">leaderboard_id</span><span class="p">);</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-286"><td class="docs"><div class="pilwrap"><a href="#section-286" class="pilcrow">&#182;</a></div><p>No score has been submitted yet for the user</p>
</td><td class="code"><div class="highlight"><pre>                    <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="kc">null</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}});</span>

        <span class="p">},</span>

        <span class="nx">submitScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">score</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="kd">var</span> <span class="nx">leaderboardID</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">leaderboardID</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">defaultLeaderboard</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">leaderboardID</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;leaderboardID not provided in the params. You can also set the default leaderboard in the init method&quot;</span><span class="p">;</span>


            <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">gamesAPI</span> <span class="o">+</span> <span class="s2">&quot;/leaderboards/&quot;</span> <span class="o">+</span> <span class="nx">leaderboardID</span> <span class="o">+</span> <span class="s2">&quot;/scores&quot;</span><span class="p">,</span>
                                      <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="nx">params</span><span class="o">:</span><span class="p">{</span><span class="nx">score</span><span class="o">:</span> <span class="nx">score</span><span class="p">},</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>
            <span class="p">}});</span>

        <span class="p">},</span>

        <span class="nx">showLeaderboard</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="kd">var</span> <span class="nx">leaderboardID</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">leaderboardID</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">defaultLeaderboard</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">leaderboardID</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;leaderboardID not provided in the params. You can also set the default leaderboard in the init method&quot;</span><span class="p">;</span>

            <span class="kd">var</span> <span class="nx">ios</span> <span class="o">=</span> <span class="sr">/(iPad|iPhone|iPod)/ig</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span> <span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ios</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">timeScope</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">timeScope</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;showLeaderboard&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">leaderboardID</span><span class="p">,</span> <span class="nx">timeScope</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_leaderboardsTemplate</span><span class="p">)</span>
                    <span class="k">throw</span> <span class="s2">&quot;Please, provide a html template for leaderboards with the setTemplates method&quot;</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">dialog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">WebDialog</span><span class="p">();</span>
                <span class="kd">var</span> <span class="nx">callbackSent</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="nx">dialog</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_leaderboardsTemplate</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">dialog</span><span class="p">.</span><span class="nx">closed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">callbackSent</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">)</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
                <span class="p">});</span>
                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">friends</span> <span class="o">?</span> <span class="s2">&quot;SOCIAL&quot;</span> <span class="o">:</span> <span class="s2">&quot;PUBLIC&quot;</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">timeSpan</span> <span class="o">=</span> <span class="s2">&quot;ALL_TIME&quot;</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">timeScope</span> <span class="o">===</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">TimeScope</span><span class="p">.</span><span class="nx">WEEK</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">timeSpan</span> <span class="o">=</span> <span class="s2">&quot;WEEKLY&quot;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">timeScope</span> <span class="o">===</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">TimeScope</span><span class="p">.</span><span class="nx">TODAY</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">timeSpan</span> <span class="o">=</span> <span class="s2">&quot;DAILY&quot;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">gamesAPI</span> <span class="o">+</span> <span class="s2">&quot;/leaderboards/&quot;</span> <span class="o">+</span> <span class="nx">leaderboardID</span> <span class="o">+</span> <span class="s2">&quot;/window/&quot;</span> <span class="o">+</span> <span class="nx">collection</span><span class="p">,</span>
                    <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="nx">params</span><span class="o">:</span><span class="p">{</span><span class="nx">timeSpan</span><span class="o">:</span> <span class="nx">timeSpan</span><span class="p">},</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">dialog</span><span class="p">.</span><span class="nx">closed</span><span class="p">)</span>
                            <span class="k">return</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">callbackSent</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                                <span class="nx">dialog</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
                            <span class="p">}</span>
                            <span class="k">return</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="kd">var</span> <span class="nx">scores</span> <span class="o">=</span> <span class="p">[];</span>
                        <span class="kd">var</span> <span class="nx">items</span> <span class="o">=</span> <span class="p">[];</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">items</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">playerScore</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">playerScore</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                            <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                            <span class="kd">var</span> <span class="nx">score</span> <span class="o">=</span> <span class="nx">fromGPScoreToCocoonScore</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">leaderboardID</span><span class="p">);</span>
                            <span class="nx">score</span><span class="p">.</span><span class="nx">imageURL</span><span class="o">+=</span><span class="s2">&quot;?sz=50&quot;</span><span class="p">;</span>
                            <span class="nx">score</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">scoreRank</span> <span class="o">||</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
                            <span class="nx">score</span><span class="p">.</span><span class="nx">me</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                            <span class="nx">scores</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">score</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="kd">var</span> <span class="nx">js</span> <span class="o">=</span> <span class="s2">&quot;addScores(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">scores</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
                        <span class="nx">dialog</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span>
                    <span class="p">}});</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-287"><td class="docs"><div class="pilwrap"><a href="#section-287" class="pilcrow">&#182;</a></div><p>internal utility function</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">prepareAchievements</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">reload</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span> <span class="o">||</span> <span class="nx">reload</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">gamesAPI</span> <span class="o">+</span> <span class="s2">&quot;/achievements&quot;</span><span class="p">,</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">achievements</span> <span class="o">=</span> <span class="p">[];</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">achievements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fromGPAchievementToCocoonAchievement</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">setCachedAchievements</span><span class="p">(</span><span class="nx">achievements</span><span class="p">);</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">([],</span> <span class="nx">response</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}});</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">callback</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">requestAllAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">prepareAchievements</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">requestAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">prepareAchievements</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">allAchievements</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callback</span><span class="p">([],</span> <span class="nx">error</span><span class="p">);</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="kd">var</span> <span class="nx">playerID</span> <span class="o">=</span> <span class="nx">userID</span> <span class="o">||</span> <span class="s2">&quot;me&quot;</span><span class="p">;</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="nx">me</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">gamesAPI</span> <span class="o">+</span> <span class="s2">&quot;/players/&quot;</span> <span class="o">+</span> <span class="nx">playerID</span> <span class="o">+</span> <span class="s2">&quot;/achievements&quot;</span><span class="p">,</span>
                                        <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="nx">state</span><span class="o">:</span> <span class="s2">&quot;UNLOCKED&quot;</span><span class="p">},</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">achievements</span> <span class="o">=</span> <span class="p">[];</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                                <span class="kd">var</span> <span class="nx">ach</span> <span class="o">=</span> <span class="nx">me</span><span class="p">.</span><span class="nx">findAchievement</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">id</span><span class="p">);</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">ach</span><span class="p">)</span>
                                    <span class="nx">achievements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">ach</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">([],</span> <span class="nx">response</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}});</span>

            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">submitAchievement</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">achievementID</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">achievementID</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;No achievementID specified&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">achID</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">translateAchievementID</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-288"><td class="docs"><div class="pilwrap"><a href="#section-288" class="pilcrow">&#182;</a></div><p>native API allows to show a native notification view. (REST API doesn't)</p>
</td><td class="code"><div class="highlight"><pre>                <span class="kd">var</span> <span class="nx">showNotification</span> <span class="o">=</span> <span class="o">!!</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">showAchievementNotifications</span><span class="p">;</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;unlockAchievement&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">achID</span><span class="p">,</span> <span class="nx">showNotification</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-289"><td class="docs"><div class="pilwrap"><a href="#section-289" class="pilcrow">&#182;</a></div><p>REST api</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">gamesAPI</span> <span class="o">+</span> <span class="s2">&quot;/achievements/&quot;</span> <span class="o">+</span> <span class="nx">achID</span> <span class="o">+</span> <span class="s2">&quot;/unlock&quot;</span><span class="p">,</span>
                    <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}});</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">resetAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="nx">path</span><span class="o">:</span> <span class="s2">&quot;/games/v1management/achievements/reset&quot;</span><span class="p">,</span>
                <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">:</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}});</span>
        <span class="p">},</span>
        <span class="nx">showAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">ios</span> <span class="o">=</span> <span class="sr">/(iPad|iPhone|iPod)/ig</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span> <span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ios</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gapi</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;showAchievements&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingServiceGooglePlayGames</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">showAchievements</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingServiceGooglePlayGames</span><span class="p">,</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingService</span><span class="p">);</span></pre></div></td></tr><tr id="section-290"><td class="docs"><div class="pilwrap"><a href="#section-290" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@ignore</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">fromGPPlayerToCocoonUser</span> <span class="p">(</span><span class="nx">gpPlayer</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">User</span> <span class="p">(</span><span class="nx">gpPlayer</span><span class="p">.</span><span class="nx">playerId</span><span class="p">,</span> <span class="nx">gpPlayer</span><span class="p">.</span><span class="nx">displayName</span><span class="p">,</span> <span class="nx">gpPlayer</span><span class="p">.</span><span class="nx">avatarImageUrl</span><span class="p">);</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-291"><td class="docs"><div class="pilwrap"><a href="#section-291" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@ignore</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">fromGPPersonToCocoonUser</span> <span class="p">(</span><span class="nx">gpUser</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">avatar</span> <span class="o">=</span> <span class="nx">gpUser</span><span class="p">.</span><span class="nx">image</span> <span class="o">?</span> <span class="nx">gpUser</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">url</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="nx">avatar</span> <span class="o">=</span> <span class="nx">avatar</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/sz=\d+/g</span><span class="p">,</span><span class="s2">&quot;sz=100&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">User</span> <span class="p">(</span><span class="nx">gpUser</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">gpUser</span><span class="p">.</span><span class="nx">displayName</span><span class="p">,</span> <span class="nx">avatar</span><span class="p">);</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-292"><td class="docs"><div class="pilwrap"><a href="#section-292" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@ignore</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">fromImageSizeToGPSize</span> <span class="p">(</span><span class="nx">imageSize</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">imageSize</span> <span class="o">===</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">ImageSize</span><span class="p">.</span><span class="nx">THUMB</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">100</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">imageSize</span> <span class="o">===</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">ImageSize</span><span class="p">.</span><span class="nx">MEDIUM</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">200</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">imageSize</span> <span class="o">===</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">ImageSize</span><span class="p">.</span><span class="nx">LARGE</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">512</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-293"><td class="docs"><div class="pilwrap"><a href="#section-293" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@ignore</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">fromGPAchievementToCocoonAchievement</span><span class="p">(</span><span class="nx">gpItem</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">Achievement</span> <span class="p">(</span>
            <span class="nx">gpItem</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
            <span class="nx">gpItem</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
            <span class="nx">gpItem</span><span class="p">.</span><span class="nx">description</span><span class="p">,</span>
            <span class="nx">gpItem</span><span class="p">.</span><span class="nx">revealedIconUrl</span><span class="p">,</span>
            <span class="mi">0</span>
        <span class="p">);</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">gpAchievementData</span> <span class="o">=</span> <span class="nx">gpItem</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-294"><td class="docs"><div class="pilwrap"><a href="#section-294" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@ignore</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">fromGPScoreToCocoonScore</span><span class="p">(</span><span class="nx">gpItem</span><span class="p">,</span> <span class="nx">leaderboardID</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">Score</span><span class="p">(</span><span class="nx">gpItem</span><span class="p">.</span><span class="nx">player</span><span class="p">.</span><span class="nx">playerId</span><span class="p">,</span> <span class="nx">gpItem</span><span class="p">.</span><span class="nx">scoreValue</span><span class="p">,</span> <span class="nx">gpItem</span><span class="p">.</span><span class="nx">player</span><span class="p">.</span><span class="nx">displayName</span><span class="p">,</span> <span class="nx">gpItem</span><span class="p">.</span><span class="nx">player</span><span class="p">.</span><span class="nx">avatarImageUrl</span><span class="p">,</span> <span class="nx">leaderboardID</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});</span>
<span class="p">;</span><span class="cm">/**</span>
<span class="cm"> * This namespace represents all the basic functionalities available in the CocoonJS extension API.</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm"> *   Here you will find a demo about this namespace: &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/Multiplayer&quot;&gt;Multiplayer demo&lt;/a&gt;.</span>
<span class="cm"> *&lt;/div&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-warning&quot;&gt;</span>
<span class="cm"> *    &lt;strong&gt;Warning!&lt;/strong&gt; This JavaScript extension requires some configuration parameters on the &lt;a href=&quot;https://ludei.zendesk.com/hc/en-us&quot;&gt;cloud compiler&lt;/a&gt;!</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> * @namespace Cocoon.Social.GameCenter</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Social&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenterExtension</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span> <span class="o">=</span> <span class="s2">&quot;IDTK_SRV_GAMECENTER&quot;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span> <span class="o">=</span> <span class="s2">&quot;Social.GameCenter&quot;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span>  <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">]);</span>

        <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">onGameCenterLoginStateChanged</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="s2">&quot;onGameCenterLoginStateChanged&quot;</span><span class="p">);</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">onGameCenterLoginStateChanged</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">localPlayer</span><span class="p">,</span><span class="nx">error</span><span class="p">){</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">_currentPlayer</span> <span class="o">=</span> <span class="nx">localPlayer</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenterExtension</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">_currentPlayer</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></pre></div></td></tr><tr id="section-295"><td class="docs"><div class="pilwrap"><a href="#section-295" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This namespace represents all the basic functionalities available in the CocoonJS extension API.</p>

<div class="alert alert-warning">
   <strong>Warning!</strong> This JavaScript extension requires some configuration parameters on the <a href="https://ludei.zendesk.com/hc/en-us">cloud compiler</a>!.
</div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-296"><td class="docs"><div class="pilwrap"><a href="#section-296" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns a Cocoon Social Interface for the Game Center Extension.<br />You can use the Game Center extension in two ways, with 1:1 official API equivalent or with the CocoonJS API abstraction.</p></div><div class="details"><div class="dox_tag_title">See</div><div class="dox_tag_detail"><span class="dox_type">Cocoon.Social.Interface</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getSocialInterface</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_socialService</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_socialService</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingServiceGameCenter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_socialService</span><span class="p">;</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-297"><td class="docs"><div class="pilwrap"><a href="#section-297" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns a Cocoon Multiplayer interface for the Game Center Service.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getMultiplayerInterface</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">isLoggedIn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_currentPlayer</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_currentPlayer</span><span class="p">.</span><span class="nx">isAuthenticated</span><span class="p">;</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-298"><td class="docs"><div class="pilwrap"><a href="#section-298" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Authenticates the user.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">login</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;login&quot;</span><span class="p">,</span> <span class="p">[</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">_currentPlayer</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span><span class="nx">error</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-299"><td class="docs"><div class="pilwrap"><a href="#section-299" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Synchronous accessor for the current authResponse.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getLocalPlayer</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_currentPlayer</span><span class="p">)</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_currentPlayer</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_currentPlayer</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;getLocalPlayer&quot;</span><span class="p">,</span> <span class="p">[]);</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_currentPlayer</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-300"><td class="docs"><div class="pilwrap"><a href="#section-300" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Loads the players of the provided identifiers.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>playerIDs </span><span class="dox_type">array</span><span>- Array of player identifiers.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">loadPlayers</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">playerIDs</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;loadPlayers&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">playerIDs</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-301"><td class="docs"><div class="pilwrap"><a href="#section-301" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Loads the friends of the current logged in user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">loadFriends</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;loadFriends&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-302"><td class="docs"><div class="pilwrap"><a href="#section-302" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Loads the earned achievements for the current logged in user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">loadAchievements</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;loadAchievements&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-303"><td class="docs"><div class="pilwrap"><a href="#section-303" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Loads the application achievement descriptions.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">loadAchievementDescriptions</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;loadAchievementDescriptions&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-304"><td class="docs"><div class="pilwrap"><a href="#section-304" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Load the application achievement descriptions.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. It receives the following parameters: </span></div><div class="dox_tag_detail"><span>[query] </span><span class="dox_type">Cocoon.Social.GameCenter.Leaderboard</span><span>- Optional query parameters.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">loadScores</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">query</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;loadScores&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">query</span><span class="p">,</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-305"><td class="docs"><div class="pilwrap"><a href="#section-305" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Report user score to the server.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>score </span><span class="dox_type">Cocoon.Social.GameCenter.Score</span><span>- Definition of the score and it's category (leaderboardID).</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. Response params: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">submitScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">score</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;submitScore&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">score</span><span class="p">,</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-306"><td class="docs"><div class="pilwrap"><a href="#section-306" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Reports user earned achievements to the server.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>achievements </span><span class="dox_type">array</span><span>- - Array of {@link Cocoon.Social.GameCenter.Achievement} objects.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function. Response params: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">submitAchievements</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;submitAchievements&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">achievements</span><span class="p">,</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-307"><td class="docs"><div class="pilwrap"><a href="#section-307" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Resets all the achievements of the current logged in user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>[callback] </span><span class="dox_type">function</span><span>- The callback function. Response params: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">resetAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;resetAchievements&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-308"><td class="docs"><div class="pilwrap"><a href="#section-308" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows a native view with the standard user interface for achievements.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function when the view is closed by the user. Response params: error</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">showAchievements</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;showAchievements&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-309"><td class="docs"><div class="pilwrap"><a href="#section-309" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows a native view with the standard user interface for leaderboards.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function when the view is closed by the user. Response params: error</span></div><div class="dox_tag_detail"><span>[query] </span><span class="dox_type">Cocoon.Social.GameCenter.Leaderboard</span><span>- Optional parameters</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">showLeaderboards</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">query</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;showLeaderboards&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">query</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;Game Center not available&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenterExtension</span><span class="p">();</span></pre></div></td></tr><tr id="section-310"><td class="docs"><div class="pilwrap"><a href="#section-310" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents the information of a Game Center player.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">Player</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">playerID</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">alias</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">isFriend</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-311"><td class="docs"><div class="pilwrap"><a href="#section-311" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents the information of a Game Center local player.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">LocalPlayer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">playerID</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">alias</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">isAuthenticated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-312"><td class="docs"><div class="pilwrap"><a href="#section-312" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents an earned achievement by the user.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">Achievement</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">identifier</span><span class="p">,</span> <span class="nx">percentComplete</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">identifier</span> <span class="o">=</span> <span class="nx">identifier</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">percentComplete</span> <span class="o">=</span> <span class="nx">percentComplete</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">lastReportedDate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-313"><td class="docs"><div class="pilwrap"><a href="#section-313" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents an earned achievement by the user.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">AchievementDescription</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">identifier</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">achievedDescription</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">unachievedDescription</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">maximumPoints</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-314"><td class="docs"><div class="pilwrap"><a href="#section-314" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents a score in the leaderboards.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">Score</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">userID</span><span class="p">,</span> <span class="nx">score</span><span class="p">,</span> <span class="nx">userName</span><span class="p">,</span> <span class="nx">imageURL</span><span class="p">,</span> <span class="nx">leaderboardID</span><span class="p">,</span> <span class="nx">originalScoreObject</span><span class="p">)</span>
    <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">userID</span> <span class="o">=</span> <span class="nx">userID</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">score</span> <span class="o">=</span> <span class="nx">score</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">userName</span> <span class="o">=</span> <span class="nx">userName</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">imageURL</span> <span class="o">=</span> <span class="nx">imageURL</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">leaderboardID</span> <span class="o">=</span> <span class="nx">leaderboardID</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">rank</span> <span class="o">=</span> <span class="nx">originalScoreObject</span><span class="p">.</span><span class="nx">rank</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">originalScoreObject</span> <span class="o">=</span> <span class="nx">originalScoreObject</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-315"><td class="docs"><div class="pilwrap"><a href="#section-315" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents the set of high scores for the current game.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">Leaderboard</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">category</span><span class="p">,</span> <span class="nx">playerIDs</span><span class="p">,</span> <span class="nx">timeScope</span><span class="p">,</span> <span class="nx">playerScope</span><span class="p">,</span> <span class="nx">rangeStart</span><span class="p">,</span> <span class="nx">rangeLength</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">category</span> <span class="o">=</span> <span class="nx">category</span><span class="p">;</span>
       
        <span class="k">this</span><span class="p">.</span><span class="nx">playerIDs</span> <span class="o">=</span> <span class="nx">playerIDs</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">timeScope</span> <span class="o">=</span> <span class="nx">timeScope</span><span class="p">;</span>
    
        <span class="k">this</span><span class="p">.</span><span class="nx">playerScope</span> <span class="o">=</span> <span class="nx">playerScope</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">rangeStart</span> <span class="o">=</span> <span class="nx">rangeStart</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">rangeLength</span> <span class="o">=</span> <span class="nx">rangeLength</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">scores</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">localPlayerScore</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">localizedTitle</span> <span class="o">=</span> <span class="nx">localizedTitle</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-316"><td class="docs"><div class="pilwrap"><a href="#section-316" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object represents the possible Time Scopes for a leaderboard query.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">TimeScope</span> <span class="o">=</span>
    <span class="p">{</span>
        <span class="nx">TODAY</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">WEEK</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">ALL_TIME</span><span class="o">:</span><span class="mi">2</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-317"><td class="docs"><div class="pilwrap"><a href="#section-317" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object represents the possible Player Scopes for a leaderboad query.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">PlayerScope</span> <span class="o">=</span>
    <span class="p">{</span>
        <span class="nx">GLOBAL</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">FRIENDS</span><span class="o">:</span> <span class="mi">1</span>
    <span class="p">};</span></pre></div></td></tr><tr id="section-318"><td class="docs"><div class="pilwrap"><a href="#section-318" class="pilcrow">&#182;</a></div><p>Social API Interface</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingServiceGameCenter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">gcExtension</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingServiceGameCenter</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">gc</span> <span class="o">=</span> <span class="nx">gcExtension</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">onGameCenterLoginStateChanged</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">localPlayer</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
            <span class="nx">me</span><span class="p">.</span><span class="nx">onLoginStatusChanged</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">localPlayer</span><span class="p">.</span><span class="nx">isAuthenticated</span><span class="p">,</span><span class="nx">error</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingServiceGameCenter</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span>  <span class="p">{</span>

        <span class="nx">_cachedAchievements</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

        <span class="nx">isLoggedIn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">();</span>
        <span class="p">},</span>
        <span class="nx">login</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">localPlayer</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">localPlayer</span><span class="p">.</span><span class="nx">isAuthenticated</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">logout</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;User has to logout from the Game Center APP&quot;</span><span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">getLoggedInUser</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">fromGCPLayerToCocoonUser</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">_currentPlayer</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">_currentPlayer</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">getLocalPlayer</span><span class="p">());</span>
        <span class="p">},</span>

        <span class="nx">requestUser</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userId</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">userId</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">loadPlayers</span><span class="p">([</span><span class="nx">userId</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">fromGCPLayerToCocoonUser</span><span class="p">(</span><span class="nx">response</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
                <span class="p">});</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">getLoggedInUser</span><span class="p">());</span>
                <span class="p">})</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">requestFriends</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userId</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">loadFriends</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">friends</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                <span class="kd">var</span> <span class="nx">users</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">friends</span> <span class="o">&amp;&amp;</span> <span class="nx">friends</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">friends</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">users</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fromGCPLayerToCocoonUser</span><span class="p">(</span><span class="nx">friends</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="nx">callback</span><span class="p">(</span><span class="nx">users</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">requestScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">leaderboardID</span><span class="p">)</span>
                <span class="nx">query</span><span class="p">.</span><span class="nx">category</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">leaderboardID</span><span class="p">;</span>
            <span class="nx">query</span><span class="p">.</span><span class="nx">playerIDs</span> <span class="o">=</span> <span class="p">[</span><span class="nx">options</span><span class="p">.</span><span class="nx">userID</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLoggedInUser</span><span class="p">().</span><span class="nx">userID</span><span class="p">];</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">loadScores</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">gcScore</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">userID</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">scores</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">scores</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
                    <span class="nx">gcScore</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">scores</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">localPlayerScore</span><span class="p">)</span>
                    <span class="nx">gcScore</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">localPlayerScore</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">loadedScore</span> <span class="o">=</span> <span class="nx">gcScore</span> <span class="o">?</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">Score</span><span class="p">(</span><span class="nx">gcScore</span><span class="p">.</span><span class="nx">playerID</span><span class="p">,</span> <span class="nx">gcScore</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">gcScore</span><span class="p">.</span><span class="nx">category</span><span class="p">,</span> <span class="nx">gcScore</span><span class="p">)</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">callback</span><span class="p">(</span><span class="nx">loadedScore</span><span class="p">,</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">},</span> <span class="nx">query</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">submitScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">score</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">submitScore</span><span class="p">({</span><span class="nx">value</span><span class="o">:</span><span class="nx">score</span><span class="p">,</span> <span class="nx">category</span><span class="o">:</span><span class="nx">options</span><span class="p">.</span><span class="nx">leaderboardID</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">showLeaderboard</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">showLeaderboards</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">},</span> <span class="p">{</span><span class="nx">category</span><span class="o">:</span><span class="nx">options</span><span class="p">.</span><span class="nx">leaderboardID</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-319"><td class="docs"><div class="pilwrap"><a href="#section-319" class="pilcrow">&#182;</a></div><p>internal utility function</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">prepareAchievements</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">reload</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span> <span class="o">||</span> <span class="nx">reload</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">loadAchievementDescriptions</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">([],</span><span class="nx">error</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                       <span class="kd">var</span> <span class="nx">achievements</span> <span class="o">=</span> <span class="p">[];</span>
                       <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                           <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                               <span class="nx">achievements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fromGCAchievementDescriptionToCocoonAchievement</span><span class="p">(</span><span class="nx">response</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span>
                           <span class="p">}</span>
                       <span class="p">}</span>
                       <span class="nx">me</span><span class="p">.</span><span class="nx">setCachedAchievements</span><span class="p">(</span><span class="nx">achievements</span><span class="p">);</span>
                       <span class="nx">callback</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>

                <span class="p">});</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">callback</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">requestAllAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">prepareAchievements</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">requestAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">prepareAchievements</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">allAchievements</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callback</span><span class="p">([],</span> <span class="nx">error</span><span class="p">);</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">loadAchievements</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">achievements</span> <span class="o">=</span> <span class="p">[];</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                                <span class="kd">var</span> <span class="nx">ach</span> <span class="o">=</span> <span class="nx">me</span><span class="p">.</span><span class="nx">findAchievement</span><span class="p">(</span><span class="nx">response</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">identifier</span><span class="p">);</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">ach</span><span class="p">)</span>
                                    <span class="nx">achievements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">ach</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">([],</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                    <span class="p">}</span>

                <span class="p">});</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">submitAchievement</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">achievementID</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">achievementID</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;No achievementID specified&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">achID</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">translateAchievementID</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">submitAchievements</span><span class="p">([{</span><span class="nx">identifier</span><span class="o">:</span><span class="nx">achID</span><span class="p">,</span> <span class="nx">percentComplete</span><span class="o">:</span><span class="mi">100</span><span class="p">}],</span> <span class="nx">callback</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">resetAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">resetAchievements</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">showAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">gc</span><span class="p">.</span><span class="nx">showAchievements</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingServiceGameCenter</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingService</span><span class="p">);</span>


    <span class="kd">function</span> <span class="nx">fromGCPLayerToCocoonUser</span><span class="p">(</span><span class="nx">player</span><span class="p">){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">User</span><span class="p">(</span><span class="nx">player</span><span class="p">.</span><span class="nx">playerID</span><span class="p">,</span> <span class="nx">player</span><span class="p">.</span><span class="nx">alias</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">fromGCAchievementDescriptionToCocoonAchievement</span><span class="p">(</span><span class="nx">ach</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">GameCenter</span><span class="p">.</span><span class="nx">Achievement</span><span class="p">(</span><span class="nx">ach</span><span class="p">.</span><span class="nx">identifier</span><span class="p">,</span><span class="nx">ach</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="nx">ach</span><span class="p">.</span><span class="nx">achievedDescription</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">ach</span><span class="p">.</span><span class="nx">maximumPoints</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});</span>
<span class="p">;</span><span class="cm">/**</span>
<span class="cm"> * This namespace represents all the basic functionalities available in the CocoonJS extension API.</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm"> *   Here you will find a demo about this namespace: &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/Facebook&quot;&gt;Facebook demo&lt;/a&gt;.</span>
<span class="cm"> *&lt;/div&gt;</span>
<span class="cm"> * </span>
<span class="cm"> * &lt;div class=&quot;alert alert-warning&quot;&gt;</span>
<span class="cm"> *    &lt;strong&gt;Warning!&lt;/strong&gt; This JavaScript extension requires some configuration parameters on the &lt;a href=&quot;https://ludei.zendesk.com/hc/en-us&quot;&gt;cloud compiler&lt;/a&gt;!</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> * @namespace Cocoon.Social.Facebook</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Social&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">FacebookExtension</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span> <span class="o">=</span> <span class="s2">&quot;IDTK_SRV_FACEBOOK&quot;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span> <span class="o">=</span> <span class="s2">&quot;Social.Facebook&quot;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span>  <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">]);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">Event</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">FacebookEvent</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">onFacebookSessionStateChanged</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="s2">&quot;onFacebookSessionStateChanged&quot;</span><span class="p">);</span>

            <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">Facebook</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> <span class="c1">//the object it&#39;s being created but the addEventListener needs it now</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">onFacebookSessionStateChanged</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">session</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">fromCocoonFBSessionToFBAPISession</span><span class="p">(</span><span class="nx">session</span><span class="p">,</span><span class="nx">error</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">session</span><span class="p">.</span><span class="nx">state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s2">&quot;auth.login&quot;</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s2">&quot;auth.authResponseChange&quot;</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s2">&quot;auth.statusChange&quot;</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">FacebookExtension</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">_currentSession</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">_appId</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">_socialService</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></pre></div></td></tr><tr id="section-320"><td class="docs"><div class="pilwrap"><a href="#section-320" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Initializes the SDK with your app ID. This will let you make calls against the Facebook API. All FB.API methods must be called after FB.init.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>options </span><span class="dox_type">object</span><span>- Check available options here: https://developers.facebook.com/docs/reference/javascript/FB.init/</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span> <span class="o">||</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">appId</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;appId must be specified!&quot;</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">_appId</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">appId</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;init&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">options</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s2">&quot;auth.authResponseChange&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">session</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">_currentSession</span> <span class="o">=</span> <span class="nx">session</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">session</span><span class="p">.</span><span class="nx">authResponse</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">session</span><span class="p">.</span><span class="nx">authResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">){</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="s2">&quot;me?fields=username&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">_currentSession</span><span class="p">.</span><span class="nx">authResponse</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
                    <span class="p">});</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-321"><td class="docs"><div class="pilwrap"><a href="#section-321" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Returns a Cocoon SocialGaming interface for the Facebook Extension.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getSocialInterface</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_appId</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="s2">&quot;You must call init() before getting the Social Interface&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_socialService</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_socialService</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingServiceFacebook</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_socialService</span><span class="p">;</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-322"><td class="docs"><div class="pilwrap"><a href="#section-322" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Authenticates the user.<br />By default, calling login will attempt to authenticate the user with only the basic permissions.<br />If you want one or more additional permissions, call login with an option object,<br />and set the scope parameter with a comma-separated list of the permissions you wish to request from the user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>options </span><span class="dox_type">object</span><span>- Login options.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">login</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;login&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">options</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">_currentSession</span> <span class="o">=</span> <span class="nx">fromCocoonFBSessionToFBAPISession</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span><span class="nx">error</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">_currentSession</span><span class="p">);</span>
                    <span class="p">}</span>

                <span class="p">}],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">_currentSession</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
                <span class="p">},</span> <span class="nx">options</span><span class="p">);</span>
            <span class="p">}</span>

        <span class="p">},</span></pre></div></td></tr><tr id="section-323"><td class="docs"><div class="pilwrap"><a href="#section-323" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Logs the user out of your application.<br />You will need to have a valid access token for the user in order to call the function.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- Called when the user is logged out.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">logout</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;logout&quot;</span><span class="p">,</span> <span class="p">[</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">fromCocoonFBSessionToFBAPISession</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">));</span>
                    <span class="p">}</span>

                <span class="p">}],</span><span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">logout</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">});</span>
            <span class="p">}</span>

        <span class="p">},</span></pre></div></td></tr><tr id="section-324"><td class="docs"><div class="pilwrap"><a href="#section-324" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Synchronous accessor for the current authResponse.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getAuthResponse</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;getFacebookSession&quot;</span><span class="p">,</span> <span class="p">[]);</span>
                <span class="k">return</span> <span class="nx">fromCocoonFBSessionToFBAPISession</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">FB</span><span class="p">.</span><span class="nx">getAuthResponse</span><span class="p">();</span>
            <span class="p">}</span>

        <span class="p">},</span></pre></div></td></tr><tr id="section-325"><td class="docs"><div class="pilwrap"><a href="#section-325" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows you to determine if a user is logged in to Facebook and has authenticated your app.</p>

<h2>There are three possible states for a user</h2>

<ol>
<li>The user is logged into Facebook and has authenticated your application (connected).</li>
<li>The user is logged into Facebook but has not authenticated your application (not_authorized).</li>
<li>The user is not logged into Facebook at this time and so we don't know if they've authenticated your application or not.</li>
</ol></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">function</span><span>- The callback function.</span></div><div class="dox_tag_detail"><span>force </span><span class="dox_type">boolean</span><span>- Force reloading the login status (default false).</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getLoginStatus</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">force</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>

                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
                    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;getFacebookSession&quot;</span><span class="p">,</span> <span class="p">[]);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">fromCocoonFBSessionToFBAPISession</span><span class="p">(</span><span class="nx">response</span><span class="p">));</span>
                    <span class="p">}</span>

                <span class="p">},</span><span class="mi">50</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">getLoginStatus</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">force</span><span class="p">);</span>
            <span class="p">}</span>

        <span class="p">},</span></pre></div></td></tr><tr id="section-326"><td class="docs"><div class="pilwrap"><a href="#section-326" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Makes API calls to the Graph API.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">path</span><span>- Graph API url path.</span></div><div class="dox_tag_detail"><span>The </span><span class="dox_type">method</span><span>- http method (default &quot;GET&quot;).</span></div><div class="dox_tag_detail"><span>The </span><span class="dox_type">params</span><span>- parameters for the query.</span></div><div class="dox_tag_detail"><span>The </span><span class="dox_type">cb</span><span>- callback function to handle the response.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">api</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">cb</span> <span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">openGraph</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">httpMethod</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="o">?</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">callback</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span><span class="mi">1</span> <span class="p">]</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){};</span>

                <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">openGraph</span><span class="p">,</span> <span class="nx">httpMethod</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span><span class="nx">method</span><span class="p">,</span><span class="nx">params</span><span class="p">,</span><span class="nx">cb</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-327"><td class="docs"><div class="pilwrap"><a href="#section-327" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>A generic method for triggering Dialogs which allow the user to take some action.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">params</span><span>- required arguments vary based on the method being used, but specifying the method itself is mandatory.</span></div><div class="dox_tag_detail"><span>Callback </span><span class="dox_type">cb</span><span>- function to handle the result. Not all methods may have a response.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">ui</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">){</span>
                <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">callback</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){};</span>

                <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;ui&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">params</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">ui</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span><span class="nx">cb</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-328"><td class="docs"><div class="pilwrap"><a href="#section-328" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows you to ask additional permission from the current ones.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>permissionsType </span><span class="dox_type">string</span><span>- &quot;read&quot; or &quot;publish&quot;.</span></div><div class="dox_tag_detail"><span>Comma </span><span class="dox_type">permissions</span><span>- separated Facebook permission names.</span></div><div class="dox_tag_detail"><span>Response </span><span class="dox_type">callback</span><span>- authResponse callback.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">requestAdditionalPermissions</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">permissionsType</span><span class="p">,</span> <span class="nx">permissions</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>

                <span class="kd">var</span> <span class="nx">permsArray</span> <span class="o">=</span> <span class="nx">permissions</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">);</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;requestAdditionalPermissions&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">permissionsType</span><span class="p">,</span> <span class="nx">permsArray</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">session</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">fromCocoonFBSessionToFBAPISession</span><span class="p">(</span><span class="nx">session</span><span class="p">,</span><span class="nx">error</span><span class="p">));</span>
                    <span class="p">}</span>
                <span class="p">}],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="p">{</span><span class="nx">scope</span><span class="o">:</span><span class="nx">permissions</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-329"><td class="docs"><div class="pilwrap"><a href="#section-329" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Queries Facebook permissions of the current user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>Handler </span><span class="dox_type">callback</span><span>- function which receives a dictionary with the granted permissions.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getPermissions</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="s1">&#39;me/permissions&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
                <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span> <span class="o">:</span> <span class="p">[];</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">status</span> <span class="o">===</span> <span class="s2">&quot;granted&quot;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">result</span><span class="p">[</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">permission</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="nx">callback</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-330"><td class="docs"><div class="pilwrap"><a href="#section-330" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Presents a dialog in the Facebook application that allows the user to share a status update.<br />If the Facebook Application is not available it does a fallback to a feed dialog.<br />No publish permissions are required.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>Dialog </span><span class="dox_type">params</span><span>- params (description, caption, name, link, picture).</span></div><div class="dox_tag_detail"><span>Handler </span><span class="dox_type">callback</span><span>- with response data or error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">showShareDialog</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;showShareDialog&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">params</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">params</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="s2">&quot;feed&quot;</span><span class="p">;</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">ui</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-331"><td class="docs"><div class="pilwrap"><a href="#section-331" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Upload a local image file to Facebook and get response.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">file</span><span>- local file url to submit to Facebook (For example the one capture with screenCapture API).</span></div><div class="dox_tag_detail"><span>Handler </span><span class="dox_type">callback</span><span>- to process response with the photoid and other data or the error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">uploadPhoto</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;uploadPhoto&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">file</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-332"><td class="docs"><div class="pilwrap"><a href="#section-332" class="pilcrow">&#182;</a></div><p>TODO</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">callback</span><span class="p">({</span><span class="nx">error</span><span class="o">:</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span> <span class="s2">&quot;Not implemented&quot;</span><span class="p">}});</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-333"><td class="docs"><div class="pilwrap"><a href="#section-333" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Shows a native UI component that can be used to pick friends.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>Handler </span><span class="dox_type">callback</span><span>- function. The response contains the boolen 'donePressed' value and an array of selected users in the 'selection' property.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">showFriendPicker</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;showFriendPicker&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-334"><td class="docs"><div class="pilwrap"><a href="#section-334" class="pilcrow">&#182;</a></div><p>TODO</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">callback</span><span class="p">({</span><span class="nx">error</span><span class="o">:</span> <span class="p">{</span><span class="nx">message</span><span class="o">:</span> <span class="s2">&quot;Not implemented&quot;</span><span class="p">}});</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">FacebookEvent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="nx">nativeAvailable</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">FacebookEvent</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span></pre></div></td></tr><tr id="section-335"><td class="docs"><div class="pilwrap"><a href="#section-335" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><h2>Global Events to which you can subscribe</h2>

<p>auth.login - fired when the auth status changes from unknown to connected.<br />auth.authResponseChange - fired when the authResponse changes.<br />auth.statusChange - fired when the status changes.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>Name </span><span class="dox_type">name</span><span>- of the event.</span></div><div class="dox_tag_detail"><span>The </span><span class="dox_type">callback</span><span>- handler function.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">subscribe</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">eventKey</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;listeners&#39;</span><span class="p">;</span>
                <span class="k">this</span><span class="p">[</span><span class="nx">eventKey</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">eventKey</span><span class="p">]</span> <span class="o">||</span> <span class="p">[];</span>
                <span class="k">this</span><span class="p">[</span><span class="nx">eventKey</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="nx">callback</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-336"><td class="docs"><div class="pilwrap"><a href="#section-336" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Removes handlers on events so it no longer invokes your callback when the event fires.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>Name </span><span class="dox_type">name</span><span>- of the event.</span></div><div class="dox_tag_detail"><span>The </span><span class="dox_type">callback</span><span>- handler function.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">unsubscribe</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">eventKey</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;listeners&#39;</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">eventKey</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">array</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nx">FB</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="nx">callback</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">notify</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">eventKey</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;listeners&#39;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">eventKey</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">](</span><span class="nx">param</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">Facebook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">FacebookExtension</span><span class="p">();</span>

    <span class="kd">function</span> <span class="nx">fromCocoonFBStatusToFBAPIState</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s2">&quot;connected&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s2">&quot;not_authorized&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">fromCocoonFBSessionToFBAPISession</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">authResponse</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">state</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">authResponse</span> <span class="o">=</span> <span class="p">{</span>
                <span class="nx">accessToken</span><span class="o">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">accessToken</span><span class="p">,</span>
                <span class="nx">expirationDate</span><span class="o">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">expirationDate</span><span class="p">,</span>
                <span class="nx">userID</span><span class="o">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">user</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">userID</span> <span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
                <span class="nx">permissions</span><span class="o">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">permissions</span><span class="p">,</span>
                <span class="nx">user</span><span class="o">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">user</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">status</span><span class="o">:</span> <span class="nx">fromCocoonFBStatusToFBAPIState</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">state</span><span class="p">),</span>
            <span class="nx">authResponse</span><span class="o">:</span> <span class="nx">authResponse</span><span class="p">,</span>
            <span class="nx">error</span><span class="o">:</span> <span class="nx">error</span>
        <span class="p">}</span>

    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingServiceFacebook</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fbExtension</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">SocialGamingServiceFacebook</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fb</span> <span class="o">=</span> <span class="nx">fbExtension</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s2">&quot;auth.authResponseChange&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">session</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">me</span><span class="p">.</span><span class="nx">onLoginStatusChanged</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">session</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="s2">&quot;connected&quot;</span><span class="p">,</span> <span class="nx">session</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingServiceFacebook</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span>  <span class="p">{</span>

        <span class="nx">currentPermissions</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

        <span class="nx">isLoggedIn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">_currentSession</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">_currentSession</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="s2">&quot;connected&quot;</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">login</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">(),</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">},</span> <span class="nx">options</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">logout</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">logout</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">getLoggedInUser</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">authResponse</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">_currentSession</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">_currentSession</span><span class="p">.</span><span class="nx">authResponse</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">authResponse</span> <span class="o">&amp;&amp;</span> <span class="nx">authResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">fromFBUserToCocoonUser</span><span class="p">(</span><span class="nx">authResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">authResponse</span> <span class="o">&amp;&amp;</span> <span class="nx">authResponse</span><span class="p">.</span><span class="nx">userID</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">Facebook</span><span class="p">.</span><span class="nx">User</span><span class="p">(</span><span class="nx">authResponse</span><span class="p">.</span><span class="nx">userID</span><span class="p">,</span> <span class="s2">&quot;Loading...&quot;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">hasPublishPermissions</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">getPermissions</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">perms</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
               <span class="nx">callback</span><span class="p">(</span><span class="nx">perms</span><span class="p">.</span><span class="nx">publish_actions</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">requestPublishPermissions</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">requestAdditionalPermissions</span><span class="p">(</span><span class="s2">&quot;publish&quot;</span><span class="p">,</span> <span class="s2">&quot;publish_actions&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">hasPublishPermissions</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">granted</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">granted</span><span class="p">,</span><span class="nx">error</span><span class="p">);</span>
                    <span class="p">});</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">requestUser</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">calback</span><span class="p">,</span> <span class="nx">userId</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">apiCall</span> <span class="o">=</span> <span class="p">(</span><span class="nx">userId</span> <span class="o">||</span> <span class="s2">&quot;me&quot;</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="nx">apiCall</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>  
                <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="nx">fromFBUserToCocoonUser</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
                <span class="nx">calback</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">requestUserImage</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">,</span> <span class="nx">imageSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">userID</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">())</span> <span class="p">{</span>
                <span class="nx">userID</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">_currentSession</span><span class="p">.</span><span class="nx">authResponse</span><span class="p">.</span><span class="nx">userID</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">fbPictureSize</span> <span class="o">=</span> <span class="s2">&quot;small&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">imageSize</span> <span class="o">===</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">ImageSize</span><span class="p">.</span><span class="nx">THUMB</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">fbPictureSize</span> <span class="o">=</span> <span class="s2">&quot;square&quot;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">imageSize</span> <span class="o">===</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">ImageSize</span><span class="p">.</span><span class="nx">MEDIUM</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">fbPictureSize</span> <span class="o">=</span> <span class="s2">&quot;normal&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">imageSize</span> <span class="o">===</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">ImageSize</span><span class="p">.</span><span class="nx">LARGE</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">fbPictureSize</span> <span class="o">=</span> <span class="s2">&quot;large&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">&quot;https://graph.facebook.com/&quot;</span> <span class="o">+</span> <span class="nx">userID</span> <span class="o">+</span> <span class="s2">&quot;/picture?type=&quot;</span> <span class="o">+</span> <span class="nx">fbPictureSize</span><span class="p">;</span>
            <span class="nx">callback</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">requestFriends</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userId</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">apiCall</span> <span class="o">=</span> <span class="p">(</span><span class="nx">userId</span> <span class="o">||</span> <span class="s2">&quot;me&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/friends&quot;</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="nx">apiCall</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
                <span class="kd">var</span> <span class="nx">friends</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="nx">friends</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fromFBUserToCocoonUser</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="nx">callback</span><span class="p">(</span><span class="nx">friends</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-337"><td class="docs"><div class="pilwrap"><a href="#section-337" class="pilcrow">&#182;</a></div><p>internal utility function</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">preparePublishAction</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">currentPermissions</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">getPermissions</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">perms</span><span class="p">){</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">currentPermissions</span> <span class="o">=</span> <span class="nx">perms</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">perms</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">preparePublishAction</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">});</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">currentPermissions</span><span class="p">.</span><span class="nx">publish_actions</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">callback</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span><span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">currentPermissions</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentPermissions</span> <span class="o">|</span> <span class="p">{};</span>
                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">requestAdditionalPermissions</span><span class="p">(</span><span class="s2">&quot;publish&quot;</span><span class="p">,</span> <span class="s2">&quot;publish_actions&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">perms</span> <span class="o">=</span> <span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">authResponse</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">authResponse</span><span class="p">.</span><span class="nx">permissions</span> <span class="o">:</span> <span class="p">[];</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">perms</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">currentPermissions</span><span class="p">[</span><span class="nx">perms</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="kc">true</span><span class="p">);</span>
                <span class="p">});</span>
            <span class="p">}</span>

        <span class="p">},</span>
        <span class="nx">publishMessage</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">preparePublishAction</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">granted</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">granted</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="nx">fromCocoonMessageToFBMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
                    <span class="kd">var</span> <span class="nx">apiCall</span> <span class="o">=</span> <span class="s2">&quot;me/feed&quot;</span><span class="p">;</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="nx">apiCall</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                            <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                    <span class="p">});</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                        <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span> <span class="s2">&quot;No publish_actions permission granted&quot;</span><span class="p">});</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">},</span>

        <span class="nx">publishMessageWithDialog</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">showShareDialog</span><span class="p">(</span><span class="nx">fromCocoonMessageToFBMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
                 <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                 <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">},</span>

        <span class="nx">requestScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">apiCall</span> <span class="o">=</span> <span class="p">((</span><span class="nx">params</span> <span class="o">&amp;&amp;</span> <span class="nx">params</span><span class="p">.</span><span class="nx">userID</span><span class="p">)</span> <span class="o">?</span> <span class="nx">params</span><span class="p">.</span><span class="nx">userID</span> <span class="o">:</span> <span class="s2">&quot;me&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/scores&quot;</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="nx">apiCall</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">fromFBScoreToCocoonScore</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-338"><td class="docs"><div class="pilwrap"><a href="#section-338" class="pilcrow">&#182;</a></div><p>No score has been submitted yet for the user</p>
</td><td class="code"><div class="highlight"><pre>                    <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="kc">null</span><span class="p">);</span>
                <span class="p">}</span>

            <span class="p">});</span>
        <span class="p">},</span>

        <span class="nx">submitScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">score</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">preparePublishAction</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">granted</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">granted</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">requestScore</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">currentScore</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-339"><td class="docs"><div class="pilwrap"><a href="#section-339" class="pilcrow">&#182;</a></div><p>can't get the user top score. Don't send the new one because it might be worse than the top score</p>
</td><td class="code"><div class="highlight"><pre>                            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                                <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
                           <span class="k">return</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="kd">var</span> <span class="nx">topScore</span> <span class="o">=</span> <span class="nx">currentScore</span> <span class="o">?</span> <span class="nx">currentScore</span><span class="p">.</span><span class="nx">score</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">score</span> <span class="o">&lt;=</span> <span class="nx">topScore</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-340"><td class="docs"><div class="pilwrap"><a href="#section-340" class="pilcrow">&#182;</a></div><p>don't submit the new score because a better score is already submitted</p>
</td><td class="code"><div class="highlight"><pre>                            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                                <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
                            <span class="k">return</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="kd">var</span> <span class="nx">apiCall</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="p">((</span><span class="nx">params</span> <span class="o">&amp;&amp;</span> <span class="nx">params</span><span class="p">.</span><span class="nx">userID</span><span class="p">)</span> <span class="o">?</span> <span class="nx">params</span><span class="p">.</span><span class="nx">userID</span> <span class="o">:</span> <span class="s2">&quot;me&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/scores&quot;</span><span class="p">;</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="nx">apiCall</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">score</span><span class="o">:</span><span class="nx">score</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                             <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                                <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                        <span class="p">});</span>
                    <span class="p">},</span> <span class="nx">params</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                        <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span> <span class="s2">&quot;No publish_actions permission granted&quot;</span><span class="p">});</span>
                <span class="p">}</span>

            <span class="p">})</span>
        <span class="p">},</span>

        <span class="nx">showLeaderboard</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_leaderboardsTemplate</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;Please, provide a html template for leaderboards with the setTemplates method&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">dialog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">WebDialog</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">callbackSent</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="nx">dialog</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_leaderboardsTemplate</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">dialog</span><span class="p">.</span><span class="nx">closed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">callbackSent</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">_appId</span> <span class="o">+</span> <span class="s2">&quot;/scores&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">dialog</span><span class="p">.</span><span class="nx">closed</span><span class="p">)</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">callbackSent</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                        <span class="nx">dialog</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
                    <span class="p">}</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="kd">var</span> <span class="nx">scores</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">score</span> <span class="o">=</span> <span class="nx">fromFBScoreToCocoonScore</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                        <span class="nx">score</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
                        <span class="nx">score</span><span class="p">.</span><span class="nx">imageURL</span> <span class="o">=</span> <span class="s2">&quot;https://graph.facebook.com/&quot;</span> <span class="o">+</span> <span class="nx">score</span><span class="p">.</span><span class="nx">userID</span> <span class="o">+</span> <span class="s2">&quot;/picture&quot;</span><span class="p">;</span>
                        <span class="nx">score</span><span class="p">.</span><span class="nx">me</span> <span class="o">=</span> <span class="nx">score</span><span class="p">.</span><span class="nx">userID</span> <span class="o">===</span> <span class="nx">me</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">_currentSession</span><span class="p">.</span><span class="nx">authResponse</span><span class="p">.</span><span class="nx">userID</span><span class="p">;</span>
                        <span class="nx">scores</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">score</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="kd">var</span> <span class="nx">js</span> <span class="o">=</span> <span class="s2">&quot;addScores(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">scores</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
                <span class="nx">dialog</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-341"><td class="docs"><div class="pilwrap"><a href="#section-341" class="pilcrow">&#182;</a></div><p>internal utility function</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">prepareAchievements</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">reload</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span> <span class="o">||</span> <span class="nx">reload</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">_appId</span> <span class="o">+</span> <span class="s1">&#39;/achievements&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">achievements</span> <span class="o">=</span> <span class="p">[];</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">achievements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fromFBAchievementToCocoonAchievement</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">setCachedAchievements</span><span class="p">(</span><span class="nx">achievements</span><span class="p">);</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">([],</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">});</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">callback</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">requestAllAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">prepareAchievements</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">requestAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">userID</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">prepareAchievements</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">allAchievements</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>

                <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callback</span><span class="p">([],</span> <span class="nx">error</span><span class="p">);</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="kd">var</span> <span class="nx">apiCall</span> <span class="o">=</span> <span class="p">(</span><span class="nx">userID</span> <span class="o">||</span> <span class="s2">&quot;me&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/achievements&quot;</span><span class="p">;</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="nx">apiCall</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">achievements</span> <span class="o">=</span> <span class="p">[];</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                                <span class="kd">var</span> <span class="nx">ach</span> <span class="o">=</span> <span class="nx">me</span><span class="p">.</span><span class="nx">findAchievement</span><span class="p">((</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">achievement</span> <span class="o">||</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">data</span><span class="p">.</span><span class="nx">achievement</span><span class="p">).</span><span class="nx">id</span><span class="p">);</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">ach</span><span class="p">)</span>
                                    <span class="nx">achievements</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">ach</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">([],</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">});</span>

            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">submitAchievement</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">achievementID</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">achievementID</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;No achievementID specified&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">achID</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">translateAchievementID</span><span class="p">(</span><span class="nx">achievementID</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">preparePublishAction</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">granted</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">granted</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="s2">&quot;me/achievements&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">achievement</span><span class="o">:</span><span class="nx">achID</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">});</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                        <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span> <span class="s2">&quot;No publish_actions permission granted&quot;</span><span class="p">});</span>
                <span class="p">}</span>

            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">resetAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">preparePublishAction</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">granted</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">granted</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">requestAchievements</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                                <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
                            <span class="k">return</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="kd">var</span> <span class="nx">someError</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                        <span class="kd">var</span> <span class="nx">remaining</span> <span class="o">=</span> <span class="nx">achievements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">achievements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">me</span><span class="p">.</span><span class="nx">fb</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="s2">&quot;me/achievements&quot;</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">achievement</span><span class="o">:</span><span class="nx">achievements</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">fbAchievementData</span><span class="p">.</span><span class="nx">url</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                                   <span class="nx">someError</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="nx">remaining</span><span class="o">--</span><span class="p">;</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">remaining</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">callback</span><span class="p">(</span><span class="nx">someError</span><span class="p">);</span>
                                <span class="p">}</span>
                            <span class="p">});</span>
                        <span class="p">}</span>

                    <span class="p">});</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                        <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span> <span class="s2">&quot;No publish_actions permission granted&quot;</span><span class="p">});</span>
                <span class="p">}</span>

            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">showAchievements</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_achievementsTemplate</span><span class="p">)</span>
                <span class="k">throw</span> <span class="s2">&quot;Please, provide a html template for achievements with the setTemplates method&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">dialog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">WebDialog</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">callbackSent</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="nx">dialog</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_achievementsTemplate</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">dialog</span><span class="p">.</span><span class="nx">closed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">callbackSent</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">)</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">requestAchievements</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">achievements</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">dialog</span><span class="p">.</span><span class="nx">closed</span><span class="p">)</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callbackSent</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="kd">var</span> <span class="nx">achs</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">me</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">ach</span> <span class="o">=</span> <span class="nx">me</span><span class="p">.</span><span class="nx">_cachedAchievements</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                        <span class="nx">achs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">ach</span><span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">achievements</span> <span class="o">&amp;&amp;</span> <span class="nx">achievements</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span> <span class="nx">achievements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">achievements</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">achievementID</span> <span class="o">===</span> <span class="nx">ach</span><span class="p">.</span><span class="nx">achievementID</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">ach</span><span class="p">.</span><span class="nx">achieved</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                                    <span class="k">break</span><span class="p">;</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="kd">var</span> <span class="nx">js</span> <span class="o">=</span> <span class="s2">&quot;addAchievements(&quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">achs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>
                <span class="nx">dialog</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingServiceFacebook</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">SocialGamingService</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">fromFBUserToCocoonUser</span><span class="p">(</span><span class="nx">facebookUser</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">User</span><span class="p">(</span><span class="nx">facebookUser</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">facebookUser</span><span class="p">.</span><span class="nx">username</span> <span class="o">?</span> <span class="nx">facebookUser</span><span class="p">.</span><span class="nx">username</span> <span class="o">:</span> <span class="p">(</span><span class="nx">facebookUser</span><span class="p">.</span><span class="nx">first_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">facebookUser</span><span class="p">.</span><span class="nx">last_name</span> <span class="p">));</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">fromCocoonMessageToFBMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">link</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">linkURL</span><span class="p">,</span>
            <span class="nx">description</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
            <span class="nx">name</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">linkText</span><span class="p">,</span>
            <span class="nx">caption</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">linkCaption</span><span class="p">,</span>
            <span class="nx">picture</span><span class="o">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">mediaURL</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">fromFBScoreToCocoonScore</span><span class="p">(</span><span class="nx">fbResponse</span><span class="p">,</span> <span class="nx">requestScoreParams</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">Score</span><span class="p">(</span><span class="nx">fbResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">fbResponse</span><span class="p">.</span><span class="nx">score</span><span class="p">,</span> <span class="nx">fbResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">requestScoreParams</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">leaderboardID</span> <span class="o">=</span> <span class="nx">requestScoreParams</span><span class="p">.</span><span class="nx">leaderboardID</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">imageURL</span> <span class="o">=</span> <span class="s1">&#39;https://graph.facebook.com/&#39;</span> <span class="o">+</span> <span class="nx">fbResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s1">&#39;/picture&#39;</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">fromFBAchievementToCocoonAchievement</span><span class="p">(</span><span class="nx">fbResponse</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Social</span><span class="p">.</span><span class="nx">Achievement</span> <span class="p">(</span>
            <span class="nx">fbResponse</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
            <span class="nx">fbResponse</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span>
            <span class="nx">fbResponse</span><span class="p">.</span><span class="nx">description</span><span class="p">,</span>
            <span class="nx">fbResponse</span><span class="p">.</span><span class="nx">image</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">url</span><span class="p">,</span>
            <span class="nx">fbResponse</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">points</span>
        <span class="p">);</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">fbAchievementData</span> <span class="o">=</span> <span class="nx">fbResponse</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}</span></pre></div></td></tr><tr id="section-342"><td class="docs"><div class="pilwrap"><a href="#section-342" class="pilcrow">&#182;</a></div><p>Do not insert this code in CocoonJS ||Node</p>
</td><td class="code"><div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">isCocoonJS</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-343"><td class="docs"><div class="pilwrap"><a href="#section-343" class="pilcrow">&#182;</a></div><p>Load the Facebook SDK</p>
</td><td class="code"><div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-344"><td class="docs"><div class="pilwrap"><a href="#section-344" class="pilcrow">&#182;</a></div><p>script.async = true;</p>
</td><td class="code"><div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">prot</span> <span class="o">=</span> <span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">?</span> <span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">:</span> <span class="s2">&quot;http:&quot;</span>
        <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">prot</span> <span class="o">+</span> <span class="s2">&quot;//connect.facebook.net/en_US/all.js&quot;</span><span class="p">;</span>
        <span class="nx">parent</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">script</span><span class="p">,</span> <span class="nx">parent</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> * </span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm"> *   Here you will find a demo about this namespace: &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/master/Multiplayer&quot;&gt;Multiplayer demo&lt;/a&gt;.</span>
<span class="cm"> *&lt;/div&gt;</span>
<span class="cm"> * </span>
<span class="cm"> * &lt;div class=&quot;alert alert-warning&quot;&gt;</span>
<span class="cm"> *    &lt;strong&gt;Warning!&lt;/strong&gt; This JavaScript extension requires some configuration parameters on the &lt;a href=&quot;https://ludei.zendesk.com/hc/en-us&quot;&gt;cloud compiler&lt;/a&gt;!</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> * @namespace Cocoon.Multiplayer</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Multiplayer&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">MultiplayerService</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="nx">extensionName</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span> <span class="o">=</span> <span class="nx">nativeExtensionName</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span> <span class="o">=</span> <span class="nx">extensionName</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">]);</span>

        <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">onInvitationReceived</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="s2">&quot;onInvitationReceived&quot;</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">onInvitationLoaded</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="s2">&quot;onInvitationLoaded&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">){</span>
            <span class="kd">var</span> <span class="nx">matchID</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">matchID</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">currentMatch</span> <span class="o">=</span>  <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">Match</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="nx">me</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="nx">matchID</span><span class="p">);</span>
                <span class="nx">sourceListener</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">currentMatch</span><span class="p">,</span> <span class="kc">null</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">sourceListener</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span>

        <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;invitation&quot;</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">received</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">onInvitationReceived</span><span class="p">,</span>
            <span class="nx">loaded</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">onInvitationLoaded</span><span class="p">,</span>
        <span class="p">});</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">};</span>


  <span class="nx">extension</span><span class="p">.</span><span class="nx">MultiplayerService</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">currentMatch</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></pre></div></td></tr><tr id="section-345"><td class="docs"><div class="pilwrap"><a href="#section-345" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Presents a system View for the matchmaking and creates a new Match.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.MatchRequest</span><span>- The parameters for the match.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">findMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matchRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>  <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;findMatch&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">matchRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matchID</span><span class="p">,</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">matchID</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">currentMatch</span> <span class="o">=</span>  <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">Match</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="nx">me</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="nx">matchID</span><span class="p">);</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">currentMatch</span><span class="p">,</span> <span class="kc">null</span><span class="p">)</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-346"><td class="docs"><div class="pilwrap"><a href="#section-346" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sends an automatch request to join the authenticated user to a match. It doesn't present a system view while waiting to other players.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.MatchRequest</span><span>- The parameters for the match.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">findAutoMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matchRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;findAutoMatch&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">matchRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matchID</span><span class="p">,</span> <span class="nx">error</span><span class="p">){</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">matchID</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">currentMatch</span> <span class="o">=</span>  <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">Match</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="nx">me</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="nx">matchID</span><span class="p">);</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">currentMatch</span><span class="p">,</span> <span class="kc">null</span><span class="p">)</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-347"><td class="docs"><div class="pilwrap"><a href="#section-347" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Cancels the ongoing automatch request.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">cancelAutoMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;cancelAutoMatch&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-348"><td class="docs"><div class="pilwrap"><a href="#section-348" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Automatically adds players to an ongoing match owned by the user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.MatchRequest</span><span>- The parameters for the match.</span></div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.Match</span><span>- The match where new players will be added.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. Response parameters: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">addPlayersToMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matchRequest</span><span class="p">,</span> <span class="nx">match</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;addPlayersToMatch&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">matchRequest</span><span class="p">,</span> <span class="nx">match</span><span class="p">.</span><span class="nx">matchID</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div></td></tr><tr id="section-349"><td class="docs"><div class="pilwrap"><a href="#section-349" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Get the current match reference.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Cocoon.Multiplayer.Match</span><span>The current match reference.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentMatch</span><span class="p">;</span>
        <span class="p">}</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-350"><td class="docs"><div class="pilwrap"><a href="#section-350" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>This type provides a transmission network between a group of users.
<ul><li>The match might be returned before connections have been established between players. At this stage, all the players are in the process of connecting to each other.</li>
<li>Always check the getExpectedPlayerCount value before starting a match. When its value reaches zero, all expected players are connected, and your game can begin the match.</li>
<li>Do not forget to call the start method of the match when your game is ready to process received messages via onMatchDataReceived listener.</li></ul></li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">Match</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="nx">extensionName</span><span class="p">,</span> <span class="nx">matchID</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">nativeExtensionName</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;The given native extension name &#39;&quot;</span> <span class="o">+</span> <span class="nx">nativeExtensionName</span> <span class="o">+</span> <span class="s2">&quot;&#39; is not a string.&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">extensionName</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="k">throw</span> <span class="s2">&quot;The given extension name &#39;&quot;</span> <span class="o">+</span> <span class="nx">nativeExtensionName</span> <span class="o">+</span> <span class="s2">&quot;&#39; is not a string.&quot;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span> <span class="o">=</span> <span class="nx">nativeExtensionName</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span> <span class="o">=</span> <span class="nx">extensionName</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">=</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">nativeAvailable</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">ext</span><span class="p">[</span><span class="nx">nativeExtensionName</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">matchID</span> <span class="o">=</span> <span class="nx">matchID</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">onMatchDataReceived</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="s2">&quot;onMatchDataReceived&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">matchID</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">sourceListener</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
          <span class="p">}</span>
        <span class="p">});</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">onMatchStateChanged</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="s2">&quot;onMatchStateChanged&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">matchID</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">sourceListener</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
          <span class="p">}</span>
        <span class="p">});</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">onMatchConnectionWithPlayerFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="s2">&quot;onMatchConnectionWithPlayerFailed&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">matchID</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">sourceListener</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
          <span class="p">}</span>
        <span class="p">});</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">onMatchFailed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">EventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">extensionName</span><span class="p">,</span> <span class="s2">&quot;onMatchFailed&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sourceListener</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">matchID</span> <span class="o">===</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">sourceListener</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
          <span class="p">}</span>
        <span class="p">});</span>



        <span class="kd">var</span> <span class="nx">signal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Signal</span><span class="p">.</span><span class="nx">createSignal</span><span class="p">();</span></pre></div></td></tr><tr id="section-351"><td class="docs"><div class="pilwrap"><a href="#section-351" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Allows to listen to events about the restoring process.<br />- The callback 'dataReceived' <br />- The callback 'stateChanged' <br />- The callback 'connectionWithPlayerFailed' allows listening to events called when a netowrk connection with a player fails<br />- The callback 'failed' allows listening to events called when the match fails.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">signal</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;match&quot;</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">dataReceived</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">onMatchDataReceived</span><span class="p">,</span>
            <span class="nx">stateChanged</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">onMatchStateChanged</span><span class="p">,</span>
            <span class="nx">connectionWithPlayerFailed</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">onMatchConnectionWithPlayerFailed</span><span class="p">,</span>
            <span class="nx">failed</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">onMatchFailed</span>
        <span class="p">});</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">signal</span><span class="p">.</span><span class="nx">expose</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">Match</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span></pre></div></td></tr><tr id="section-352"><td class="docs"><div class="pilwrap"><a href="#section-352" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Starts processing received messages. The user must call this method when the game is ready to process messages. Messages received before being prepared are stored and processed later.</li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">start</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;startMatch&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">matchID</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div></td></tr><tr id="section-353"><td class="docs"><div class="pilwrap"><a href="#section-353" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Transmits data to all players connected to the match. The match queues the data and transmits it when the network becomes available.</li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">sendDataToAllPlayers</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">sendMode</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;sendDataToAllPlayers&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">matchID</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">sendMode</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div></td></tr><tr id="section-354"><td class="docs"><div class="pilwrap"><a href="#section-354" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Transmits data to a list of connected players. The match queues the data and transmits it when the network becomes available.</li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">sendData</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">playerIDs</span><span class="p">,</span>  <span class="nx">sendMode</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;sendData&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">matchID</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">playerIDs</span><span class="p">,</span> <span class="nx">sendMode</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">},</span>
  </pre></div></td></tr><tr id="section-355"><td class="docs"><div class="pilwrap"><a href="#section-355" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Disconnects the local player from the match and releases the match. Calling disconnect notifies other players that you have left the match.</li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">disconnect</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;disconnect&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">matchID</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>
    </pre></div></td></tr><tr id="section-356"><td class="docs"><div class="pilwrap"><a href="#section-356" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Requests additional information of the current players in the match.</li>
</ul></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. Response params: players array and error</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">requestPlayersInfo</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;requestPlayersInfo&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">matchID</span><span class="p">,</span> <span class="nx">callback</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div></td></tr><tr id="section-357"><td class="docs"><div class="pilwrap"><a href="#section-357" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns the remaining players count who have not yet connected to the match.
    * @function getExpectedPlayerCount</li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">getExpectedPlayerCount</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;getExpectedPlayerCount&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">matchID</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div></td></tr><tr id="section-358"><td class="docs"><div class="pilwrap"><a href="#section-358" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Returns an array with all the player identifiers taking part in the match.
    * @function getPlayerIDs</li>
</ul></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">getPlayerIDs</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;getPlayerIDs&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">matchID</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div></td></tr><tr id="section-359"><td class="docs"><div class="pilwrap"><a href="#section-359" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Gets the local playerID taking part in the match.<br />        * @function getLocalPlayerID</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">string</span><span>the playerID attached to the match manager.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">getLocalPlayerID</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeAvailable</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">callNative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nativeExtensionName</span><span class="p">,</span> <span class="s2">&quot;getLocalPlayerID&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">matchID</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="p">},</span>

  <span class="p">};</span></pre></div></td></tr><tr id="section-360"><td class="docs"><div class="pilwrap"><a href="#section-360" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object represents the modes to send data.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">SendDataMode</span> <span class="o">=</span>  <span class="p">{</span>

      <span class="nx">RELIABLE</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

      <span class="nx">UNRELIABLE</span> <span class="o">:</span> <span class="mi">1</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-361"><td class="docs"><div class="pilwrap"><a href="#section-361" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object represents the connection state of a player.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">ConnectionState</span> <span class="o">=</span> <span class="p">{</span>

      <span class="nx">UNKNOWN</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

      <span class="nx">CONNECTED</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>

      <span class="nx">DISCONNECTED</span> <span class="o">:</span> <span class="mi">2</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-362"><td class="docs"><div class="pilwrap"><a href="#section-362" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The object that represents the information of a player inside a multiplayer match.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">PlayerInfo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">userID</span><span class="p">,</span> <span class="nx">userName</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">userID</span> <span class="o">=</span> <span class="nx">userID</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">userName</span> <span class="o">=</span> <span class="nx">userName</span><span class="p">;</span>
  <span class="p">};</span></pre></div></td></tr><tr id="section-363"><td class="docs"><div class="pilwrap"><a href="#section-363" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This object is used to specify the parameters for a new multiplayer match.</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">extension</span><span class="p">.</span><span class="nx">MatchRequest</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">minPlayers</span><span class="p">,</span> <span class="nx">maxPlayers</span><span class="p">,</span> <span class="nx">playersToInvite</span><span class="p">,</span> <span class="nx">playerGroup</span><span class="p">,</span> <span class="nx">playerAttributes</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">minPlayers</span> <span class="o">=</span> <span class="nx">minPlayers</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">maxPlayers</span> <span class="o">=</span> <span class="nx">maxPlayers</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">playersToInvite</span> <span class="o">=</span> <span class="nx">playersToInvite</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">playerGroup</span> <span class="o">=</span> <span class="nx">playerGroup</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">playerAttributes</span> <span class="o">=</span> <span class="nx">playerAttributes</span><span class="p">;</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">};</span>
  
  <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> * </span>
<span class="cm"> * &lt;div class=&quot;alert alert-warning&quot;&gt;</span>
<span class="cm"> *    &lt;strong&gt;Warning!&lt;/strong&gt; This JavaScript extension requires some configuration parameters on the &lt;a href=&quot;https://ludei.zendesk.com/hc/en-us&quot;&gt;cloud compiler&lt;/a&gt;!</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> * @private</span>
<span class="cm"> * @namespace Cocoon.Multiplayer.LoopbackService</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Multiplayer&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="kd">var</span> <span class="nx">loopbackServices</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">indexCounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">matchServices</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">matchCounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">LoopbackService</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">LoopbackService</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;dummy&quot;</span><span class="p">,</span><span class="s2">&quot;dummy&quot;</span><span class="p">);</span>
        <span class="nx">loopbackServices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">playerID</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">+</span> <span class="nx">indexCounter</span><span class="p">;</span>
        <span class="nx">indexCounter</span><span class="o">++</span><span class="p">;</span>

    <span class="p">}</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">LoopbackService</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span>  <span class="p">{</span>

        <span class="nx">findMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>  <span class="p">{</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">findMatchCallback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span></pre></div></td></tr><tr id="section-364"><td class="docs"><div class="pilwrap"><a href="#section-364" class="pilcrow">&#182;</a></div><p>checks if the service is already added to the match list</p>
</td><td class="code"><div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">exists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">matchServices</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">matchServices</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="k">this</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">exists</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">exists</span><span class="p">)</span>
                <span class="nx">matchServices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">);</span></pre></div></td></tr><tr id="section-365"><td class="docs"><div class="pilwrap"><a href="#section-365" class="pilcrow">&#182;</a></div><p>Create the match is all required players are ready
TODO: check more conditions (playerGroup, playerAttributes) to complete a match</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="nx">matchServices</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">minPlayers</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">playerIDs</span> <span class="o">=</span> <span class="p">[];</span></pre></div></td></tr><tr id="section-366"><td class="docs"><div class="pilwrap"><a href="#section-366" class="pilcrow">&#182;</a></div><p>create playerIDs array</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">matchServices</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">playerIDs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">matchServices</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getPlayerID</span><span class="p">());</span>
                <span class="p">}</span></pre></div></td></tr><tr id="section-367"><td class="docs"><div class="pilwrap"><a href="#section-367" class="pilcrow">&#182;</a></div><p>notify the found match to each manager</p>
</td><td class="code"><div class="highlight"><pre>                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">matchServices</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LoopbackMatch</span><span class="p">(</span><span class="nx">matchServices</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                    <span class="nx">match</span><span class="p">.</span><span class="nx">playerIDs</span> <span class="o">=</span> <span class="nx">playerIDs</span><span class="p">.</span><span class="nx">slice</span><span class="p">();</span>
                    <span class="nx">matchServices</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">currentMatch</span> <span class="o">=</span> <span class="nx">match</span><span class="p">;</span>
                    <span class="nx">matchServices</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">findMatchCallback</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                <span class="p">}</span></pre></div></td></tr><tr id="section-368"><td class="docs"><div class="pilwrap"><a href="#section-368" class="pilcrow">&#182;</a></div><p>clear pending list</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">matchServices</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="p">}</span>


        <span class="p">},</span>
        <span class="nx">findAutoMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matchRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">findMatch</span><span class="p">(</span><span class="nx">matchRequest</span><span class="p">,</span><span class="nx">callback</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">cancelAutoMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="p">},</span>

        <span class="nx">addPlayersToMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matchRequest</span><span class="p">,</span> <span class="nx">match</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="s2">&quot;Not implemmented&quot;</span><span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">getPlayerID</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">playerID</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">getMatch</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentMatch</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">extension</span><span class="p">.</span><span class="nx">LoopbackService</span><span class="p">,</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">MultiplayerService</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">LoopbackMatch</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">service</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">matchCounter</span><span class="o">++</span><span class="p">;</span>
        <span class="nx">LoopbackMatch</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">matchCounter</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">started</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">disconnected</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">pendingData</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">service</span> <span class="o">=</span> <span class="nx">service</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">LoopbackMatch</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">start</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">me</span><span class="p">.</span><span class="nx">started</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">me</span><span class="p">.</span><span class="nx">pendingData</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">me</span><span class="p">.</span><span class="nx">onMatchDataReceived</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">matchID</span><span class="p">,</span><span class="nx">me</span><span class="p">.</span><span class="nx">pendingData</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">data</span><span class="p">,</span> <span class="nx">me</span><span class="p">.</span><span class="nx">pendingData</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">player</span><span class="p">);</span>
                <span class="p">}</span>

            <span class="p">},</span><span class="mi">0</span><span class="p">);</span>

        <span class="p">},</span>
        <span class="nx">sendDataToAllPlayers</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">sendMode</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">sendData</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">playerIDs</span><span class="p">,</span> <span class="nx">sendMode</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">sendData</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">playerIDs</span><span class="p">,</span>  <span class="nx">sendMode</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="nx">loopbackServices</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">destService</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">playerIDs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">playerIDs</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">===</span> <span class="nx">loopbackServices</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getPlayerID</span><span class="p">())</span> <span class="p">{</span>
                            <span class="nx">destService</span> <span class="o">=</span> <span class="nx">loopbackServices</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">destService</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">destService</span><span class="p">.</span><span class="nx">getMatch</span><span class="p">().</span><span class="nx">notifyDataReceived</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">me</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">getPlayerID</span><span class="p">());</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">disconnect</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">disconnected</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">playerIDs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">playerIDs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">loopbackServices</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">loopbackServices</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">getPlayerID</span><span class="p">()</span> <span class="o">===</span> <span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">loopbackServices</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getMatch</span><span class="p">();</span>
                        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="p">.</span><span class="nx">disconnected</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">match</span><span class="p">.</span><span class="nx">onMatchStateChanged</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">getPlayerID</span><span class="p">(),</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">ConnectionState</span><span class="p">.</span><span class="nx">DISCONNECTED</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">requestPlayersInfo</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
               <span class="kd">var</span> <span class="nx">playersInfo</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">me</span><span class="p">.</span><span class="nx">playerIDs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">playersInfo</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nx">userID</span><span class="o">:</span> <span class="nx">me</span><span class="p">.</span><span class="nx">playerIDs</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">userName</span><span class="o">:</span> <span class="s2">&quot;Player&quot;</span> <span class="o">+</span> <span class="nx">me</span><span class="p">.</span><span class="nx">playerIDs</span><span class="p">[</span><span class="nx">i</span><span class="p">]};</span>
                <span class="p">};</span>
                <span class="nx">callback</span><span class="p">(</span><span class="nx">playersInfo</span><span class="p">);</span>
            <span class="p">},</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">getExpectedPlayerCount</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">getPlayerIDs</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">playerIDs</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">getLocalPlayerID</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">playerID</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">notifyDataReceived</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">fromPlayer</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">started</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">pendingData</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">data</span><span class="o">:</span><span class="nx">data</span><span class="p">,</span> <span class="nx">player</span><span class="o">:</span><span class="nx">fromPlayer</span><span class="p">});</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">onMatchDataReceived</span><span class="p">.</span><span class="nx">notifyEventListeners</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">matchID</span><span class="p">,</span><span class="nx">data</span><span class="p">,</span><span class="nx">fromPlayer</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">};</span>

    <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">LoopbackMatch</span><span class="p">,</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">Match</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});;</span><span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm"> *   Here you will find a demo about this namespace: &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/master/Multiplayer&quot;&gt;Multiplayer demo&lt;/a&gt;.</span>
<span class="cm"> *&lt;/div&gt;</span>
<span class="cm"> * </span>
<span class="cm"> * &lt;div class=&quot;alert alert-warning&quot;&gt;</span>
<span class="cm"> *    &lt;strong&gt;Warning!&lt;/strong&gt; This JavaScript extension requires some configuration parameters on the &lt;a href=&quot;https://ludei.zendesk.com/hc/en-us&quot;&gt;cloud compiler&lt;/a&gt;!</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> * @namespace Cocoon.Multiplayer.GooglePlayGames</span>
<span class="cm"> * @example </span>
<span class="cm"> * var GooglePlayGames = Cocoon.Multiplayer.GooglePlayGames;</span>
<span class="cm"> * var SocialGooglePlay = GooglePlayGames.getSocialInterface();</span>
<span class="cm"> * var MultiplayerGooglePlay = GooglePlayGames.getMultiplayerInterface();</span>
<span class="cm"> * </span>
<span class="cm"> * SocialGooglePlay.login(function(loggedIn, error) {</span>
<span class="cm"> *  if(loggedIn){</span>
<span class="cm"> *    var request = new Cocoon.Multiplayer.MatchRequest(2,2);</span>
<span class="cm"> *    var handleMatch = function(match, error){</span>
<span class="cm"> *    </span>
<span class="cm"> *    }</span>
<span class="cm"> *    ...</span>
<span class="cm"> *    MultiplayerGooglePlay.findMatch(request, handleMatch);</span>
<span class="cm"> *    ...</span>
<span class="cm"> *  }</span>
<span class="cm"> * });</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Multiplayer&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

    <span class="nx">extension</span><span class="p">.</span><span class="nx">GooglePlayGames</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">MultiplayerService</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_MULTIPLAYER_GPG&quot;</span><span class="p">,</span> <span class="s2">&quot;Multiplayer.GooglePlayGames&quot;</span><span class="p">);</span>
  </pre></div></td></tr><tr id="section-369"><td class="docs"><div class="pilwrap"><a href="#section-369" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Presents a system View for the matchmaking and creates a new Match.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.MatchRequest</span><span>- The parameters for the match.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-370"><td class="docs"><div class="pilwrap"><a href="#section-370" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sends an automatch request to join the authenticated user to a match. It doesn't present a system view while waiting to other players.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.MatchRequest</span><span>- The parameters for the match.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-371"><td class="docs"><div class="pilwrap"><a href="#section-371" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Cancels the ongoing automatch request.
<ul><li>@function cancelAutoMatch</li>
<li>@memberOf Cocoon.Multiplayer.GooglePlayGames</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-372"><td class="docs"><div class="pilwrap"><a href="#section-372" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Automatically adds players to an ongoing match owned by the user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.MatchRequest</span><span>- The parameters for the match.</span></div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.Match</span><span>- The match where new players will be added.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. Response parameters: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-373"><td class="docs"><div class="pilwrap"><a href="#section-373" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Get the current match reference.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Cocoon.Multiplayer.Match</span><span>The current match reference.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});</span>
<span class="p">;</span><span class="cm">/**</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;div class=&quot;alert alert-success&quot;&gt;</span>
<span class="cm"> *   Here you will find a demo about this namespace: &lt;a href=&quot;https://github.com/ludei/cocoonjs-demos/tree/master/Multiplayer&quot;&gt;Multiplayer demo&lt;/a&gt;.</span>
<span class="cm"> *&lt;/div&gt;</span>
<span class="cm"> *  </span>
<span class="cm"> * &lt;div class=&quot;alert alert-warning&quot;&gt;</span>
<span class="cm"> *    &lt;strong&gt;Warning!&lt;/strong&gt; This JavaScript extension requires some configuration parameters on the &lt;a href=&quot;https://ludei.zendesk.com/hc/en-us&quot;&gt;cloud compiler&lt;/a&gt;!</span>
<span class="cm"> * &lt;/div&gt;</span>
<span class="cm"> * @namespace Cocoon.Multiplayer.GameCenter</span>
<span class="cm"> * @example</span>
<span class="cm"> * var GameCenter = CocoonJS.Social.GameCenter;</span>
<span class="cm"> * var SocialGameCenter = gc.getSocialInterface();</span>
<span class="cm"> * var MultiplayerGameCenter = gc.getMultiplayerInterface();</span>
<span class="cm"> * </span>
<span class="cm"> * SocialGameCenter.login(function(loggedIn, error) {</span>
<span class="cm"> *  if(loggedIn){</span>
<span class="cm"> *    var request = new Cocoon.Multiplayer.MatchRequest(2,2);</span>
<span class="cm"> *    var handleMatch = function(match, error){</span>
<span class="cm"> *    </span>
<span class="cm"> *    }</span>
<span class="cm"> *    ...</span>
<span class="cm"> *    MultiplayerGameCenter.findMatch(request, handleMatch);</span>
<span class="cm"> *    ...</span>
<span class="cm"> *  }</span>
<span class="cm"> * });</span>
<span class="cm"> */</span>
<span class="nx">Cocoon</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;Cocoon.Multiplayer&quot;</span> <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extension</span><span class="p">){</span>

  <span class="nx">extension</span><span class="p">.</span><span class="nx">GameCenter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cocoon</span><span class="p">.</span><span class="nx">Multiplayer</span><span class="p">.</span><span class="nx">MultiplayerService</span><span class="p">(</span><span class="s2">&quot;IDTK_SRV_MULTIPLAYER_GAMECENTER&quot;</span><span class="p">,</span> <span class="s2">&quot;Multiplayer.GameCenter&quot;</span><span class="p">);</span></pre></div></td></tr><tr id="section-374"><td class="docs"><div class="pilwrap"><a href="#section-374" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Presents a system View for the matchmaking and creates a new Match.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.MatchRequest</span><span>- The parameters for the match.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-375"><td class="docs"><div class="pilwrap"><a href="#section-375" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Sends an automatch request to join the authenticated user to a match. It doesn't present a system view while waiting to other players.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.MatchRequest</span><span>- The parameters for the match.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. It receives the following parameters: </span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-376"><td class="docs"><div class="pilwrap"><a href="#section-376" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><ul>
<li>Cancels the ongoing automatch request.
<ul><li>@function cancelAutoMatch</li>
<li>@memberOf Cocoon.Multiplayer.GameCenter</li></ul></li>
</ul></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-377"><td class="docs"><div class="pilwrap"><a href="#section-377" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Automatically adds players to an ongoing match owned by the user.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.MatchRequest</span><span>- The parameters for the match.</span></div><div class="dox_tag_detail"><span>matchRequest </span><span class="dox_type">Cocoon.Multiplayer.Match</span><span>- The match where new players will be added.</span></div><div class="dox_tag_detail"><span>callback </span><span class="dox_type">Function</span><span>- The callback function. Response parameters: error.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-378"><td class="docs"><div class="pilwrap"><a href="#section-378" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Get the current match reference.</p></div><div class="details"><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Cocoon.Multiplayer.Match</span><span>The current match reference.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>  <span class="k">return</span> <span class="nx">extension</span><span class="p">;</span>
<span class="p">});</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Mon Dec 15 2014 18:42:13 GMT+0100 (CET)  </div></div></body></html>